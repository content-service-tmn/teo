!function(e){var t;window.UIkit2&&(t=e(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-parallax",["uikit"],function(){return t||e(UIkit2)})}(function(F){"use strict";var t=[],S=!1,i=0,n=window.innerHeight,e=function(){i=F.$win.scrollTop(),window.requestAnimationFrame(function(){for(var e=0;e<t.length;e++)t[e].process()})};F.component("parallax",{defaults:{velocity:.5,target:!1,viewport:!1,media:!1},boot:function(){S=function(){var e,t=document.createElement("div"),a={WebkitTransform:"-webkit-transform",MSTransform:"-ms-transform",MozTransform:"-moz-transform",Transform:"transform"};for(var r in document.body.insertBefore(t,null),a)void 0!==t.style[r]&&(t.style[r]="translate3d(1px,1px,1px)",e=window.getComputedStyle(t).getPropertyValue(a[r]));return document.body.removeChild(t),void 0!==e&&0<e.length&&"none"!==e}(),F.$doc.on("scrolling.uk.document",e),F.$win.on("load resize orientationchange",F.Utils.debounce(function(){n=window.innerHeight,e()},50)),F.ready(function(e){F.$("[data-uk-parallax]",e).each(function(){var e=F.$(this);e.data("parallax")||F.parallax(e,F.Utils.options(e.attr("data-uk-parallax")))})})},init:function(){this.base=this.options.target?F.$(this.options.target):this.element,this.props={},this.velocity=this.options.velocity||1;var s=["target","velocity","viewport","plugins","media"];Object.keys(this.options).forEach(function(e){if(-1===s.indexOf(e)){var t,a,r,i,n=String(this.options[e]).split(",");e.match(/color/i)?(t=n[1]?n[0]:this._getStartValue(e),a=n[1]?n[1]:n[0],t||(t="rgba(255,255,255,0)")):(i=(t=parseFloat(n[1]?n[0]:this._getStartValue(e)))<(a=parseFloat(n[1]?n[1]:n[0]))?a-t:t-a,r=t<a?1:-1),this.props[e]={start:t,end:a,dir:r,diff:i}}}.bind(this)),t.push(this)},process:function(){if(this.options.media)switch(typeof this.options.media){case"number":if(window.innerWidth<this.options.media)return!1;break;case"string":if(window.matchMedia&&!window.matchMedia(this.options.media).matches)return!1}var e=this.percentageInViewport();!1!==this.options.viewport&&(e=0===this.options.viewport?1:e/this.options.viewport),this.update(e)},percentageInViewport:function(){var e,t,a=this.base.offset().top,r=this.base.outerHeight();return i+n<a?t=0:a+r<i?t=1:a+r<n?t=(i<n?i:i-n)/(a+r):(e=i+n-a,t=Math.round(e/((n+r)/100))/100),t},update:function(v){var w,y,x={transform:"",filter:""},I=v*(1-(this.velocity-this.velocity*v));I<0&&(I=0),1<I&&(I=1),void 0!==this._percent&&this._percent==I||(Object.keys(this.props).forEach(function(e){var r,i,n,t,s,o,a,c,l,p,f,d,h,u,b,g,m,k;switch(w=this.props[e],0===v?y=w.start:1===v?y=w.end:void 0!==w.diff&&(y=w.start+w.diff*I*w.dir),"bg"!=e&&"bgp"!=e||this._bgcover||(this._bgcover=(r=this,i=e,n=w,f=new Image,s=r.element.css({backgroundSize:"cover",backgroundRepeat:"no-repeat"}),t=s.css("background-image").replace(/^url\(/g,"").replace(/\)$/g,"").replace(/("|')/g,""),a=function(){var e=s.innerWidth(),t=s.innerHeight(),a="bg"==i?n.diff:n.diff/100*t;if(t+=a,(e+=Math.ceil(a*c))-a<o.w&&t<o.h)return r.element.css({backgroundSize:"auto"});e/c<t?(l=Math.ceil(t*c),(p=t)>window.innerHeight&&(l*=1.2,p*=1.2)):(l=e,p=Math.ceil(e/c)),s.css({backgroundSize:l+"px "+p+"px"}).data("bgsize",{w:l,h:p})},f.onerror=function(){},f.onload=function(){o={w:f.width,h:f.height},c=f.width/f.height,F.$win.on("load resize orientationchange",F.Utils.debounce(function(){a()},50)),a()},f.src=t,!0)),e){case"x":x.transform+=S?" translate3d("+y+"px, 0, 0)":" translateX("+y+"px)";break;case"xp":x.transform+=S?" translate3d("+y+"%, 0, 0)":" translateX("+y+"%)";break;case"y":x.transform+=S?" translate3d(0, "+y+"px, 0)":" translateY("+y+"px)";break;case"yp":x.transform+=S?" translate3d(0, "+y+"%, 0)":" translateY("+y+"%)";break;case"rotate":x.transform+=" rotate("+y+"deg)";break;case"scale":x.transform+=" scale("+y+")";break;case"bg":x["background-position"]="50% "+y+"px";break;case"bgp":x["background-position"]="50% "+y+"%";break;case"color":case"background-color":case"border-color":x[e]=(d=w.start,h=w.end,u=I,d=z(d),h=z(h),b=d,g=h,m=u=u||0,k="rgba("+parseInt(b[0]+m*(g[0]-b[0]),10)+","+parseInt(b[1]+m*(g[1]-b[1]),10)+","+parseInt(b[2]+m*(g[2]-b[2]),10)+","+(b&&g?parseFloat(b[3]+m*(g[3]-b[3])):1),k+=")");break;case"blur":x.filter+=" blur("+y+"px)";break;case"hue":x.filter+=" hue-rotate("+y+"deg)";break;case"grayscale":x.filter+=" grayscale("+y+"%)";break;case"invert":x.filter+=" invert("+y+"%)";break;case"fopacity":x.filter+=" opacity("+y+"%)";break;case"saturate":x.filter+=" saturate("+y+"%)";break;case"sepia":x.filter+=" sepia("+y+"%)";break;default:x[e]=y}}.bind(this)),x.filter&&(x["-webkit-filter"]=x.filter),this.element.css(x),this._percent=I)},_getStartValue:function(e){var t=0;switch(e){case"scale":t=1;break;default:t=this.element.css(e)}return t||0}});var a={black:[0,0,0,1],blue:[0,0,255,1],brown:[165,42,42,1],cyan:[0,255,255,1],fuchsia:[255,0,255,1],gold:[255,215,0,1],green:[0,128,0,1],indigo:[75,0,130,1],khaki:[240,230,140,1],lime:[0,255,0,1],magenta:[255,0,255,1],maroon:[128,0,0,1],navy:[0,0,128,1],olive:[128,128,0,1],orange:[255,165,0,1],pink:[255,192,203,1],purple:[128,0,128,1],violet:[128,0,128,1],red:[255,0,0,1],silver:[192,192,192,1],white:[255,255,255,1],yellow:[255,255,0,1],transparent:[255,255,255,0]};function z(e){var t;return(t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1]:(t=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(e))?[17*parseInt(t[1],16),17*parseInt(t[2],16),17*parseInt(t[3],16),1]:(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),1]:(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(e))?[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])]:a[e]||[255,255,255,0]}return F.parallax});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvcGFyYWxsYXguanMiXSwibmFtZXMiOlsiYWRkb24iLCJjb21wb25lbnQiLCJ3aW5kb3ciLCJVSWtpdDIiLCJkZWZpbmUiLCJhbWQiLCJVSSIsInBhcmFsbGF4ZXMiLCJzdXBwb3J0czNkIiwic2Nyb2xsdG9wIiwid2giLCJpbm5lckhlaWdodCIsImNoZWNrUGFyYWxsYXhlcyIsIiR3aW4iLCJzY3JvbGxUb3AiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJpIiwibGVuZ3RoIiwicHJvY2VzcyIsImRlZmF1bHRzIiwidmVsb2NpdHkiLCJ0YXJnZXQiLCJ2aWV3cG9ydCIsIm1lZGlhIiwiYm9vdCIsImhhczNkIiwiZWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0cmFuc2Zvcm1zIiwiV2Via2l0VHJhbnNmb3JtIiwiTVNUcmFuc2Zvcm0iLCJNb3pUcmFuc2Zvcm0iLCJUcmFuc2Zvcm0iLCJ0IiwiYm9keSIsImluc2VydEJlZm9yZSIsInVuZGVmaW5lZCIsInN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldFByb3BlcnR5VmFsdWUiLCJyZW1vdmVDaGlsZCIsIiRkb2MiLCJvbiIsIlV0aWxzIiwiZGVib3VuY2UiLCJyZWFkeSIsImNvbnRleHQiLCIkIiwiZWFjaCIsInBhcmFsbGF4IiwidGhpcyIsImRhdGEiLCJvcHRpb25zIiwiYXR0ciIsImluaXQiLCJiYXNlIiwiZWxlbWVudCIsInByb3BzIiwicmVzZXJ2ZWQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsInByb3AiLCJpbmRleE9mIiwic3RhcnQiLCJlbmQiLCJkaXIiLCJkaWZmIiwic3RhcnRlbmQiLCJTdHJpbmciLCJzcGxpdCIsIm1hdGNoIiwiX2dldFN0YXJ0VmFsdWUiLCJwYXJzZUZsb2F0IiwiYmluZCIsInB1c2giLCJpbm5lcldpZHRoIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJwZXJjZW50IiwicGVyY2VudGFnZUluVmlld3BvcnQiLCJ1cGRhdGUiLCJkaXN0YW5jZSIsInRvcCIsIm9mZnNldCIsImhlaWdodCIsIm91dGVySGVpZ2h0IiwiTWF0aCIsInJvdW5kIiwib3B0cyIsInZhbCIsImNzcyIsInRyYW5zZm9ybSIsImZpbHRlciIsImNvbXBlcmNlbnQiLCJfcGVyY2VudCIsIm9iaiIsInVybCIsInNpemUiLCJjaGVjayIsInJhdGlvIiwid2lkdGgiLCJpbWciLCJwb3MiLCJiZWdpbiIsImNvbG9yIiwiX2JnY292ZXIiLCJJbWFnZSIsImJhY2tncm91bmRTaXplIiwiYmFja2dyb3VuZFJlcGVhdCIsInJlcGxhY2UiLCJ3IiwiaCIsImV4dHJhIiwiY2VpbCIsIm9uZXJyb3IiLCJvbmxvYWQiLCJzcmMiLCJwYXJzZUNvbG9yIiwicGFyc2VJbnQiLCJ2YWx1ZSIsImNvbG9ycyIsImJsYWNrIiwiYmx1ZSIsImJyb3duIiwiY3lhbiIsImZ1Y2hzaWEiLCJnb2xkIiwiZ3JlZW4iLCJpbmRpZ28iLCJraGFraSIsImxpbWUiLCJtYWdlbnRhIiwibWFyb29uIiwibmF2eSIsIm9saXZlIiwib3JhbmdlIiwicGluayIsInB1cnBsZSIsInZpb2xldCIsInJlZCIsInNpbHZlciIsIndoaXRlIiwieWVsbG93IiwidHJhbnNwYXJlbnQiLCJleGVjIl0sIm1hcHBpbmdzIjoiQ0FDQSxTQUFVQSxHQUVOLElBQUlDLEVBRUFDLE9BQU9DLFNBQ1BGLEVBQVlELEVBQU1HLFNBR0QsbUJBQVZDLFFBQXdCQSxPQUFPQyxLQUN0Q0QsT0FBTyxpQkFBa0IsQ0FBQyxTQUFVLFdBQ2hDLE9BQU9ILEdBQWFELEVBQU1HLFVBVnRDLENBY0csU0FBU0csR0FFUixhQUVBLElBQUlDLEVBQWtCLEdBQ2xCQyxHQUFrQixFQUNsQkMsRUFBa0IsRUFDbEJDLEVBQWtCUixPQUFPUyxZQUN6QkMsRUFBa0IsV0FFZEgsRUFBWUgsRUFBR08sS0FBS0MsWUFFcEJaLE9BQU9hLHNCQUFzQixXQUN6QixJQUFLLElBQUlDLEVBQUUsRUFBR0EsRUFBSVQsRUFBV1UsT0FBUUQsSUFDakNULEVBQVdTLEdBQUdF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QUNjLFNBQVNoRCxFQUFNLEdBQUksSUFBS2dELFNBQVNoRCxFQUFNLEdBQUksSUFBS2dELFNBQVNoRCxFQUFNLEdBQUksSUFBSUUsV0FBV0YsRUFBTSxLQUl6RmtELEVBQU9oQixJQUFVLENBQUMsSUFBSSxJQUFJLElBQUksR0FLbkQsT0FBT3BHLEVBQUc0QyIsImZpbGUiOiJjb21wb25lbnRzL3BhcmFsbGF4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIFVJa2l0IDIuMjcuMiB8IGh0dHA6Ly93d3cuZ2V0dWlraXQuY29tIHwgKGMpIDIwMTQgWU9PdGhlbWUgfCBNSVQgTGljZW5zZSAqL1xuKGZ1bmN0aW9uKGFkZG9uKSB7XG5cbiAgICB2YXIgY29tcG9uZW50O1xuXG4gICAgaWYgKHdpbmRvdy5VSWtpdDIpIHtcbiAgICAgICAgY29tcG9uZW50ID0gYWRkb24oVUlraXQyKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKCd1aWtpdC1wYXJhbGxheCcsIFsndWlraXQnXSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQgfHwgYWRkb24oVUlraXQyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59KShmdW5jdGlvbihVSSl7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBwYXJhbGxheGVzICAgICAgPSBbXSxcbiAgICAgICAgc3VwcG9ydHMzZCAgICAgID0gZmFsc2UsXG4gICAgICAgIHNjcm9sbHRvcCAgICAgICA9IDAsXG4gICAgICAgIHdoICAgICAgICAgICAgICA9IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICAgICAgY2hlY2tQYXJhbGxheGVzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHNjcm9sbHRvcCA9IFVJLiR3aW4uc2Nyb2xsVG9wKCk7XG5cbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGkgPCBwYXJhbGxheGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFsbGF4ZXNbaV0ucHJvY2VzcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG5cbiAgICBVSS5jb21wb25lbnQoJ3BhcmFsbGF4Jywge1xuXG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICB2ZWxvY2l0eSA6IDAuNSxcbiAgICAgICAgICAgIHRhcmdldCAgIDogZmFsc2UsXG4gICAgICAgICAgICB2aWV3cG9ydCA6IGZhbHNlLFxuICAgICAgICAgICAgbWVkaWEgICAgOiBmYWxzZVxuICAgICAgICB9LFxuXG4gICAgICAgIGJvb3Q6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBzdXBwb3J0czNkID0gKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgICAgICAgICAgICAgICAgaGFzM2QsXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnV2Via2l0VHJhbnNmb3JtJzonLXdlYmtpdC10cmFuc2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ01TVHJhbnNmb3JtJzonLW1zLXRyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnTW96VHJhbnNmb3JtJzonLW1vei10cmFuc2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1RyYW5zZm9ybSc6J3RyYW5zZm9ybSdcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCBpdCB0byB0aGUgYm9keSB0byBnZXQgdGhlIGNvbXB1dGVkIHN0eWxlLlxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKGVsLCBudWxsKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIHQgaW4gdHJhbnNmb3Jtcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWwuc3R5bGVbdF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGVbdF0gPSAndHJhbnNsYXRlM2QoMXB4LDFweCwxcHgpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhczNkID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLmdldFByb3BlcnR5VmFsdWUodHJhbnNmb3Jtc1t0XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAoaGFzM2QgIT09IHVuZGVmaW5lZCAmJiBoYXMzZC5sZW5ndGggPiAwICYmIGhhczNkICE9PSBcIm5vbmVcIik7XG4gICAgICAgICAgICB9KSgpO1xuXG4gICAgICAgICAgICAvLyBsaXN0ZW4gdG8gc2Nyb2xsIGFuZCByZXNpemVcbiAgICAgICAgICAgIFVJLiRkb2Mub24oJ3Njcm9sbGluZy51ay5kb2N1bWVudCcsIGNoZWNrUGFyYWxsYXhlcyk7XG4gICAgICAgICAgICBVSS4kd2luLm9uKCdsb2FkIHJlc2l6ZSBvcmllbnRhdGlvbmNoYW5nZScsIFVJLlV0aWxzLmRlYm91bmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgd2ggPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgICAgICAgICAgY2hlY2tQYXJhbGxheGVzKCk7XG4gICAgICAgICAgICB9LCA1MCkpO1xuXG4gICAgICAgICAgICAvLyBpbml0IGNvZGVcbiAgICAgICAgICAgIFVJLnJlYWR5KGZ1bmN0aW9uKGNvbnRleHQpIHtcblxuICAgICAgICAgICAgICAgIFVJLiQoJ1tkYXRhLXVrLXBhcmFsbGF4XScsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFsbGF4ID0gVUkuJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFsbGF4LmRhdGEoJ3BhcmFsbGF4JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFVJLnBhcmFsbGF4KHBhcmFsbGF4LCBVSS5VdGlscy5vcHRpb25zKHBhcmFsbGF4LmF0dHIoJ2RhdGEtdWstcGFyYWxsYXgnKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdGhpcy5iYXNlICAgICA9IHRoaXMub3B0aW9ucy50YXJnZXQgPyBVSS4kKHRoaXMub3B0aW9ucy50YXJnZXQpIDogdGhpcy5lbGVtZW50O1xuICAgICAgICAgICAgdGhpcy5wcm9wcyAgICA9IHt9O1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9ICh0aGlzLm9wdGlvbnMudmVsb2NpdHkgfHwgMSk7XG5cbiAgICAgICAgICAgIHZhciByZXNlcnZlZCAgPSBbJ3RhcmdldCcsJ3ZlbG9jaXR5Jywndmlld3BvcnQnLCdwbHVnaW5zJywnbWVkaWEnXTtcblxuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5vcHRpb25zKS5mb3JFYWNoKGZ1bmN0aW9uKHByb3Ape1xuXG4gICAgICAgICAgICAgICAgaWYgKHJlc2VydmVkLmluZGV4T2YocHJvcCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQsIGVuZCwgZGlyLCBkaWZmLCBzdGFydGVuZCA9IFN0cmluZyh0aGlzLm9wdGlvbnNbcHJvcF0pLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJvcC5tYXRjaCgvY29sb3IvaSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBzdGFydGVuZFsxXSA/IHN0YXJ0ZW5kWzBdIDogdGhpcy5fZ2V0U3RhcnRWYWx1ZShwcm9wKSxcbiAgICAgICAgICAgICAgICAgICAgZW5kICAgPSBzdGFydGVuZFsxXSA/IHN0YXJ0ZW5kWzFdIDogc3RhcnRlbmRbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAncmdiYSgyNTUsMjU1LDI1NSwwKSc7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gcGFyc2VGbG9hdChzdGFydGVuZFsxXSA/IHN0YXJ0ZW5kWzBdIDogdGhpcy5fZ2V0U3RhcnRWYWx1ZShwcm9wKSksXG4gICAgICAgICAgICAgICAgICAgIGVuZCAgID0gcGFyc2VGbG9hdChzdGFydGVuZFsxXSA/IHN0YXJ0ZW5kWzFdIDogc3RhcnRlbmRbMF0pO1xuICAgICAgICAgICAgICAgICAgICBkaWZmICA9IChzdGFydCA8IGVuZCA/IChlbmQtc3RhcnQpOihzdGFydC1lbmQpKTtcbiAgICAgICAgICAgICAgICAgICAgZGlyICAgPSAoc3RhcnQgPCBlbmQgPyAxOi0xKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnByb3BzW3Byb3BdID0geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCBkaXI6IGRpciwgZGlmZjogZGlmZiB9O1xuXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICBwYXJhbGxheGVzLnB1c2godGhpcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJvY2VzczogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMubWVkaWEpIHtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCh0eXBlb2YodGhpcy5vcHRpb25zLm1lZGlhKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgdGhpcy5vcHRpb25zLm1lZGlhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Lm1hdGNoTWVkaWEgJiYgIXdpbmRvdy5tYXRjaE1lZGlhKHRoaXMub3B0aW9ucy5tZWRpYSkubWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHBlcmNlbnQgPSB0aGlzLnBlcmNlbnRhZ2VJblZpZXdwb3J0KCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudmlld3BvcnQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcGVyY2VudCA9ICh0aGlzLm9wdGlvbnMudmlld3BvcnQgPT09IDApID8gMSA6IHBlcmNlbnQgLyB0aGlzLm9wdGlvbnMudmlld3BvcnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHBlcmNlbnQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHBlcmNlbnRhZ2VJblZpZXdwb3J0OiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIHRvcCAgICAgPSB0aGlzLmJhc2Uub2Zmc2V0KCkudG9wLFxuICAgICAgICAgICAgICAgIGhlaWdodCAgPSB0aGlzLmJhc2Uub3V0ZXJIZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSwgcGVyY2VudGFnZSwgcGVyY2VudDtcblxuICAgICAgICAgICAgaWYgKHRvcCA+IChzY3JvbGx0b3AgKyB3aCkpIHtcbiAgICAgICAgICAgICAgICBwZXJjZW50ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoKHRvcCArIGhlaWdodCkgPCBzY3JvbGx0b3ApIHtcbiAgICAgICAgICAgICAgICBwZXJjZW50ID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoKHRvcCArIGhlaWdodCkgPCB3aCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAoc2Nyb2xsdG9wIDwgd2ggPyBzY3JvbGx0b3AgOiBzY3JvbGx0b3AgLSB3aCkgLyAodG9wK2hlaWdodCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlICAgPSAoc2Nyb2xsdG9wICsgd2gpIC0gdG9wO1xuICAgICAgICAgICAgICAgICAgICBwZXJjZW50YWdlID0gTWF0aC5yb3VuZChkaXN0YW5jZSAvICgod2ggKyBoZWlnaHQpIC8gMTAwKSk7XG4gICAgICAgICAgICAgICAgICAgIHBlcmNlbnQgICAgPSBwZXJjZW50YWdlLzEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwZXJjZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24ocGVyY2VudCkge1xuXG4gICAgICAgICAgICB2YXIgJHRoaXMgICAgICA9IHRoaXMsXG4gICAgICAgICAgICAgICAgY3NzICAgICAgICA9IHt0cmFuc2Zvcm06JycsIGZpbHRlcjonJ30sXG4gICAgICAgICAgICAgICAgY29tcGVyY2VudCA9IHBlcmNlbnQgKiAoMSAtICh0aGlzLnZlbG9jaXR5IC0gKHRoaXMudmVsb2NpdHkgKiBwZXJjZW50KSkpLFxuICAgICAgICAgICAgICAgIG9wdHMsIHZhbDtcblxuICAgICAgICAgICAgaWYgKGNvbXBlcmNlbnQgPCAwKSBjb21wZXJjZW50ID0gMDtcbiAgICAgICAgICAgIGlmIChjb21wZXJjZW50ID4gMSkgY29tcGVyY2VudCA9IDE7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9wZXJjZW50ICE9PSB1bmRlZmluZWQgJiYgdGhpcy5fcGVyY2VudCA9PSBjb21wZXJjZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BzKS5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcblxuICAgICAgICAgICAgICAgIG9wdHMgPSB0aGlzLnByb3BzW3Byb3BdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBlcmNlbnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gb3B0cy5zdGFydDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYocGVyY2VudCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBvcHRzLmVuZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYob3B0cy5kaWZmICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gb3B0cy5zdGFydCArIChvcHRzLmRpZmYgKiBjb21wZXJjZW50ICogb3B0cy5kaXIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgocHJvcCA9PSAnYmcnIHx8IHByb3AgPT0gJ2JncCcpICYmICF0aGlzLl9iZ2NvdmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JnY292ZXIgPSBpbml0QmdJbWFnZVBhcmFsbGF4KHRoaXMsIHByb3AsIG9wdHMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN3aXRjaChwcm9wKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gdHJhbnNmb3Jtc1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd4JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy50cmFuc2Zvcm0gKz0gc3VwcG9ydHMzZCA/ICcgdHJhbnNsYXRlM2QoJyt2YWwrJ3B4LCAwLCAwKSc6JyB0cmFuc2xhdGVYKCcrdmFsKydweCknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3hwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy50cmFuc2Zvcm0gKz0gc3VwcG9ydHMzZCA/ICcgdHJhbnNsYXRlM2QoJyt2YWwrJyUsIDAsIDApJzonIHRyYW5zbGF0ZVgoJyt2YWwrJyUpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy50cmFuc2Zvcm0gKz0gc3VwcG9ydHMzZCA/ICcgdHJhbnNsYXRlM2QoMCwgJyt2YWwrJ3B4LCAwKSc6JyB0cmFuc2xhdGVZKCcrdmFsKydweCknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3lwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy50cmFuc2Zvcm0gKz0gc3VwcG9ydHMzZCA/ICcgdHJhbnNsYXRlM2QoMCwgJyt2YWwrJyUsIDApJzonIHRyYW5zbGF0ZVkoJyt2YWwrJyUpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdyb3RhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzLnRyYW5zZm9ybSArPSAnIHJvdGF0ZSgnK3ZhbCsnZGVnKSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2NhbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzLnRyYW5zZm9ybSArPSAnIHNjYWxlKCcrdmFsKycpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGJnIGltYWdlXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JnJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG9uJ3QgbW92ZSBpZiBpbWFnZSBoZWlnaHQgaXMgdG9vIHNtYWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoJHRoaXMuZWxlbWVudC5kYXRhKCdiZ3NpemUnKSAmJiAoJHRoaXMuZWxlbWVudC5kYXRhKCdiZ3NpemUnKS5oICsgdmFsIC0gd2luZG93LmlubmVySGVpZ2h0KSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzWydiYWNrZ3JvdW5kLXBvc2l0aW9uJ10gPSAnNTAlICcrdmFsKydweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmdwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1snYmFja2dyb3VuZC1wb3NpdGlvbiddID0gJzUwJSAnK3ZhbCsnJSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb2xvclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb2xvcic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JhY2tncm91bmQtY29sb3InOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdib3JkZXItY29sb3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzW3Byb3BdID0gY2FsY0NvbG9yKG9wdHMuc3RhcnQsIG9wdHMuZW5kLCBjb21wZXJjZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENTUyBGaWx0ZXJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYmx1cic6XG4gICAgICAgICAgICAgICAgICAgICAgICBjc3MuZmlsdGVyICs9ICcgYmx1cignK3ZhbCsncHgpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdodWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3NzLmZpbHRlciArPSAnIGh1ZS1yb3RhdGUoJyt2YWwrJ2RlZyknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dyYXlzY2FsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjc3MuZmlsdGVyICs9ICcgZ3JheXNjYWxlKCcrdmFsKyclKSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW52ZXJ0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5maWx0ZXIgKz0gJyBpbnZlcnQoJyt2YWwrJyUpJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdmb3BhY2l0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjc3MuZmlsdGVyICs9ICcgb3BhY2l0eSgnK3ZhbCsnJSknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NhdHVyYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5maWx0ZXIgKz0gJyBzYXR1cmF0ZSgnK3ZhbCsnJSknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NlcGlhJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzcy5maWx0ZXIgKz0gJyBzZXBpYSgnK3ZhbCsnJSknO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzc1twcm9wXSA9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgaWYgKGNzcy5maWx0ZXIpIHtcbiAgICAgICAgICAgICAgICBjc3NbJy13ZWJraXQtZmlsdGVyJ10gPSBjc3MuZmlsdGVyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3NzKGNzcyk7XG5cbiAgICAgICAgICAgIHRoaXMuX3BlcmNlbnQgPSBjb21wZXJjZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIF9nZXRTdGFydFZhbHVlOiBmdW5jdGlvbihwcm9wKSB7XG5cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IDA7XG5cbiAgICAgICAgICAgIHN3aXRjaChwcm9wKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2NhbGUnOlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5lbGVtZW50LmNzcyhwcm9wKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICh2YWx1ZSB8fCAwKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG5cblxuICAgIC8vIGhlbHBlclxuXG4gICAgZnVuY3Rpb24gaW5pdEJnSW1hZ2VQYXJhbGxheChvYmosIHByb3AsIG9wdHMpIHtcblxuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCksIHVybCwgZWxlbWVudCwgc2l6ZSwgY2hlY2ssIHJhdGlvLCB3aWR0aCwgaGVpZ2h0O1xuXG4gICAgICAgIGVsZW1lbnQgPSBvYmouZWxlbWVudC5jc3Moe2JhY2tncm91bmRTaXplOiAnY292ZXInLCAgYmFja2dyb3VuZFJlcGVhdDogJ25vLXJlcGVhdCd9KTtcbiAgICAgICAgdXJsICAgICA9IGVsZW1lbnQuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykucmVwbGFjZSgvXnVybFxcKC9nLCAnJykucmVwbGFjZSgvXFwpJC9nLCAnJykucmVwbGFjZSgvKFwifCcpL2csICcnKTtcbiAgICAgICAgY2hlY2sgICA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB2YXIgdyA9IGVsZW1lbnQuaW5uZXJXaWR0aCgpLCBoID0gZWxlbWVudC5pbm5lckhlaWdodCgpLCBleHRyYSA9IChwcm9wPT0nYmcnKSA/IG9wdHMuZGlmZiA6IChvcHRzLmRpZmYvMTAwKSAqIGg7XG5cbiAgICAgICAgICAgIGggKz0gZXh0cmE7XG4gICAgICAgICAgICB3ICs9IE1hdGguY2VpbChleHRyYSAqIHJhdGlvKTtcblxuICAgICAgICAgICAgaWYgKHctZXh0cmEgPCBzaXplLncgJiYgaCA8IHNpemUuaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmouZWxlbWVudC5jc3Moe2JhY2tncm91bmRTaXplOiAnYXV0byd9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgZWxlbWVudCBoZWlnaHQgPCBwYXJlbnQgaGVpZ2h0IChnYXAgdW5kZXJuZWF0aClcbiAgICAgICAgICAgIGlmICgodyAvIHJhdGlvKSA8IGgpIHtcblxuICAgICAgICAgICAgICAgIHdpZHRoICA9IE1hdGguY2VpbChoICogcmF0aW8pO1xuICAgICAgICAgICAgICAgIGhlaWdodCA9IGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoaCA+IHdpbmRvdy5pbm5lckhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgPSB3aWR0aCAqIDEuMjtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0ICogMS4yO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZWxlbWVudCB3aWR0aCA8IHBhcmVudCB3aWR0aCAoZ2FwIHRvIHJpZ2h0KVxuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHdpZHRoICA9IHc7XG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5jZWlsKHcgLyByYXRpbyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsZW1lbnQuY3NzKHtiYWNrZ3JvdW5kU2l6ZTogKHdpZHRoKydweCAnK2hlaWdodCsncHgnKX0pLmRhdGEoJ2Jnc2l6ZScsIHt3OndpZHRoLGg6aGVpZ2h0fSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW1nLm9uZXJyb3IgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gaW1hZ2UgdXJsIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgfTtcblxuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNpemUgID0ge3c6aW1nLndpZHRoLCBoOmltZy5oZWlnaHR9O1xuICAgICAgICAgICAgcmF0aW8gPSBpbWcud2lkdGggLyBpbWcuaGVpZ2h0O1xuXG4gICAgICAgICAgICBVSS4kd2luLm9uKCdsb2FkIHJlc2l6ZSBvcmllbnRhdGlvbmNoYW5nZScsIFVJLlV0aWxzLmRlYm91bmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgY2hlY2soKTtcbiAgICAgICAgICAgIH0sIDUwKSk7XG5cbiAgICAgICAgICAgIGNoZWNrKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW1nLnNyYyA9IHVybDtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cblxuICAgIC8vIFNvbWUgbmFtZWQgY29sb3JzIHRvIHdvcmsgd2l0aCwgYWRkZWQgYnkgQnJhZGxleSBBeWVyc1xuICAgIC8vIEZyb20gSW50ZXJmYWNlIGJ5IFN0ZWZhbiBQZXRyZVxuICAgIC8vIGh0dHA6Ly9pbnRlcmZhY2UuZXllY29uLnJvL1xuICAgIHZhciBjb2xvcnMgPSB7XG4gICAgICAgICdibGFjayc6IFswLDAsMCwxXSxcbiAgICAgICAgJ2JsdWUnOiBbMCwwLDI1NSwxXSxcbiAgICAgICAgJ2Jyb3duJzogWzE2NSw0Miw0MiwxXSxcbiAgICAgICAgJ2N5YW4nOiBbMCwyNTUsMjU1LDFdLFxuICAgICAgICAnZnVjaHNpYSc6IFsyNTUsMCwyNTUsMV0sXG4gICAgICAgICdnb2xkJzogWzI1NSwyMTUsMCwxXSxcbiAgICAgICAgJ2dyZWVuJzogWzAsMTI4LDAsMV0sXG4gICAgICAgICdpbmRpZ28nOiBbNzUsMCwxMzAsMV0sXG4gICAgICAgICdraGFraSc6IFsyNDAsMjMwLDE0MCwxXSxcbiAgICAgICAgJ2xpbWUnOiBbMCwyNTUsMCwxXSxcbiAgICAgICAgJ21hZ2VudGEnOiBbMjU1LDAsMjU1LDFdLFxuICAgICAgICAnbWFyb29uJzogWzEyOCwwLDAsMV0sXG4gICAgICAgICduYXZ5JzogWzAsMCwxMjgsMV0sXG4gICAgICAgICdvbGl2ZSc6IFsxMjgsMTI4LDAsMV0sXG4gICAgICAgICdvcmFuZ2UnOiBbMjU1LDE2NSwwLDFdLFxuICAgICAgICAncGluayc6IFsyNTUsMTkyLDIwMywxXSxcbiAgICAgICAgJ3B1cnBsZSc6IFsxMjgsMCwxMjgsMV0sXG4gICAgICAgICd2aW9sZXQnOiBbMTI4LDAsMTI4LDFdLFxuICAgICAgICAncmVkJzogWzI1NSwwLDAsMV0sXG4gICAgICAgICdzaWx2ZXInOiBbMTkyLDE5MiwxOTIsMV0sXG4gICAgICAgICd3aGl0ZSc6IFsyNTUsMjU1LDI1NSwxXSxcbiAgICAgICAgJ3llbGxvdyc6IFsyNTUsMjU1LDAsMV0sXG4gICAgICAgICd0cmFuc3BhcmVudCc6IFsyNTUsMjU1LDI1NSwwXVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBjYWxjQ29sb3Ioc3RhcnQsIGVuZCwgcG9zKSB7XG5cbiAgICAgICAgc3RhcnQgPSBwYXJzZUNvbG9yKHN0YXJ0KTtcbiAgICAgICAgZW5kICAgPSBwYXJzZUNvbG9yKGVuZCk7XG4gICAgICAgIHBvcyAgID0gcG9zIHx8IDA7XG5cbiAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZUNvbG9yKHN0YXJ0LCBlbmQsIHBvcyk7XG4gICAgfVxuXG4gICAgLyoqIVxuICAgICAqIEBwcmVzZXJ2ZSBDb2xvciBhbmltYXRpb24gMS42LjBcbiAgICAgKiBodHRwOi8vd3d3LmJpdHN0b3JtLm9yZy9qcXVlcnkvY29sb3ItYW5pbWF0aW9uL1xuICAgICAqIENvcHlyaWdodCAyMDExLCAyMDEzIEVkd2luIE1hcnRpbiA8ZWR3aW5AYml0c3Rvcm0ub3JnPlxuICAgICAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlcy5cbiAgICAgKi9cblxuICAgIC8vIENhbGN1bGF0ZSBhbiBpbi1iZXR3ZWVuIGNvbG9yLiBSZXR1cm5zIFwiI2FhYmJjY1wiLWxpa2Ugc3RyaW5nLlxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZUNvbG9yKGJlZ2luLCBlbmQsIHBvcykge1xuICAgICAgICB2YXIgY29sb3IgPSAncmdiYSgnXG4gICAgICAgICAgICAgICAgKyBwYXJzZUludCgoYmVnaW5bMF0gKyBwb3MgKiAoZW5kWzBdIC0gYmVnaW5bMF0pKSwgMTApICsgJywnXG4gICAgICAgICAgICAgICAgKyBwYXJzZUludCgoYmVnaW5bMV0gKyBwb3MgKiAoZW5kWzFdIC0gYmVnaW5bMV0pKSwgMTApICsgJywnXG4gICAgICAgICAgICAgICAgKyBwYXJzZUludCgoYmVnaW5bMl0gKyBwb3MgKiAoZW5kWzJdIC0gYmVnaW5bMl0pKSwgMTApICsgJywnXG4gICAgICAgICAgICAgICAgKyAoYmVnaW4gJiYgZW5kID8gcGFyc2VGbG9hdChiZWdpblszXSArIHBvcyAqIChlbmRbM10gLSBiZWdpblszXSkpIDogMSk7XG5cbiAgICAgICAgY29sb3IgKz0gJyknO1xuICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgYW4gQ1NTLXN5bnRheCBjb2xvci4gT3V0cHV0cyBhbiBhcnJheSBbciwgZywgYl1cbiAgICBmdW5jdGlvbiBwYXJzZUNvbG9yKGNvbG9yKSB7XG5cbiAgICAgICAgdmFyIG1hdGNoLCBxdWFkcnVwbGV0O1xuXG4gICAgICAgIC8vIE1hdGNoICNhYWJiY2NcbiAgICAgICAgaWYgKG1hdGNoID0gLyMoWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkvLmV4ZWMoY29sb3IpKSB7XG4gICAgICAgICAgICBxdWFkcnVwbGV0ID0gW3BhcnNlSW50KG1hdGNoWzFdLCAxNiksIHBhcnNlSW50KG1hdGNoWzJdLCAxNiksIHBhcnNlSW50KG1hdGNoWzNdLCAxNiksIDFdO1xuXG4gICAgICAgICAgICAvLyBNYXRjaCAjYWJjXG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2ggPSAvIyhbMC05YS1mQS1GXSkoWzAtOWEtZkEtRl0pKFswLTlhLWZBLUZdKS8uZXhlYyhjb2xvcikpIHtcbiAgICAgICAgICAgIHF1YWRydXBsZXQgPSBbcGFyc2VJbnQobWF0Y2hbMV0sIDE2KSAqIDE3LCBwYXJzZUludChtYXRjaFsyXSwgMTYpICogMTcsIHBhcnNlSW50KG1hdGNoWzNdLCAxNikgKiAxNywgMV07XG5cbiAgICAgICAgICAgIC8vIE1hdGNoIHJnYihuLCBuLCBuKVxuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoID0gL3JnYlxcKFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqLFxccyooWzAtOV17MSwzfSlcXHMqXFwpLy5leGVjKGNvbG9yKSkge1xuICAgICAgICAgICAgcXVhZHJ1cGxldCA9IFtwYXJzZUludChtYXRjaFsxXSksIHBhcnNlSW50KG1hdGNoWzJdKSwgcGFyc2VJbnQobWF0Y2hbM10pLCAxXTtcblxuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoID0gL3JnYmFcXChcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTldezEsM30pXFxzKixcXHMqKFswLTlcXC5dKilcXHMqXFwpLy5leGVjKGNvbG9yKSkge1xuICAgICAgICAgICAgcXVhZHJ1cGxldCA9IFtwYXJzZUludChtYXRjaFsxXSwgMTApLCBwYXJzZUludChtYXRjaFsyXSwgMTApLCBwYXJzZUludChtYXRjaFszXSwgMTApLHBhcnNlRmxvYXQobWF0Y2hbNF0pXTtcblxuICAgICAgICAgICAgLy8gTm8gYnJvd3NlciByZXR1cm5zIHJnYihuJSwgbiUsIG4lKSwgc28gbGl0dGxlIHJlYXNvbiB0byBzdXBwb3J0IHRoaXMgZm9ybWF0LlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcXVhZHJ1cGxldCA9IGNvbG9yc1tjb2xvcl0gfHwgWzI1NSwyNTUsMjU1LDBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBxdWFkcnVwbGV0O1xuICAgIH1cblxuICAgIHJldHVybiBVSS5wYXJhbGxheDtcbn0pOyJdfQ==
