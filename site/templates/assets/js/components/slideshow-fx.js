!function(i){var t;window.UIkit2&&(t=i(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-slideshow-fx",["uikit"],function(){return t||i(UIkit2)})}(function(I){"use strict";var M=I.slideshow.animations;I.$.extend(I.slideshow.animations,{slice:function(i,t,e,s){if(!i.data("cover"))return M.fade.apply(this,arguments);for(var n,o=I.$.Deferred(),r=Math.ceil(this.element.width()/this.options.slices),a=t.data("cover").css("background-image"),c=I.$('<li class="uk-slideshow-ghost"></li>').css({top:0,left:0,width:this.container.width(),height:this.container.height(),opacity:1,zIndex:15}),h=c.width(),d=c.height(),p=0;p<this.options.slices;p++){"slice-up-down"==s&&((p%2+2)%2==0?"0":d);var l,u=(this.options.slices,r),f="rect(0px, "+u*(p+1)+"px, "+d+"px, "+r*p+"px)";l="rect(0px, "+u*(p+1)+"px, 0px, "+r*p+"px)",("slice-up"==s||"slice-up-down"==s&&(p%2+2)%2==0)&&(l="rect("+d+"px, "+u*(p+1)+"px, "+d+"px, "+r*p+"px)"),n=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,width:h,height:d,"background-image":a,clip:l,opacity:0,transition:"all "+this.options.duration+"ms ease-in-out "+60*p+"ms","-webkit-transition":"all "+this.options.duration+"ms ease-in-out "+60*p+"ms"}).data("clip",f),c.append(n)}return this.container.append(c),c.children().last().on(I.support.transition.end,function(){setTimeout(function(){c.remove(),o.resolve()},0)}),c.width(),c.children().each(function(){(n=I.$(this)).css({clip:n.data("clip"),opacity:1})}),o.promise()},"slice-up":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-up"])},"slice-down":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-down"])},"slice-up-down":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-up-down"])},fold:function(i,t,e){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var s,n=I.$.Deferred(),o=Math.ceil(this.element.width()/this.options.slices),r=t.data("cover").css("background-image"),a=I.$('<li class="uk-slideshow-ghost"></li>').css({width:t.width(),height:t.height(),opacity:1,zIndex:15}),c=t.width(),h=t.height(),d=0;d<this.options.slices;d++)s=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,width:c,height:h,"background-image":r,"transform-origin":o*d+"px 0 0",clip:"rect(0px, "+o*(d+1)+"px, "+h+"px, "+o*d+"px)",opacity:0,transform:"scaleX(0.000001)",transition:"all "+this.options.duration+"ms ease-in-out "+(100+60*d)+"ms","-webkit-transition":"all "+this.options.duration+"ms ease-in-out "+(100+60*d)+"ms"}),a.prepend(s);return this.container.append(a),a.width(),a.children().first().on(I.support.transition.end,function(){setTimeout(function(){a.remove(),n.resolve()},0)}).end().css({transform:"scaleX(1)",opacity:1}),n.promise()},puzzle:function(i,t,e){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var s,n,o=I.$.Deferred(),r=this,a=Math.round(this.options.slices/2),c=Math.round(t.width()/a),h=Math.round(t.height()/c),d=Math.round(t.height()/h)+1,p=t.data("cover").css("background-image"),l=I.$('<li class="uk-slideshow-ghost"></li>').css({width:this.container.width(),height:this.container.height(),opacity:1,zIndex:15}),u=this.container.width(),f=this.container.height(),m=0;m<h;m++)for(var x=0;x<a;x++)n=[d*m+"px",(x==a-1?c+2:c)*(x+1)+"px",d*(m+1)+"px",c*x+"px"],s=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,opacity:0,width:u,height:f,"background-image":p,clip:"rect("+n.join(",")+")","-webkit-transform":"translateZ(0)",transform:"translateZ(0)"}),l.append(s);this.container.append(l);var w=v(l.children());return w.each(function(i){I.$(this).css({transition:"all "+r.options.duration+"ms ease-in-out "+(50+25*i)+"ms","-webkit-transition":"all "+r.options.duration+"ms ease-in-out "+(50+25*i)+"ms"})}).last().on(I.support.transition.end,function(){setTimeout(function(){l.remove(),o.resolve()},0)}),l.width(),w.css({opacity:1}),o.promise()},boxes:function(i,t,e,s){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var n,o,r,a=I.$.Deferred(),c=Math.round(this.options.slices/2),h=Math.round(t.width()/c),d=Math.round(t.height()/h),p=Math.round(t.height()/d)+1,l=t.data("cover").css("background-image"),u=I.$('<li class="uk-slideshow-ghost"></li>').css({width:t.width(),height:t.height(),opacity:1,zIndex:15}),f=t.width(),m=t.height(),x=0;x<d;x++)for(r=0;r<c;r++)o=[p*x+"px",(r==c-1?h+2:h)*(r+1)+"px",p*(x+1)+"px",h*r+"px"],n=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,opacity:1,width:f,height:m,"background-image":l,"transform-origin":o[3]+" "+o[0]+" 0",clip:"rect("+o.join(",")+")","-webkit-transform":"scale(0.0000000000000001)",transform:"scale(0.0000000000000001)"}),u.append(n);this.container.append(u);var w,v=0,g=0,k=0,b=[[]],y=u.children();for("boxes-reverse"==s&&(y=[].reverse.apply(y)),y.each(function(){b[v][g]=I.$(this),++g==c&&(g=0,b[++v]=[])}),w=r=0;r<c*d;r++){w=r;for(var $=0;$<d;$++)0<=w&&w<c&&b[$][w].css({transition:"all "+this.options.duration+"ms linear "+(50+k)+"ms","-webkit-transition":"all "+this.options.duration+"ms linear "+(50+k)+"ms"}),w--;k+=100}return y.last().on(I.support.transition.end,function(){setTimeout(function(){u.remove(),a.resolve()},0)}),u.width(),y.css({"-webkit-transform":"scale(1)",transform:"scale(1)"}),a.promise()},"boxes-reverse":function(i,t,e){return M.boxes.apply(this,[i,t,e,"boxes-reverse"])},"random-fx":function(){var i=["slice-up","fold","puzzle","slice-down","boxes","slice-up-down","boxes-reverse"];return this.fxIndex=(void 0===this.fxIndex?-1:this.fxIndex)+1,i[this.fxIndex]||(this.fxIndex=0),M[i[this.fxIndex]].apply(this,arguments)}});var v=function(i){for(var t,e,s=i.length;s;t=parseInt(Math.random()*s),e=i[--s],i[s]=i[t],i[t]=e);return i};return I.slideshow.animations});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvc2xpZGVzaG93LWZ4LmpzIl0sIm5hbWVzIjpbImFkZG9uIiwiY29tcG9uZW50Iiwid2luZG93IiwiVUlraXQyIiwiZGVmaW5lIiwiYW1kIiwiVUkiLCJBbmltYXRpb25zIiwic2xpZGVzaG93IiwiYW5pbWF0aW9ucyIsIiQiLCJleHRlbmQiLCJzbGljZSIsImN1cnJlbnQiLCJuZXh0IiwiZGlyIiwiZnJvbWZ4IiwiZGF0YSIsImZhZGUiLCJhcHBseSIsInRoaXMiLCJhcmd1bWVudHMiLCJiYXIiLCJkIiwiRGVmZXJyZWQiLCJzbGljZVdpZHRoIiwiTWF0aCIsImNlaWwiLCJlbGVtZW50Iiwid2lkdGgiLCJvcHRpb25zIiwic2xpY2VzIiwiYmdpbWFnZSIsImNzcyIsImdob3N0IiwidG9wIiwibGVmdCIsImNvbnRhaW5lciIsImhlaWdodCIsIm9wYWNpdHkiLCJ6SW5kZXgiLCJnaG9zdFdpZHRoIiwiZ2hvc3RIZWlnaHQiLCJpIiwiY2xpcGZyb20iLCJjbGlwdG8iLCJwb3NpdGlvbiIsImJhY2tncm91bmQtaW1hZ2UiLCJjbGlwIiwidHJhbnNpdGlvbiIsImR1cmF0aW9uIiwiLXdlYmtpdC10cmFuc2l0aW9uIiwiYXBwZW5kIiwiY2hpbGRyZW4iLCJsYXN0Iiwib24iLCJzdXBwb3J0IiwiZW5kIiwic2V0VGltZW91dCIsInJlbW92ZSIsInJlc29sdmUiLCJlYWNoIiwicHJvbWlzZSIsInNsaWNlLXVwIiwic2xpY2UtZG93biIsInNsaWNlLXVwLWRvd24iLCJmb2xkIiwidHJhbnNmb3JtLW9yaWdpbiIsInRyYW5zZm9ybSIsInByZXBlbmQiLCJmaXJzdCIsInB1enpsZSIsImJveCIsInJlY3QiLCIkdGhpcyIsImJveENvbHMiLCJyb3VuZCIsImJveFdpZHRoIiwiYm94Um93cyIsImJveEhlaWdodCIsInJvd3MiLCJjb2xzIiwiam9pbiIsIi13ZWJraXQtdHJhbnNmb3JtIiwiYm94ZXMiLCJzaHVmZmxlIiwicHJldkNvbCIsInJvd0luZGV4IiwiY29sSW5kZXgiLCJ0aW1lQnVmZiIsImJveDJEYXJyIiwicmV2ZXJzZSIsInJvdyIsImJveGVzLXJldmVyc2UiLCJyYW5kb20tZngiLCJmeEluZGV4IiwidW5kZWZpbmVkIiwiYXJyIiwiaiIsIngiLCJsZW5ndGgiLCJwYXJzZUludCIsInJhbmRvbSJdLCJtYXBwaW5ncyI6IkNBQ0EsU0FBVUEsR0FFTixJQUFJQyxFQUVBQyxPQUFPQyxTQUNQRixFQUFZRCxFQUFNRyxTQUdELG1CQUFWQyxRQUF3QkEsT0FBT0MsS0FDdENELE9BQU8scUJBQXNCLENBQUMsU0FBVSxXQUNwQyxPQUFPSCxHQUFhRCxFQUFNRyxVQVZ0QyxDQWNHLFNBQVNHLEdBRVIsYUFFQSxJQUFJQyxFQUFhRCxFQUFHRSxVQUFVQyxXQUU5QkgsRUFBR0ksRUFBRUMsT0FBT0wsRUFBR0UsVUFBVUMsV0FBWSxDQUNqQ0csTUFBTyxTQUFTQyxFQUFTQyxFQUFNQyxFQUFLQyxHQUVoQyxJQUFLSCxFQUFRSSxLQUFLLFNBQ2QsT0FBT1YsRUFBV1csS0FBS0MsTUFBTUMsS0FBTUMsV0FvQnZDLElBakJBLElBZUlDLEVBZkFDLEVBQUlqQixFQUFHSSxFQUFFYyxXQUVUQyxFQUFhQyxLQUFLQyxLQUFLUCxLQUFLUSxRQUFRQyxRQUFVVCxLQUFLVSxRQUFRQyxRQUMzREMsRUFBYWxCLEVBQUtHLEtBQUssU0FBU2dCLElBQUksb0JBQ3BDQyxFQUFhNUIsRUFBR0ksRUFBRSx3Q0FBd0N1QixJQUFJLENBQzFERSxJQUFTLEVBQ1RDLEtBQVMsRUFDVFAsTUFBU1QsS0FBS2lCLFVBQVVSLFFBQ3hCUyxPQUFTbEIsS0FBS2lCLFVBQVVDLFNBQ3hCQyxRQUFTLEVBQ1RDLE9BQVMsS0FFYkMsRUFBY1AsRUFBTUwsUUFDcEJhLEVBQWNSLEVBQU1JLFNBSWZLLEVBQUksRUFBR0EsRUFBSXZCLEtBQUtVLFFBQVFDLE9BQVFZLElBQUssQ0FFNUIsaUJBQVYzQixLQUNRMkIsRUFBSSxFQUFLLEdBQUssR0FBRyxFQUFJLElBQUlELEdBR3JDLElBRUlFLEVBRkFm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RSxLQUFLMkUsUUFBVSxHQUV2Q3hGLEVBQVdFLEVBQVdXLEtBQUsyRSxVQUFVNUUsTUFBTUMsS0FBTUMsY0FRaEUsSUFBSWdFLEVBQVUsU0FBU1ksR0FDbkIsSUFBSyxJQUFJQyxFQUFHQyxFQUFHeEQsRUFBSXNELEVBQUlHLE9BQVF6RCxFQUFHdUQsRUFBSUcsU0FBUzNFLEtBQUs0RSxTQUFXM0QsR0FBSXdELEVBQUlGLElBQU10RCxHQUFJc0QsRUFBSXRELEdBQUtzRCxFQUFJQyxHQUFJRCxFQUFJQyxHQUFLQyxHQUMzRyxPQUFPRixHQUdYLE9BQU8zRixFQUFHRSxVQUFVQyIsImZpbGUiOiJjb21wb25lbnRzL3NsaWRlc2hvdy1meC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cbihmdW5jdGlvbihhZGRvbikge1xuXG4gICAgdmFyIGNvbXBvbmVudDtcblxuICAgIGlmICh3aW5kb3cuVUlraXQyKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGFkZG9uKFVJa2l0Mik7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZSgndWlraXQtc2xpZGVzaG93LWZ4JywgWyd1aWtpdCddLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQgfHwgYWRkb24oVUlraXQyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59KShmdW5jdGlvbihVSSkge1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgQW5pbWF0aW9ucyA9IFVJLnNsaWRlc2hvdy5hbmltYXRpb25zO1xuXG4gICAgVUkuJC5leHRlbmQoVUkuc2xpZGVzaG93LmFuaW1hdGlvbnMsIHtcbiAgICAgICAgc2xpY2U6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpciwgZnJvbWZ4KSB7XG5cbiAgICAgICAgICAgIGlmICghY3VycmVudC5kYXRhKCdjb3ZlcicpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFuaW1hdGlvbnMuZmFkZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZCA9IFVJLiQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgdmFyIHNsaWNlV2lkdGggPSBNYXRoLmNlaWwodGhpcy5lbGVtZW50LndpZHRoKCkgLyB0aGlzLm9wdGlvbnMuc2xpY2VzKSxcbiAgICAgICAgICAgICAgICBiZ2ltYWdlICAgID0gbmV4dC5kYXRhKCdjb3ZlcicpLmNzcygnYmFja2dyb3VuZC1pbWFnZScpLFxuICAgICAgICAgICAgICAgIGdob3N0ICAgICAgPSBVSS4kKCc8bGkgY2xhc3M9XCJ1ay1zbGlkZXNob3ctZ2hvc3RcIj48L2xpPicpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIHRvcCAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICA6IHRoaXMuY29udGFpbmVyLndpZHRoKCksXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA6IHRoaXMuY29udGFpbmVyLmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICB6SW5kZXggOiAxNVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGdob3N0V2lkdGggID0gZ2hvc3Qud2lkdGgoKSxcbiAgICAgICAgICAgICAgICBnaG9zdEhlaWdodCA9IGdob3N0LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgIHBvcyAgICAgICAgID0gZnJvbWZ4ID09ICdzbGljZS11cCcgPyBnaG9zdEhlaWdodDonMCcsXG4gICAgICAgICAgICAgICAgYmFyO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub3B0aW9ucy5zbGljZXM7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgaWYgKGZyb21meCA9PSAnc2xpY2UtdXAtZG93bicpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zID0gKChpICUgMikgKyAyKSAlIDI9PTAgPyAnMCc6Z2hvc3RIZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoICAgID0gKGkgPT0gdGhpcy5vcHRpb25zLnNsaWNlcy0xKSA/IHNsaWNlV2lkdGggOiBzbGljZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICBjbGlwdG8gICA9ICgncmVjdCgwcHgsICcrKHdpZHRoKihpKzEpKSsncHgsICcrZ2hvc3RIZWlnaHQrJ3B4LCAnKyhzbGljZVdpZHRoKmkpKydweCknKSxcbiAgICAgICAgICAgICAgICAgICAgY2xpcGZyb207XG5cbiAgICAgICAgICAgICAgICAvL3NsaWNlLWRvd24gLSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgY2xpcGZyb20gPSAoJ3JlY3QoMHB4LCAnKyh3aWR0aCooaSsxKSkrJ3B4LCAwcHgsICcrKHNsaWNlV2lkdGgqaSkrJ3B4KScpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZyb21meCA9PSAnc2xpY2UtdXAnIHx8IChmcm9tZnggPT0gJ3NsaWNlLXVwLWRvd24nICYmICgoaSAlIDIpICsgMikgJSAyPT0wICkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpcGZyb20gPSAoJ3JlY3QoJytnaG9zdEhlaWdodCsncHgsICcrKHdpZHRoKihpKzEpKSsncHgsICcrZ2hvc3RIZWlnaHQrJ3B4LCAnKyhzbGljZVdpZHRoKmkpKydweCknKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBiYXIgPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZFwiPjwvZGl2PicpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgIDogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RvcCcgICAgICAgICAgICAgICAgOiAwLFxuICAgICAgICAgICAgICAgICAgICAnbGVmdCcgICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCcgICAgICAgICAgICAgIDogZ2hvc3RXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICAgOiBnaG9zdEhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnICAgOiBiZ2ltYWdlLFxuICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgICA6IGNsaXBmcm9tLFxuICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eScgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJyAgICAgICAgIDogJ2FsbCAnK3RoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMgZWFzZS1pbi1vdXQgJysoaSo2MCkrJ21zJyxcbiAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNpdGlvbicgOiAnYWxsICcrdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcyBlYXNlLWluLW91dCAnKyhpKjYwKSsnbXMnXG5cbiAgICAgICAgICAgICAgICB9KS5kYXRhKCdjbGlwJywgY2xpcHRvKTtcblxuICAgICAgICAgICAgICAgIGdob3N0LmFwcGVuZChiYXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQoZ2hvc3QpO1xuXG4gICAgICAgICAgICBnaG9zdC5jaGlsZHJlbigpLmxhc3QoKS5vbihVSS5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGdob3N0LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnaG9zdC53aWR0aCgpO1xuXG4gICAgICAgICAgICBnaG9zdC5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgYmFyID0gVUkuJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBiYXIuY3NzKHsgY2xpcDogYmFyLmRhdGEoJ2NsaXAnKSwgb3BhY2l0eTogMSB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgJ3NsaWNlLXVwJzogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyKSB7XG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5zbGljZS5hcHBseSh0aGlzLCBbY3VycmVudCwgbmV4dCwgZGlyLCAnc2xpY2UtdXAnXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgJ3NsaWNlLWRvd24nOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIpIHtcbiAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zLnNsaWNlLmFwcGx5KHRoaXMsIFtjdXJyZW50LCBuZXh0LCBkaXIsICdzbGljZS1kb3duJ10pO1xuICAgICAgICB9LFxuXG4gICAgICAgICdzbGljZS11cC1kb3duJzogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyKSB7XG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5zbGljZS5hcHBseSh0aGlzLCBbY3VycmVudCwgbmV4dCwgZGlyLCAnc2xpY2UtdXAtZG93biddKTtcbiAgICAgICAgfSxcblxuICAgICAgICBmb2xkOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIpIHtcblxuICAgICAgICAgICAgaWYgKCFuZXh0LmRhdGEoJ2NvdmVyJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5mYWRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkID0gVUkuJC5EZWZlcnJlZCgpO1xuXG4gICAgICAgICAgICB2YXIgc2xpY2VXaWR0aCA9IE1hdGguY2VpbCh0aGlzLmVsZW1lbnQud2lkdGgoKSAvIHRoaXMub3B0aW9ucy5zbGljZXMpLFxuICAgICAgICAgICAgICAgIGJnaW1hZ2UgICAgPSBuZXh0LmRhdGEoJ2NvdmVyJykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJyksXG4gICAgICAgICAgICAgICAgZ2hvc3QgICAgICA9IFVJLiQoJzxsaSBjbGFzcz1cInVrLXNsaWRlc2hvdy1naG9zdFwiPjwvbGk+JykuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggIDogbmV4dC53aWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgOiBuZXh0LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICB6SW5kZXggOiAxNVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGdob3N0V2lkdGggID0gbmV4dC53aWR0aCgpLFxuICAgICAgICAgICAgICAgIGdob3N0SGVpZ2h0ID0gbmV4dC5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBiYXI7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vcHRpb25zLnNsaWNlczsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICBiYXIgPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZFwiPjwvZGl2PicpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgIDogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RvcCcgICAgICAgICAgICAgICAgOiAwLFxuICAgICAgICAgICAgICAgICAgICAnbGVmdCcgICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCcgICAgICAgICAgICAgIDogZ2hvc3RXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICAgOiBnaG9zdEhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnICAgOiBiZ2ltYWdlLFxuICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtLW9yaWdpbicgICA6IChzbGljZVdpZHRoKmkpKydweCAwIDAnLFxuICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgICA6ICgncmVjdCgwcHgsICcrKHNsaWNlV2lkdGgqKGkrMSkpKydweCwgJytnaG9zdEhlaWdodCsncHgsICcrKHNsaWNlV2lkdGgqaSkrJ3B4KScpLFxuICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eScgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nICAgICAgICAgIDogJ3NjYWxlWCgwLjAwMDAwMSknLFxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbicgICAgICAgICA6ICdhbGwgJyt0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKDEwMCtpKjYwKSsnbXMnLFxuICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJyA6ICdhbGwgJyt0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKDEwMCtpKjYwKSsnbXMnXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBnaG9zdC5wcmVwZW5kKGJhcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChnaG9zdCk7XG5cbiAgICAgICAgICAgIGdob3N0LndpZHRoKCk7XG5cbiAgICAgICAgICAgIGdob3N0LmNoaWxkcmVuKCkuZmlyc3QoKS5vbihVSS5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBnaG9zdC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9KS5lbmQoKS5jc3Moe1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlWCgxKScsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBwdXp6bGU6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xuXG4gICAgICAgICAgICBpZiAoIW5leHQuZGF0YSgnY292ZXInKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zLmZhZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBVSS4kLkRlZmVycmVkKCksICR0aGlzID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGJveENvbHMgICA9IE1hdGgucm91bmQodGhpcy5vcHRpb25zLnNsaWNlcy8yKSxcbiAgICAgICAgICAgICAgICBib3hXaWR0aCAgPSBNYXRoLnJvdW5kKG5leHQud2lkdGgoKS9ib3hDb2xzKSxcbiAgICAgICAgICAgICAgICBib3hSb3dzICAgPSBNYXRoLnJvdW5kKG5leHQuaGVpZ2h0KCkvYm94V2lkdGgpLFxuICAgICAgICAgICAgICAgIGJveEhlaWdodCA9IE1hdGgucm91bmQobmV4dC5oZWlnaHQoKS9ib3hSb3dzKSsxLFxuICAgICAgICAgICAgICAgIGJnaW1hZ2UgICA9IG5leHQuZGF0YSgnY292ZXInKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSxcbiAgICAgICAgICAgICAgICBnaG9zdCAgICAgPSBVSS4kKCc8bGkgY2xhc3M9XCJ1ay1zbGlkZXNob3ctZ2hvc3RcIj48L2xpPicpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICAgOiB0aGlzLmNvbnRhaW5lci53aWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgIDogdGhpcy5jb250YWluZXIuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHkgOiAxLFxuICAgICAgICAgICAgICAgICAgICB6SW5kZXggIDogMTVcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBnaG9zdFdpZHRoICA9IHRoaXMuY29udGFpbmVyLndpZHRoKCksXG4gICAgICAgICAgICAgICAgZ2hvc3RIZWlnaHQgPSB0aGlzLmNvbnRhaW5lci5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBib3gsIHJlY3QsIHdpZHRoO1xuXG4gICAgICAgICAgICBmb3IgKHZhciByb3dzID0gMDsgcm93cyA8IGJveFJvd3M7IHJvd3MrKykge1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY29scyA9IDA7IGNvbHMgPCBib3hDb2xzOyBjb2xzKyspIHtcblxuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgPSAoY29scyA9PSBib3hDb2xzLTEpID8gKGJveFdpZHRoICsgMikgOiBib3hXaWR0aDtcblxuICAgICAgICAgICAgICAgICAgICByZWN0ID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgKGJveEhlaWdodCAqIHJvd3MpICAgICAgICsncHgnLCAvLyB0b3BcbiAgICAgICAgICAgICAgICAgICAgICAgICh3aWR0aCAgKiAoY29scysxKSkgICAgICArJ3B4JywgLy8gcmlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgIChib3hIZWlnaHQgKiAocm93cyArIDEpKSArJ3B4JywgLy8gYm90dG9tXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94V2lkdGggICogY29scykgICAgICAgKydweCcgIC8vIGxlZnRcbiAgICAgICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgICAgICBib3ggPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZFwiPjwvZGl2PicpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nICAgICAgICAgIDogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0b3AnICAgICAgICAgICAgICAgOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xlZnQnICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eScgICAgICAgICAgIDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICd3aWR0aCcgICAgICAgICAgICAgOiBnaG9zdFdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICA6IGdob3N0SGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnICA6IGJnaW1hZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgIDogKCdyZWN0KCcrcmVjdC5qb2luKCcsJykrJyknKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybScgOiAndHJhbnNsYXRlWigwKScsIC8vIGZpeGVzIHdlYmtpdCBvcGFjaXR5IGZsaWNrZXJpbmcgYnVnXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJyAgICAgICAgIDogJ3RyYW5zbGF0ZVooMCknICAgICAgICAgIC8vIGZpeGVzIG1veiBvcGFjaXR5IGZsaWNrZXJpbmcgYnVnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGdob3N0LmFwcGVuZChib3gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGdob3N0KTtcblxuICAgICAgICAgICAgdmFyIGJveGVzID0gc2h1ZmZsZShnaG9zdC5jaGlsZHJlbigpKTtcblxuICAgICAgICAgICAgYm94ZXMuZWFjaChmdW5jdGlvbihpKSB7XG4gICAgICAgICAgICAgICAgVUkuJCh0aGlzKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6ICdhbGwgJyskdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcyBlYXNlLWluLW91dCAnKyg1MCtpKjI1KSsnbXMnLFxuICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJzogJ2FsbCAnKyR0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKDUwK2kqMjUpKydtcydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLmxhc3QoKS5vbihVSS5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGdob3N0LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBnaG9zdC53aWR0aCgpO1xuXG4gICAgICAgICAgICBib3hlcy5jc3Moe29wYWNpdHk6IDF9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGJveGVzOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIsIGZyb21meCkge1xuXG4gICAgICAgICAgICBpZiAoIW5leHQuZGF0YSgnY292ZXInKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zLmZhZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGQgPSBVSS4kLkRlZmVycmVkKCk7XG5cbiAgICAgICAgICAgIHZhciBib3hDb2xzICAgPSBNYXRoLnJvdW5kKHRoaXMub3B0aW9ucy5zbGljZXMvMiksXG4gICAgICAgICAgICAgICAgYm94V2lkdGggID0gTWF0aC5yb3VuZChuZXh0LndpZHRoKCkvYm94Q29scyksXG4gICAgICAgICAgICAgICAgYm94Um93cyAgID0gTWF0aC5yb3VuZChuZXh0LmhlaWdodCgpL2JveFdpZHRoKSxcbiAgICAgICAgICAgICAgICBib3hIZWlnaHQgPSBNYXRoLnJvdW5kKG5leHQuaGVpZ2h0KCkvYm94Um93cykrMSxcbiAgICAgICAgICAgICAgICBiZ2ltYWdlICAgPSBuZXh0LmRhdGEoJ2NvdmVyJykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJyksXG4gICAgICAgICAgICAgICAgZ2hvc3QgICAgID0gVUkuJCgnPGxpIGNsYXNzPVwidWstc2xpZGVzaG93LWdob3N0XCI+PC9saT4nKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgIDogbmV4dC53aWR0aCgpLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgIDogbmV4dC5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSA6IDEsXG4gICAgICAgICAgICAgICAgICAgIHpJbmRleCAgOiAxNVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGdob3N0V2lkdGggID0gbmV4dC53aWR0aCgpLFxuICAgICAgICAgICAgICAgIGdob3N0SGVpZ2h0ID0gbmV4dC5oZWlnaHQoKSxcbiAgICAgICAgICAgICAgICBib3gsIHJlY3QsIHdpZHRoLCBjb2xzO1xuXG4gICAgICAgICAgICBmb3IgKHZhciByb3dzID0gMDsgcm93cyA8IGJveFJvd3M7IHJvd3MrKykge1xuXG4gICAgICAgICAgICAgICAgZm9yIChjb2xzID0gMDsgY29scyA8IGJveENvbHM7IGNvbHMrKykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICA9IChjb2xzID09IGJveENvbHMtMSkgPyAoYm94V2lkdGggKyAyKSA6IGJveFdpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlY3QgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94SGVpZ2h0ICogcm93cykgICAgICAgKydweCcsIC8vIHRvcFxuICAgICAgICAgICAgICAgICAgICAgICAgKHdpZHRoICAqIChjb2xzKzEpKSAgICAgICsncHgnLCAvLyByaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgKGJveEhlaWdodCAqIChyb3dzICsgMSkpICsncHgnLCAvLyBib3R0b21cbiAgICAgICAgICAgICAgICAgICAgICAgIChib3hXaWR0aCAgKiBjb2xzKSAgICAgICArJ3B4JyAgLy8gbGVmdFxuICAgICAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGJveCA9IFVJLiQoJzxkaXYgY2xhc3M9XCJ1ay1jb3Zlci1iYWNrZ3JvdW5kXCI+PC9kaXY+JykuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RvcCcgICAgICAgICAgICAgICA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbGVmdCcgICAgICAgICAgICAgIDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JyAgICAgICAgICAgOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3dpZHRoJyAgICAgICAgICAgICA6IGdob3N0V2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JyAgICAgICAgICAgIDogZ2hvc3RIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZScgIDogYmdpbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0tb3JpZ2luJyAgOiByZWN0WzNdKycgJytyZWN0WzBdKycgMCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgIDogKCdyZWN0KCcrcmVjdC5qb2luKCcsJykrJyknKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybScgOiAnc2NhbGUoMC4wMDAwMDAwMDAwMDAwMDAxKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJyAgICAgICAgIDogJ3NjYWxlKDAuMDAwMDAwMDAwMDAwMDAwMSknXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGdob3N0LmFwcGVuZChib3gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGdob3N0KTtcblxuICAgICAgICAgICAgdmFyIHJvd0luZGV4ID0gMCwgY29sSW5kZXggPSAwLCB0aW1lQnVmZiA9IDAsIGJveDJEYXJyID0gW1tdXSwgYm94ZXMgPSBnaG9zdC5jaGlsZHJlbigpLCBwcmV2Q29sO1xuXG4gICAgICAgICAgICBpZiAoZnJvbWZ4ID09ICdib3hlcy1yZXZlcnNlJykge1xuICAgICAgICAgICAgICAgIGJveGVzID0gW10ucmV2ZXJzZS5hcHBseShib3hlcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJveGVzLmVhY2goZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBib3gyRGFycltyb3dJbmRleF1bY29sSW5kZXhdID0gVUkuJCh0aGlzKTtcbiAgICAgICAgICAgICAgICBjb2xJbmRleCsrO1xuXG4gICAgICAgICAgICAgICAgaWYoY29sSW5kZXggPT0gYm94Q29scykge1xuICAgICAgICAgICAgICAgICAgICByb3dJbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICBjb2xJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGJveDJEYXJyW3Jvd0luZGV4XSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmb3IgKGNvbHMgPSAwLCBwcmV2Q29sID0gMDsgY29scyA8IChib3hDb2xzICogYm94Um93cyk7IGNvbHMrKykge1xuXG4gICAgICAgICAgICAgICAgcHJldkNvbCA9IGNvbHM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCBib3hSb3dzOyByb3crKykge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2Q29sID49IDAgJiYgcHJldkNvbCA8IGJveENvbHMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYm94MkRhcnJbcm93XVtwcmV2Q29sXS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzogJ2FsbCAnK3RoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMgbGluZWFyICcrKDUwK3RpbWVCdWZmKSsnbXMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zaXRpb24nOiAnYWxsICcrdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcyBsaW5lYXIgJysoNTArdGltZUJ1ZmYpKydtcydcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByZXZDb2wtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGltZUJ1ZmYgKz0gMTAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBib3hlcy5sYXN0KCkub24oVUkuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBnaG9zdC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZ2hvc3Qud2lkdGgoKTtcblxuICAgICAgICAgICAgYm94ZXMuY3NzKHtcbiAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAnc2NhbGUoMSknLFxuICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiAnc2NhbGUoMSknXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgICdib3hlcy1yZXZlcnNlJzogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyKSB7XG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5ib3hlcy5hcHBseSh0aGlzLCBbY3VycmVudCwgbmV4dCwgZGlyLCAnYm94ZXMtcmV2ZXJzZSddKTtcbiAgICAgICAgfSxcblxuICAgICAgICAncmFuZG9tLWZ4JzogZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbnMgPSBbJ3NsaWNlLXVwJywgJ2ZvbGQnLCAncHV6emxlJywgJ3NsaWNlLWRvd24nLCAnYm94ZXMnLCAnc2xpY2UtdXAtZG93bicsICdib3hlcy1yZXZlcnNlJ107XG5cbiAgICAgICAgICAgIHRoaXMuZnhJbmRleCA9ICh0aGlzLmZ4SW5kZXggPT09IHVuZGVmaW5lZCA/IC0xIDogdGhpcy5meEluZGV4KSArIDE7XG5cbiAgICAgICAgICAgIGlmICghYW5pbWF0aW9uc1t0aGlzLmZ4SW5kZXhdKSB0aGlzLmZ4SW5kZXggPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9uc1thbmltYXRpb25zW3RoaXMuZnhJbmRleF1dLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgLy8gaGVscGVyIGZ1bmN0aW9uc1xuXG4gICAgLy8gU2h1ZmZsZSBhbiBhcnJheVxuICAgIHZhciBzaHVmZmxlID0gZnVuY3Rpb24oYXJyKSB7XG4gICAgICAgIGZvciAodmFyIGosIHgsIGkgPSBhcnIubGVuZ3RoOyBpOyBqID0gcGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIGkpLCB4ID0gYXJyWy0taV0sIGFycltpXSA9IGFycltqXSwgYXJyW2pdID0geCkge31cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFVJLnNsaWRlc2hvdy5hbmltYXRpb25zO1xufSk7Il19
