!function(t){var e;window.UIkit2&&(e=t(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-htmleditor",["uikit"],function(){return e||t(UIkit2)})}(function(s){"use strict";var e=[];return s.component("htmleditor",{defaults:{iframe:!1,mode:"split",markdown:!1,autocomplete:!0,enablescripts:!1,height:500,maxsplitsize:1e3,codemirror:{mode:"htmlmixed",lineWrapping:!0,dragDrop:!1,autoCloseTags:!0,matchTags:!0,autoCloseBrackets:!0,matchBrackets:!0,indentUnit:4,indentWithTabs:!1,tabSize:4,hintOptions:{completionSingle:!1}},toolbar:["bold","italic","strike","link","image","blockquote","listUl","listOl"],lblPreview:"Preview",lblCodeview:"HTML",lblMarkedview:"Markdown"},boot:function(){s.ready(function(t){s.$("textarea[data-uk-htmleditor]",t).each(function(){var t=s.$(this);t.data("htmleditor")||s.htmleditor(t,s.Utils.options(t.attr("data-uk-htmleditor")))})})},init:function(){var o=this,t=s.components.htmleditor.template;this.CodeMirror=this.options.CodeMirror||CodeMirror,this.buttons={},t=(t=t.replace(/\{:lblPreview}/g,this.options.lblPreview)).replace(/\{:lblCodeview}/g,this.options.lblCodeview),this.htmleditor=s.$(t),this.content=this.htmleditor.find(".uk-htmleditor-content"),this.toolbar=this.htmleditor.find(".uk-htmleditor-toolbar"),this.preview=this.htmleditor.find(".uk-htmleditor-preview").children().eq(0),this.code=this.htmleditor.find(".uk-htmleditor-code"),this.element.before(this.htmleditor).appendTo(this.code),this.editor=this.CodeMirror.fromTextArea(this.element[0],this.options.codemirror),(this.editor.htmleditor=this).editor.on("change",s.Utils.debounce(function(){o.render()},150)),this.editor.on("change",function(){o.editor.save(),o.element.trigger("input")}),this.code.find(".CodeMirror").css("height",this.options.height),this.options.iframe?(this.iframe=s.$('<iframe class="uk-htmleditor-iframe" frameborder="0" scrolling="auto" height="100" width="100%"></iframe>'),this.preview.append(this.iframe),this.iframe[0].contentWindow.document.open(),this.iframe[0].contentWindow.document.close(),this.preview.container=s.$(this.iframe[0].contentWindow.document).find("body"),"string"==typeof this.options.iframe&&this.preview.container.parent().append('<link rel="stylesheet" href="'+this.options.iframe+'">')):this.preview.container=this.preview,s.$win.on("resize load",s.Utils.debounce(function(){o.fit()},200));var n=this.iframe?this.preview.container:o.preview.parent(),r=this.code.find(".CodeMirror-sizer"),l=this.code.find(".CodeMirror-scroll").on("scroll",s.Utils.debounce(function(){if("tab"!=o.htmleditor.attr("data-mode")){var t=r.height()-l.height(),e=(n[0].scrollHeight-(o.iframe?o.iframe.height():n.height()))/t,i=l.scrollTop()*e;n.scrollTop(i)}},10));this.htmleditor.on("click",".uk-htmleditor-button-code, .uk-htmleditor-button-preview",function(t){t.preventDefault(),"tab"==o.htmleditor.attr("data-mode")&&(o.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter(this).addClass("uk-active"),o.activetab=s.$(this).hasClass("uk-htmleditor-button-code")?"code":"preview",o.htmleditor.attr("data-active-tab",o.activetab),o.editor.refresh())}),this.htmleditor.on("click","a[data-htmleditor-button]",function(){o.code.is(":visible")&&o.trigger("action."+s.$(this).data("htmleditor-button"),[o.editor])}),this.preview.parent().css("height",this.code.height()),this.options.autocomplete&&this.CodeMirror.showHint&&this.CodeMirror.hint&&this.CodeMirror.hint.html&&this.editor.on("inputRead",s.Utils.debounce(function(){var t=o.editor.getDoc().getCursor();if("xml"==o.CodeMirror.innerMode(o.editor.getMode(),o.editor.getTokenAt(t).state).mode.name){var e=o.editor.getCursor(),i=o.editor.getTokenAt(e);"<"!=i.string.charAt(0)&&"attribute"!=i.type||o.CodeMirror.showHint(o.editor,o.CodeMirror.hint.html,{completeSingle:!1})}},100)),this.debouncedRedraw=s.Utils.debounce(function(){o.redraw()},5),this.on("init.uk.component",function(){o.debouncedRedraw()}),this.element.attr("data-uk-check-display",1).on("display.uk.check",function(t){this.htmleditor.is(":visible")&&this.fit()}.bind(this)),e.push(this)},addButton:function(t,e){this.buttons[t]=e},addButtons:function(t){s.$.extend(this.buttons,t)},replaceInPreview:function(t,i){var o=this.editor,n=[],r=o.getValue(),l=-1,s=0;function a(t){var e=o.getValue().substring(0,t).split("\n");return{line:e.length-1,ch:e[e.length-1].length}}return this.currentvalue=this.currentvalue.replace(t,function(){var e={matches:arguments,from:a(l=r.indexOf(arguments[0],++l)),to:a(l+arguments[0].length),replace:function(t){o.replaceRange(t,e.from,e.to)},inRange:function(t){return t.line===e.from.line&&t.line===e.to.line?t.ch>=e.from.ch&&t.ch<e.to.ch:t.line===e.from.line&&t.ch>=e.from.ch||t.line>e.from.line&&t.line<e.to.line||t.line===e.to.line&&t.ch<e.to.ch}},t="string"==typeof i?i:i(e,s);return t||""===t?(s++,n.push(e),t):arguments[0]}),n},_buildtoolbar:function(){if(this.options.toolbar&&this.options.toolbar.length){var i=this,o=[];this.toolbar.empty(),this.options.toolbar.forEach(function(t){if(i.buttons[t]){var e=i.buttons[t].title?i.buttons[t].title:t;o.push('<li><a data-htmleditor-button="'+t+'" title="'+e+'" data-uk-tooltip>'+i.buttons[t].label+"</a></li>")}}),this.toolbar.html(o.join("\n"))}},fit:function(){var t=this.options.mode;"split"==t&&this.htmleditor.width()<this.options.maxsplitsize&&(t="tab"),"tab"==t&&(this.activetab||(this.activetab="code",this.htmleditor.attr("data-active-tab",this.activetab)),this.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter("code"==this.activetab?".uk-htmleditor-button-code":".uk-htmleditor-button-preview").addClass("uk-active")),this.editor.refresh(),this.preview.parent().css("height",this.code.height()),this.htmleditor.attr("data-mode",t)},redraw:function(){this._buildtoolbar(),this.render(),this.fit()},getMode:function(){return this.editor.getOption("mode")},getCursorMode:function(){var t={mode:"html"};return this.trigger("cursorMode",[t]),t.mode},render:function(){if(this.currentvalue=this.editor.getValue(),this.options.enablescripts||(this.currentvalue=this.currentvalue.replace(/<(script|style)\b[^<]*(?:(?!<\/(script|style)>)<[^<]*)*<\/(script|style)>/gim,"")),!this.currentvalue)return this.element.val(""),void this.preview.container.html("");this.trigger("render",[this]),this.trigger("renderLate",[this]),this.preview.container.html(this.currentvalue)},addShortcut:function(t,e){var i={};return s.$.isArray(t)||(t=[t]),t.forEach(function(t){i[t]=e}),this.editor.addKeyMap(i),i},addShortcutAction:function(t,e){var i=this;this.addShortcut(e,function(){i.element.trigger("action."+t,[i.editor])})},replaceSelection:function(t){var e=this.editor.getSelection();if(!e.length){for(var i=this.editor.getCursor(),o=this.editor.getLine(i.line),n=i.ch,r=n;r<o.length&&/[\w$]+/.test(o.charAt(r));)++r;for(;n&&/[\w$]+/.test(o.charAt(n-1));)--n;var l=n!=r&&o.slice(n,r);l&&(this.editor.setSelection({line:i.line,ch:n},{line:i.line,ch:r}),e=l)}var s=t.replace("$1",e);this.editor.replaceSelection(s,"end"),this.editor.focus()},replaceLine:function(t){var e=this.editor.getDoc().getCursor(),i=this.editor.getLine(e.line),o=t.replace("$1",i);this.editor.replaceRange(o,{line:e.line,ch:0},{line:e.line,ch:i.length}),this.editor.setCursor({line:e.line,ch:o.length}),this.editor.focus()},save:function(){this.editor.save()}}),s.components.htmleditor.template=['<div class="uk-htmleditor uk-clearfix" data-mode="split">','<div class="uk-htmleditor-navbar">','<ul class="uk-htmleditor-navbar-nav uk-htmleditor-toolbar"></ul>','<div class="uk-htmleditor-navbar-flip">','<ul class="uk-htmleditor-navbar-nav">','<li class="uk-htmleditor-button-code"><a>{:lblCodeview}</a></li>','<li class="uk-htmleditor-button-preview"><a>{:lblPreview}</a></li>','<li><a data-htmleditor-button="fullscreen"><i class="uk-icon-expand"></i></a></li>',"</ul>","</div>","</div>",'<div class="uk-htmleditor-content">','<div class="uk-htmleditor-code"></div>','<div class="uk-htmleditor-preview"><div></div></div>',"</div>","</div>"].join(""),s.plugin("htmleditor","base",{init:function(a){a.addButtons({fullscreen:{title:"Fullscreen",label:'<i class="uk-icon-expand"></i>'},bold:{title:"Bold",label:'<i class="uk-icon-bold"></i>'},italic:{title:"Italic",label:'<i class="uk-icon-italic"></i>'},strike:{title:"Strikethrough",label:'<i class="uk-icon-strikethrough"></i>'},blockquote:{title:"Blockquote",label:'<i class="uk-icon-quote-right"></i>'},link:{title:"Link",label:'<i class="uk-icon-link"></i>'},image:{title:"Image",label:'<i class="uk-icon-picture-o"></i>'},listUl:{title:"Unordered List",label:'<i class="uk-icon-list-ul"></i>'},listOl:{title:"Ordered List",label:'<i class="uk-icon-list-ol"></i>'}}),e("bold","<strong>$1</strong>"),e("italic","<em>$1</em>"),e("strike","<del>$1</del>"),e("blockquote","<blockquote><p>$1</p></blockquote>","replaceLine"),e("link",'<a href="http://">$1</a>'),e("image",'<img src="http://" alt="$1">');var t=function(t){if("html"==a.getCursorMode()){t=t||"ul";for(var e=a.editor,i=e.getDoc(),o=i.getCursor(!0),n=i.getCursor(!1),r=CodeMirror.innerMode(e.getMode(),e.getTokenAt(e.getCursor()).state),l=r&&r.state&&r.state.context&&-1!=["ul","ol"].indexOf(r.state.context.tagName),s=o.line;s<n.line+1;s++)e.replaceRange("<li>"+e.getLine(s)+"</li>",{line:s,ch:0},{line:s,ch:e.getLine(s).length});l?e.setCursor({line:n.line,ch:e.getLine(n.line).length}):(e.replaceRange("<"+t+">\n"+e.getLine(o.line),{line:o.line,ch:0},{line:o.line,ch:e.getLine(o.line).length}),e.replaceRange(e.getLine(n.line+1)+"\n</"+t+">",{line:n.line+1,ch:0},{line:n.line+1,ch:e.getLine(n.line+1).length}),e.setCursor({line:n.line+1,ch:e.getLine(n.line+1).length})),e.focus()}};function e(t,e,i){a.on("action."+t,function(){"html"==a.getCursorMode()&&a["replaceLine"==i?"replaceLine":"replaceSelection"](e)})}a.on("action.listUl",function(){t("ul")}),a.on("action.listOl",function(){t("ol")}),a.htmleditor.on("click",'a[data-htmleditor-button="fullscreen"]',function(){a.htmleditor.toggleClass("uk-htmleditor-fullscreen");var t=a.editor.getWrapperElement();if(a.htmleditor.hasClass("uk-htmleditor-fullscreen")){var e=!1,i=a.htmleditor.parents().each(function(){"fixed"!=s.$(this).css("position")||s.$(this).is("html")||(e=s.$(this))});if(a.htmleditor.data("fixedParents",!1),e){var o=[];e=e.parent().find(i).each(function(){"none"!=s.$(this).css("transform")&&o.push(s.$(this).data("transform-reset",{transform:this.style.transform,"-webkit-transform":this.style.webkitTransform,"-webkit-transition":this.style.webkitTransition,transition:this.style.transition}).css({transform:"none","-webkit-transform":"none","-webkit-transition":"none",transition:"none"}))}),a.htmleditor.data("fixedParents",o)}a.editor.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height=a.content.height()+"px",document.documentElement.style.overflow="hidden"}else{document.documentElement.style.overflow="";var n=a.editor.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),a.htmleditor.data("fixedParents")&&a.htmleditor.data("fixedParents").forEach(function(t){t.css(t.data("transform-reset"))})}setTimeout(function(){a.fit(),s.$win.trigger("resize")},50)}),a.addShortcut(["Ctrl-S","Cmd-S"],function(){a.element.trigger("htmleditor-save",[a])}),a.addShortcutAction("bold",["Ctrl-B","Cmd-B"])}}),s.plugin("htmleditor","markdown",{init:function(l){var t=l.options.mdparser||window.marked||null;function e(){l.editor.setOption("mode","gfm"),l.htmleditor.find(".uk-htmleditor-button-code a").html(l.options.lblMarkedview)}function i(t,e,i){l.on("action."+t,function(){"markdown"==l.getCursorMode()&&l["replaceLine"==i?"replaceLine":"replaceSelection"](e)})}t&&(l.options.markdown&&e(),i("bold","**$1**"),i("italic","*$1*"),i("strike","~~$1~~"),i("blockquote","> $1","replaceLine"),i("link","[$1](http://)"),i("image","![$1](http://)"),l.on("action.listUl",function(){if("markdown"==l.getCursorMode()){for(var t=l.editor,e=t.getDoc().getCursor(!0),i=t.getDoc().getCursor(!1),o=e.line;o<i.line+1;o++)t.replaceRange("* "+t.getLine(o),{line:o,ch:0},{line:o,ch:t.getLine(o).length});t.setCursor({line:i.line,ch:t.getLine(i.line).length}),t.focus()}}),l.on("action.listOl",function(){if("markdown"==l.getCursorMode()){var t,e=l.editor,i=e.getDoc().getCursor(!0),o=e.getDoc().getCursor(!1),n=1;if(0<i.line)(t=e.getLine(i.line-1).match(/^(\d+)\./))&&(n=Number(t[1])+1);for(var r=i.line;r<o.line+1;r++)e.replaceRange(n+". "+e.getLine(r),{line:r,ch:0},{line:r,ch:e.getLine(r).length}),n++;e.setCursor({line:o.line,ch:e.getLine(o.line).length}),e.focus()}}),l.on("renderLate",function(){"gfm"==l.editor.options.mode&&(l.currentvalue=t(l.currentvalue))}),l.on("cursorMode",function(t,e){if("gfm"==l.editor.options.mode){var i=l.editor.getDoc().getCursor();l.editor.getTokenAt(i).state.base.htmlState||(e.mode="markdown")}}),s.$.extend(l,{enableMarkdown:function(){e(),this.render()},disableMarkdown:function(){this.editor.setOption("mode","htmlmixed"),this.htmleditor.find(".uk-htmleditor-button-code a").html(this.options.lblCodeview),this.render()}}),l.on({enableMarkdown:function(){l.enableMarkdown()},disableMarkdown:function(){l.disableMarkdown()}}))}}),s.htmleditor});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvaHRtbGVkaXRvci5qcyJdLCJuYW1lcyI6WyJhZGRvbiIsImNvbXBvbmVudCIsIndpbmRvdyIsIlVJa2l0MiIsImRlZmluZSIsImFtZCIsIlVJIiwiZWRpdG9ycyIsImRlZmF1bHRzIiwiaWZyYW1lIiwibW9kZSIsIm1hcmtkb3duIiwiYXV0b2NvbXBsZXRlIiwiZW5hYmxlc2NyaXB0cyIsImhlaWdodCIsIm1heHNwbGl0c2l6ZSIsImNvZGVtaXJyb3IiLCJsaW5lV3JhcHBpbmciLCJkcmFnRHJvcCIsImF1dG9DbG9zZVRhZ3MiLCJtYXRjaFRhZ3MiLCJhdXRvQ2xvc2VCcmFja2V0cyIsIm1hdGNoQnJhY2tldHMiLCJpbmRlbnRVbml0IiwiaW5kZW50V2l0aFRhYnMiLCJ0YWJTaXplIiwiaGludE9wdGlvbnMiLCJjb21wbGV0aW9uU2luZ2xlIiwidG9vbGJhciIsImxibFByZXZpZXciLCJsYmxDb2RldmlldyIsImxibE1hcmtlZHZpZXciLCJib290IiwicmVhZHkiLCJjb250ZXh0IiwiJCIsImVhY2giLCJlZGl0b3IiLCJ0aGlzIiwiZGF0YSIsImh0bWxlZGl0b3IiLCJVdGlscyIsIm9wdGlvbnMiLCJhdHRyIiwiaW5pdCIsIiR0aGlzIiwidHBsIiwiY29tcG9uZW50cyIsInRlbXBsYXRlIiwiQ29kZU1pcnJvciIsImJ1dHRvbnMiLCJyZXBsYWNlIiwiY29udGVudCIsImZpbmQiLCJwcmV2aWV3IiwiY2hpbGRyZW4iLCJlcSIsImNvZGUiLCJlbGVtZW50IiwiYmVmb3JlIiwiYXBwZW5kVG8iLCJmcm9tVGV4dEFyZWEiLCJvbiIsImRlYm91bmNlIiwicmVuZGVyIiwic2F2ZSIsInRyaWdnZXIiLCJjc3MiLCJhcHBlbmQiLCJjb250ZW50V2luZG93IiwiZG9jdW1lbnQiLCJvcGVuIiwiY2xvc2UiLCJjb250YWluZXIiLCJwYXJlbnQiLCIkd2luIiwiZml0IiwicHJldmlld0NvbnRhaW5lciIsImNvZGVDb250ZW50IiwiY29kZVNjcm9sbCIsImNvZGVIZWlnaHQiLCJyYXRpbyIsInNjcm9sbEhlaWdodCIsInByZXZpZXdQb3NpdGlvbiIsInNjcm9sbFRvcCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlbW92ZUNsYXNzIiwiZmlsdGVyIiwiYWRkQ2xhc3MiLCJhY3RpdmV0YWIiLCJoYXNDbGFzcyIsInJlZnJlc2giLCJpcyIsInNob3dIaW50IiwiaGludCIsImh0bWwiLCJQT1MiLCJnZXREb2MiLCJnZXRDdXJzb3IiLCJpbm5lck1vZGUiLCJnZXRNb2RlIiwiZ2V0VG9rZW5BdCIsInN0YXRlIiwibmFtZSIsImN1ciIsInRva2VuIiwic3RyaW5nIiwiY2hhckF0IiwidHlwZSIsImNvbXBsZXRlU2luZ2xlIiwiZGVib3VuY2VkUmVkcmF3IiwicmVkcmF3IiwiYmluZCIsInB1c2giLCJhZGRCdXR0b24iLCJidXR0b24iLCJhZGRCdXR0b25zIiwiZXh0ZW5kIiwicmVwbGFjZUluUHJldmlldyIsInJlZ2V4cCIsImNhbGxiYWNrIiwicmVzdWx0cyIsInZhbHVlIiwiZ2V0VmFsdWUiLCJvZmZzZXQiLCJpbmRleCIsInRyYW5zbGF0ZU9mZnNldCIsInJlc3VsdCIsInN1YnN0cmluZyIsInNwbGl0IiwibGluZSIsImxlbmd0aCIsImNoIiwiY3VycmVudHZhbHVlIiwibWF0Y2giLCJtYXRjaGVzIiwiYXJndW1lbnRzIiwiZnJvbSIsImluZGV4T2YiLCJ0byIsInJlcGxhY2VSYW5nZSIsImluUmFuZ2UiLCJjdXJzb3IiLCJfYnVpbGR0b29sYmFyIiwiYmFyIiwiZW1wdHkiLCJmb3JFYWNoIiwidGl0bGUiLCJsYWJlbCIsImpvaW4iLCJ3aWR0aCIsImdldE9wdGlvbiIsImdldEN1cnNvck1vZGUiLCJwYXJhbSIsInZhbCIsImFkZFNob3J0Y3V0IiwibWFwIiwiaXNBcnJheSIsImtleSIsImFkZEtleU1hcCIsImFkZFNob3J0Y3V0QWN0aW9uIiwiYWN0aW9uIiwic2hvcnRjdXRzIiwicmVwbGFjZVNlbGVjdGlvbiIsInRleHQiLCJnZXRTZWxlY3Rpb24iLCJjdXJMaW5lIiwiZ2V0TGluZSIsInN0YXJ0IiwiZW5kIiwidGVzdCIsImN1cldvcmQiLCJzbGljZSIsInNldFNlbGVjdGlvbiIsImZvY3VzIiwicmVwbGFjZUxpbmUiLCJwb3MiLCJzZXRDdXJzb3IiLCJwbHVnaW4iLCJmdWxsc2NyZWVuIiwiYm9sZCIsIml0YWxpYyIsInN0cmlrZSIsImJsb2NrcXVvdGUiLCJsaW5rIiwiaW1hZ2UiLCJsaXN0VWwiLCJsaXN0T2wiLCJhZGRBY3Rpb24iLCJsaXN0Zm4iLCJ0YWciLCJjbSIsImRvYyIsInBvc2VuZCIsImltIiwiaW5MaXN0IiwidGFnTmFtZSIsImkiLCJ0b2dnbGVDbGFzcyIsIndyYXAiLCJnZXRXcmFwcGVyRWxlbWVudCIsImZpeGVkUGFyZW50IiwicGFyZW50cyIsInRyYW5zZm9ybWVkIiwidHJhbnNmb3JtIiwic3R5bGUiLCItd2Via2l0LXRyYW5zZm9ybSIsIndlYmtpdFRyYW5zZm9ybSIsIi13ZWJraXQtdHJhbnNpdGlvbiIsIndlYmtpdFRyYW5zaXRpb24iLCJ0cmFuc2l0aW9uIiwiZnVsbFNjcmVlblJlc3RvcmUiLCJwYWdlWU9mZnNldCIsInNjcm9sbExlZnQiLCJwYWdlWE9mZnNldCIsImRvY3VtZW50RWxlbWVudCIsIm92ZXJmbG93IiwiaW5mbyIsInNjcm9sbFRvIiwic2V0VGltZW91dCIsInBhcnNlciIsIm1kcGFyc2VyIiwibWFya2VkIiwiZW5hYmxlTWFya2Rvd24iLCJzZXRPcHRpb24iLCJwcmVmaXgiLCJOdW1iZXIiLCJiYXNlIiwiaHRtbFN0YXRlIiwiZGlzYWJsZU1hcmtkb3duIl0sIm1hcHBpbmdzIjoiQ0FDQSxTQUFVQSxHQUVOLElBQUlDLEVBRUFDLE9BQU9DLFNBQ1BGLEVBQVlELEVBQU1HLFNBR0QsbUJBQVZDLFFBQXdCQSxPQUFPQyxLQUN0Q0QsT0FBTyxtQkFBb0IsQ0FBQyxTQUFVLFdBQ2xDLE9BQU9ILEdBQWFELEVBQU1HLFVBVnRDLENBY0csU0FBU0csR0FFUixhQUVBLElBQUlDLEVBQVUsR0FrcEJkLE9BaHBCQUQs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QUFjLFNBQVN1QixFQUFHcUUsR0FDaEMsR0FBa0MsT0FBOUJySCxFQUFPQSxPQUFPSyxRQUFRaEMsS0FBZSxDQUNyQyxJQUFJdUssRUFBTTVJLEVBQU9BLE9BQU82RCxTQUFTQyxZQUM1QjlELEVBQU9BLE9BQU9pRSxXQUFXMkUsR0FBSzFFLE1BQU02SCxLQUFLQyxZQUMxQzNFLEVBQU1oSixLQUFPLGVBS3pCSixFQUFHNkIsRUFBRW1GLE9BQU9qRixFQUFRLENBRWhCMkwsZUFBZ0IsV0FDWkEsSUFDQTFMLEtBQUswQixVQUVUc0ssZ0JBQWlCLFdBQ2JoTSxLQUFLRCxPQUFPNEwsVUFBVSxPQUFRLGFBQzlCM0wsS0FBS0UsV0FBV2EsS0FBSyxnQ0FBZ0MyQyxLQUFLMUQsS0FBS0ksUUFBUVosYUFDdkVRLEtBQUswQixZQU1iM0IsRUFBT3lCLEdBQUcsQ0FDTmtLLGVBQWtCLFdBQWEzTCxFQUFPMkwsa0JBQ3RDTSxnQkFBa0IsV0FBYWpNLEVBQU9pTSx5QkFrQjNDaE8sRUFBR2tDIiwiZmlsZSI6ImNvbXBvbmVudHMvaHRtbGVkaXRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cbihmdW5jdGlvbihhZGRvbikge1xuXG4gICAgdmFyIGNvbXBvbmVudDtcblxuICAgIGlmICh3aW5kb3cuVUlraXQyKSB7XG4gICAgICAgIGNvbXBvbmVudCA9IGFkZG9uKFVJa2l0Mik7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZSgndWlraXQtaHRtbGVkaXRvcicsIFsndWlraXQnXSwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQgfHwgYWRkb24oVUlraXQyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59KShmdW5jdGlvbihVSSkge1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgZWRpdG9ycyA9IFtdO1xuXG4gICAgVUkuY29tcG9uZW50KCdodG1sZWRpdG9yJywge1xuXG4gICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICBpZnJhbWUgICAgICAgOiBmYWxzZSxcbiAgICAgICAgICAgIG1vZGUgICAgICAgICA6ICdzcGxpdCcsXG4gICAgICAgICAgICBtYXJrZG93biAgICAgOiBmYWxzZSxcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZSA6IHRydWUsXG4gICAgICAgICAgICBlbmFibGVzY3JpcHRzOiBmYWxzZSxcbiAgICAgICAgICAgIGhlaWdodCAgICAgICA6IDUwMCxcbiAgICAgICAgICAgIG1heHNwbGl0c2l6ZSA6IDEwMDAsXG4gICAgICAgICAgICBjb2RlbWlycm9yICAgOiB7IG1vZGU6ICdodG1sbWl4ZWQnLCBsaW5lV3JhcHBpbmc6IHRydWUsIGRyYWdEcm9wOiBmYWxzZSwgYXV0b0Nsb3NlVGFnczogdHJ1ZSwgbWF0Y2hUYWdzOiB0cnVlLCBhdXRvQ2xvc2VCcmFja2V0czogdHJ1ZSwgbWF0Y2hCcmFja2V0czogdHJ1ZSwgaW5kZW50VW5pdDogNCwgaW5kZW50V2l0aFRhYnM6IGZhbHNlLCB0YWJTaXplOiA0LCBoaW50T3B0aW9uczoge2NvbXBsZXRpb25TaW5nbGU6ZmFsc2V9IH0sXG4gICAgICAgICAgICB0b29sYmFyICAgICAgOiBbICdib2xkJywgJ2l0YWxpYycsICdzdHJpa2UnLCAnbGluaycsICdpbWFnZScsICdibG9ja3F1b3RlJywgJ2xpc3RVbCcsICdsaXN0T2wnIF0sXG4gICAgICAgICAgICBsYmxQcmV2aWV3ICAgOiAnUHJldmlldycsXG4gICAgICAgICAgICBsYmxDb2RldmlldyAgOiAnSFRNTCcsXG4gICAgICAgICAgICBsYmxNYXJrZWR2aWV3OiAnTWFya2Rvd24nXG4gICAgICAgIH0sXG5cbiAgICAgICAgYm9vdDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIC8vIGluaXQgY29kZVxuICAgICAgICAgICAgVUkucmVhZHkoZnVuY3Rpb24oY29udGV4dCkge1xuXG4gICAgICAgICAgICAgICAgVUkuJCgndGV4dGFyZWFbZGF0YS11ay1odG1sZWRpdG9yXScsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXRvciA9IFVJLiQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlZGl0b3IuZGF0YSgnaHRtbGVkaXRvcicpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBVSS5odG1sZWRpdG9yKGVkaXRvciwgVUkuVXRpbHMub3B0aW9ucyhlZGl0b3IuYXR0cignZGF0YS11ay1odG1sZWRpdG9yJykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXMsIHRwbCA9IFVJLmNvbXBvbmVudHMuaHRtbGVkaXRvci50ZW1wbGF0ZTtcblxuICAgICAgICAgICAgdGhpcy5Db2RlTWlycm9yID0gdGhpcy5vcHRpb25zLkNvZGVNaXJyb3IgfHwgQ29kZU1pcnJvcjtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9ucyAgICA9IHt9O1xuXG4gICAgICAgICAgICB0cGwgPSB0cGwucmVwbGFjZSgvXFx7OmxibFByZXZpZXd9L2csIHRoaXMub3B0aW9ucy5sYmxQcmV2aWV3KTtcbiAgICAgICAgICAgIHRwbCA9IHRwbC5yZXBsYWNlKC9cXHs6bGJsQ29kZXZpZXd9L2csIHRoaXMub3B0aW9ucy5sYmxDb2Rldmlldyk7XG5cbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvciA9IFVJLiQodHBsKTtcbiAgICAgICAgICAgIHRoaXMuY29udGVudCAgICA9IHRoaXMuaHRtbGVkaXRvci5maW5kKCcudWstaHRtbGVkaXRvci1jb250ZW50Jyk7XG4gICAgICAgICAgICB0aGlzLnRvb2xiYXIgICAgPSB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItdG9vbGJhcicpO1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3ICAgID0gdGhpcy5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLXByZXZpZXcnKS5jaGlsZHJlbigpLmVxKDApO1xuICAgICAgICAgICAgdGhpcy5jb2RlICAgICAgID0gdGhpcy5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLWNvZGUnKTtcblxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmJlZm9yZSh0aGlzLmh0bWxlZGl0b3IpLmFwcGVuZFRvKHRoaXMuY29kZSk7XG4gICAgICAgICAgICB0aGlzLmVkaXRvciA9IHRoaXMuQ29kZU1pcnJvci5mcm9tVGV4dEFyZWEodGhpcy5lbGVtZW50WzBdLCB0aGlzLm9wdGlvbnMuY29kZW1pcnJvcik7XG4gICAgICAgICAgICB0aGlzLmVkaXRvci5odG1sZWRpdG9yID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLm9uKCdjaGFuZ2UnLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbigpIHsgJHRoaXMucmVuZGVyKCk7IH0sIDE1MCkpO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICR0aGlzLmVkaXRvci5zYXZlKCk7XG4gICAgICAgICAgICAgICAgJHRoaXMuZWxlbWVudC50cmlnZ2VyKCdpbnB1dCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmNvZGUuZmluZCgnLkNvZGVNaXJyb3InKS5jc3MoJ2hlaWdodCcsIHRoaXMub3B0aW9ucy5oZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBpZnJhbWUgbW9kZT9cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWZyYW1lKSB7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmlmcmFtZSA9IFVJLiQoJzxpZnJhbWUgY2xhc3M9XCJ1ay1odG1sZWRpdG9yLWlmcmFtZVwiIGZyYW1lYm9yZGVyPVwiMFwiIHNjcm9sbGluZz1cImF1dG9cIiBoZWlnaHQ9XCIxMDBcIiB3aWR0aD1cIjEwMCVcIj48L2lmcmFtZT4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXcuYXBwZW5kKHRoaXMuaWZyYW1lKTtcblxuICAgICAgICAgICAgICAgIC8vIG11c3Qgb3BlbiBhbmQgY2xvc2UgZG9jdW1lbnQgb2JqZWN0IHRvIHN0YXJ0IHVzaW5nIGl0IVxuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuY2xvc2UoKTtcblxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlldy5jb250YWluZXIgPSBVSS4kKHRoaXMuaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpLmZpbmQoJ2JvZHknKTtcblxuICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBjdXN0b20gc3R5bGVzaGVldFxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodGhpcy5vcHRpb25zLmlmcmFtZSkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlldy5jb250YWluZXIucGFyZW50KCkuYXBwZW5kKCc8bGluayByZWw9XCJzdHlsZXNoZWV0XCIgaHJlZj1cIicrdGhpcy5vcHRpb25zLmlmcmFtZSsnXCI+Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmlldy5jb250YWluZXIgPSB0aGlzLnByZXZpZXc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFVJLiR3aW4ub24oJ3Jlc2l6ZSBsb2FkJywgVUkuVXRpbHMuZGVib3VuY2UoZnVuY3Rpb24oKSB7ICR0aGlzLmZpdCgpOyB9LCAyMDApKTtcblxuICAgICAgICAgICAgdmFyIHByZXZpZXdDb250YWluZXIgPSB0aGlzLmlmcmFtZSA/IHRoaXMucHJldmlldy5jb250YWluZXI6JHRoaXMucHJldmlldy5wYXJlbnQoKSxcbiAgICAgICAgICAgICAgICBjb2RlQ29udGVudCAgICAgID0gdGhpcy5jb2RlLmZpbmQoJy5Db2RlTWlycm9yLXNpemVyJyksXG4gICAgICAgICAgICAgICAgY29kZVNjcm9sbCAgICAgICA9IHRoaXMuY29kZS5maW5kKCcuQ29kZU1pcnJvci1zY3JvbGwnKS5vbignc2Nyb2xsJywgVUkuVXRpbHMuZGVib3VuY2UoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLmh0bWxlZGl0b3IuYXR0cignZGF0YS1tb2RlJykgPT0gJ3RhYicpIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjYWxjIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RlSGVpZ2h0ICAgICAgPSBjb2RlQ29udGVudC5oZWlnaHQoKSAtIGNvZGVTY3JvbGwuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3SGVpZ2h0ICAgPSBwcmV2aWV3Q29udGFpbmVyWzBdLnNjcm9sbEhlaWdodCAtICgkdGhpcy5pZnJhbWUgPyAkdGhpcy5pZnJhbWUuaGVpZ2h0KCkgOiBwcmV2aWV3Q29udGFpbmVyLmhlaWdodCgpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvICAgICAgICAgICA9IHByZXZpZXdIZWlnaHQgLyBjb2RlSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1Bvc2l0aW9uID0gY29kZVNjcm9sbC5zY3JvbGxUb3AoKSAqIHJhdGlvO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwcGx5IG5ldyBzY3JvbGxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0NvbnRhaW5lci5zY3JvbGxUb3AocHJldmlld1Bvc2l0aW9uKTtcblxuICAgICAgICAgICAgICAgIH0sIDEwKSk7XG5cbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5vbignY2xpY2snLCAnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUsIC51ay1odG1sZWRpdG9yLWJ1dHRvbi1wcmV2aWV3JywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCR0aGlzLmh0bWxlZGl0b3IuYXR0cignZGF0YS1tb2RlJykgPT0gJ3RhYicpIHtcblxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlLCAudWstaHRtbGVkaXRvci1idXR0b24tcHJldmlldycpLnJlbW92ZUNsYXNzKCd1ay1hY3RpdmUnKS5maWx0ZXIodGhpcykuYWRkQ2xhc3MoJ3VrLWFjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmFjdGl2ZXRhYiA9IFVJLiQodGhpcykuaGFzQ2xhc3MoJ3VrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUnKSA/ICdjb2RlJyA6ICdwcmV2aWV3JztcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuaHRtbGVkaXRvci5hdHRyKCdkYXRhLWFjdGl2ZS10YWInLCAkdGhpcy5hY3RpdmV0YWIpO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5lZGl0b3IucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyB0b29sYmFyIGFjdGlvbnNcbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5vbignY2xpY2snLCAnYVtkYXRhLWh0bWxlZGl0b3ItYnV0dG9uXScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKCEkdGhpcy5jb2RlLmlzKCc6dmlzaWJsZScpKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCdhY3Rpb24uJyArIFVJLiQodGhpcykuZGF0YSgnaHRtbGVkaXRvci1idXR0b24nKSwgWyR0aGlzLmVkaXRvcl0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMucHJldmlldy5wYXJlbnQoKS5jc3MoJ2hlaWdodCcsIHRoaXMuY29kZS5oZWlnaHQoKSk7XG5cbiAgICAgICAgICAgIC8vIGF1dG9jb21wbGV0ZVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5hdXRvY29tcGxldGUgJiYgdGhpcy5Db2RlTWlycm9yLnNob3dIaW50ICYmIHRoaXMuQ29kZU1pcnJvci5oaW50ICYmIHRoaXMuQ29kZU1pcnJvci5oaW50Lmh0bWwpIHtcblxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm9uKCdpbnB1dFJlYWQnLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9ICR0aGlzLmVkaXRvci5nZXREb2MoKSwgUE9TID0gZG9jLmdldEN1cnNvcigpLCBtb2RlID0gJHRoaXMuQ29kZU1pcnJvci5pbm5lck1vZGUoJHRoaXMuZWRpdG9yLmdldE1vZGUoKSwgJHRoaXMuZWRpdG9yLmdldFRva2VuQXQoUE9TKS5zdGF0ZSkubW9kZS5uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2RlID09ICd4bWwnKSB7IC8vaHRtbCBkZXBlbmRzIG9uIHhtbFxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VyID0gJHRoaXMuZWRpdG9yLmdldEN1cnNvcigpLCB0b2tlbiA9ICR0aGlzLmVkaXRvci5nZXRUb2tlbkF0KGN1cik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbi5zdHJpbmcuY2hhckF0KDApID09ICc8JyB8fCB0b2tlbi50eXBlID09ICdhdHRyaWJ1dGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuQ29kZU1pcnJvci5zaG93SGludCgkdGhpcy5lZGl0b3IsICR0aGlzLkNvZGVNaXJyb3IuaGludC5odG1sLCB7IGNvbXBsZXRlU2luZ2xlOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIDEwMCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRlYm91bmNlZFJlZHJhdyA9IFVJLlV0aWxzLmRlYm91bmNlKGZ1bmN0aW9uICgpIHsgJHRoaXMucmVkcmF3KCk7IH0sIDUpO1xuXG4gICAgICAgICAgICB0aGlzLm9uKCdpbml0LnVrLmNvbXBvbmVudCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICR0aGlzLmRlYm91bmNlZFJlZHJhdygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCdkYXRhLXVrLWNoZWNrLWRpc3BsYXknLCAxKS5vbignZGlzcGxheS51ay5jaGVjaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5odG1sZWRpdG9yLmlzKFwiOnZpc2libGVcIikpIHRoaXMuZml0KCk7XG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICBlZGl0b3JzLnB1c2godGhpcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkQnV0dG9uOiBmdW5jdGlvbihuYW1lLCBidXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uc1tuYW1lXSA9IGJ1dHRvbjtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRCdXR0b25zOiBmdW5jdGlvbihidXR0b25zKSB7XG4gICAgICAgICAgICBVSS4kLmV4dGVuZCh0aGlzLmJ1dHRvbnMsIGJ1dHRvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlcGxhY2VJblByZXZpZXc6IGZ1bmN0aW9uKHJlZ2V4cCwgY2FsbGJhY2spIHtcblxuICAgICAgICAgICAgdmFyIGVkaXRvciA9IHRoaXMuZWRpdG9yLCByZXN1bHRzID0gW10sIHZhbHVlID0gZWRpdG9yLmdldFZhbHVlKCksIG9mZnNldCA9IC0xLCBpbmRleCA9IDA7XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudHZhbHVlID0gdGhpcy5jdXJyZW50dmFsdWUucmVwbGFjZShyZWdleHAsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gdmFsdWUuaW5kZXhPZihhcmd1bWVudHNbMF0sICsrb2Zmc2V0KTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXRjaCAgPSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXM6IGFyZ3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgZnJvbSAgIDogdHJhbnNsYXRlT2Zmc2V0KG9mZnNldCksXG4gICAgICAgICAgICAgICAgICAgIHRvICAgICA6IHRyYW5zbGF0ZU9mZnNldChvZmZzZXQgKyBhcmd1bWVudHNbMF0ubGVuZ3RoKSxcbiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodmFsdWUsIG1hdGNoLmZyb20sIG1hdGNoLnRvKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaW5SYW5nZTogZnVuY3Rpb24oY3Vyc29yKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJzb3IubGluZSA9PT0gbWF0Y2guZnJvbS5saW5lICYmIGN1cnNvci5saW5lID09PSBtYXRjaC50by5saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnNvci5jaCA+PSBtYXRjaC5mcm9tLmNoICYmIGN1cnNvci5jaCA8IG1hdGNoLnRvLmNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIChjdXJzb3IubGluZSA9PT0gbWF0Y2guZnJvbS5saW5lICYmIGN1cnNvci5jaCAgID49IG1hdGNoLmZyb20uY2gpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjdXJzb3IubGluZSA+ICAgbWF0Y2guZnJvbS5saW5lICYmIGN1cnNvci5saW5lIDwgIG1hdGNoLnRvLmxpbmUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjdXJzb3IubGluZSA9PT0gbWF0Y2gudG8ubGluZSAgICYmIGN1cnNvci5jaCAgIDwgIG1hdGNoLnRvLmNoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdHlwZW9mKGNhbGxiYWNrKSA9PT0gJ3N0cmluZycgPyBjYWxsYmFjayA6IGNhbGxiYWNrKG1hdGNoLCBpbmRleCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdCAmJiByZXN1bHQgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcblxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChtYXRjaCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB0cmFuc2xhdGVPZmZzZXQob2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGVkaXRvci5nZXRWYWx1ZSgpLnN1YnN0cmluZygwLCBvZmZzZXQpLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBsaW5lOiByZXN1bHQubGVuZ3RoIC0gMSwgY2g6IHJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0ubGVuZ3RoIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2J1aWxkdG9vbGJhcjogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGlmICghKHRoaXMub3B0aW9ucy50b29sYmFyICYmIHRoaXMub3B0aW9ucy50b29sYmFyLmxlbmd0aCkpIHJldHVybjtcblxuICAgICAgICAgICAgdmFyICR0aGlzID0gdGhpcywgYmFyID0gW107XG5cbiAgICAgICAgICAgIHRoaXMudG9vbGJhci5lbXB0eSgpO1xuXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudG9vbGJhci5mb3JFYWNoKGZ1bmN0aW9uKGJ1dHRvbikge1xuICAgICAgICAgICAgICAgIGlmICghJHRoaXMuYnV0dG9uc1tidXR0b25dKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSAkdGhpcy5idXR0b25zW2J1dHRvbl0udGl0bGUgPyAkdGhpcy5idXR0b25zW2J1dHRvbl0udGl0bGUgOiBidXR0b247XG5cbiAgICAgICAgICAgICAgICBiYXIucHVzaCgnPGxpPjxhIGRhdGEtaHRtbGVkaXRvci1idXR0b249XCInK2J1dHRvbisnXCIgdGl0bGU9XCInK3RpdGxlKydcIiBkYXRhLXVrLXRvb2x0aXA+JyskdGhpcy5idXR0b25zW2J1dHRvbl0ubGFiZWwrJzwvYT48L2xpPicpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMudG9vbGJhci5odG1sKGJhci5qb2luKCdcXG4nKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZml0OiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIG1vZGUgPSB0aGlzLm9wdGlvbnMubW9kZTtcblxuICAgICAgICAgICAgaWYgKG1vZGUgPT0gJ3NwbGl0JyAmJiB0aGlzLmh0bWxlZGl0b3Iud2lkdGgoKSA8IHRoaXMub3B0aW9ucy5tYXhzcGxpdHNpemUpIHtcbiAgICAgICAgICAgICAgICBtb2RlID0gJ3RhYic7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtb2RlID09ICd0YWInKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZXRhYikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZXRhYiA9ICdjb2RlJztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5odG1sZWRpdG9yLmF0dHIoJ2RhdGEtYWN0aXZlLXRhYicsIHRoaXMuYWN0aXZldGFiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUsIC51ay1odG1sZWRpdG9yLWJ1dHRvbi1wcmV2aWV3JykucmVtb3ZlQ2xhc3MoJ3VrLWFjdGl2ZScpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodGhpcy5hY3RpdmV0YWIgPT0gJ2NvZGUnID8gJy51ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlJyA6ICcudWstaHRtbGVkaXRvci1idXR0b24tcHJldmlldycpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygndWstYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnJlZnJlc2goKTtcbiAgICAgICAgICAgIHRoaXMucHJldmlldy5wYXJlbnQoKS5jc3MoJ2hlaWdodCcsIHRoaXMuY29kZS5oZWlnaHQoKSk7XG5cbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5hdHRyKCdkYXRhLW1vZGUnLCBtb2RlKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZWRyYXc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fYnVpbGR0b29sYmFyKCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgdGhpcy5maXQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRNb2RlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVkaXRvci5nZXRPcHRpb24oJ21vZGUnKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDdXJzb3JNb2RlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbSA9IHsgbW9kZTogJ2h0bWwnfTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY3Vyc29yTW9kZScsIFtwYXJhbV0pO1xuICAgICAgICAgICAgcmV0dXJuIHBhcmFtLm1vZGU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50dmFsdWUgPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5lbmFibGVzY3JpcHRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50dmFsdWUgPSB0aGlzLmN1cnJlbnR2YWx1ZS5yZXBsYWNlKC88KHNjcmlwdHxzdHlsZSlcXGJbXjxdKig/Oig/ITxcXC8oc2NyaXB0fHN0eWxlKT4pPFtePF0qKSo8XFwvKHNjcmlwdHxzdHlsZSk+L2ltZywgJycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBlbXB0eSBjb2RlXG4gICAgICAgICAgICBpZiAoIXRoaXMuY3VycmVudHZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudmFsKCcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXcuY29udGFpbmVyLmh0bWwoJycpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3JlbmRlcicsIFt0aGlzXSk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3JlbmRlckxhdGUnLCBbdGhpc10pO1xuXG4gICAgICAgICAgICB0aGlzLnByZXZpZXcuY29udGFpbmVyLmh0bWwodGhpcy5jdXJyZW50dmFsdWUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkZFNob3J0Y3V0OiBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIG1hcCA9IHt9O1xuICAgICAgICAgICAgaWYgKCFVSS4kLmlzQXJyYXkobmFtZSkpIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gW25hbWVdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuYW1lLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgICAgICAgICAgbWFwW2tleV0gPSBjYWxsYmFjaztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLmVkaXRvci5hZGRLZXlNYXAobWFwKTtcblxuICAgICAgICAgICAgcmV0dXJuIG1hcDtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRTaG9ydGN1dEFjdGlvbjogZnVuY3Rpb24oYWN0aW9uLCBzaG9ydGN1dHMpIHtcbiAgICAgICAgICAgIHZhciBlZGl0b3IgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5hZGRTaG9ydGN1dChzaG9ydGN1dHMsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5lbGVtZW50LnRyaWdnZXIoJ2FjdGlvbi4nICsgYWN0aW9uLCBbZWRpdG9yLmVkaXRvcl0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZVNlbGVjdGlvbjogZnVuY3Rpb24ocmVwbGFjZSkge1xuXG4gICAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMuZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXG4gICAgICAgICAgICBpZiAoIXRleHQubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyICAgICA9IHRoaXMuZWRpdG9yLmdldEN1cnNvcigpLFxuICAgICAgICAgICAgICAgICAgICBjdXJMaW5lID0gdGhpcy5lZGl0b3IuZ2V0TGluZShjdXIubGluZSksXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ICAgPSBjdXIuY2gsXG4gICAgICAgICAgICAgICAgICAgIGVuZCAgICAgPSBzdGFydDtcblxuICAgICAgICAgICAgICAgIHdoaWxlIChlbmQgPCBjdXJMaW5lLmxlbmd0aCAmJiAvW1xcdyRdKy8udGVzdChjdXJMaW5lLmNoYXJBdChlbmQpKSkgKytlbmQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHN0YXJ0ICYmIC9bXFx3JF0rLy50ZXN0KGN1ckxpbmUuY2hhckF0KHN0YXJ0IC0gMSkpKSAtLXN0YXJ0O1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1cldvcmQgPSBzdGFydCAhPSBlbmQgJiYgY3VyTGluZS5zbGljZShzdGFydCwgZW5kKTtcblxuICAgICAgICAgICAgICAgIGlmIChjdXJXb3JkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldFNlbGVjdGlvbih7IGxpbmU6IGN1ci5saW5lLCBjaDogc3RhcnR9LCB7IGxpbmU6IGN1ci5saW5lLCBjaDogZW5kIH0pO1xuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gY3VyV29yZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gcmVwbGFjZS5yZXBsYWNlKCckMScsIHRleHQpO1xuXG4gICAgICAgICAgICB0aGlzLmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGh0bWwsICdlbmQnKTtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVwbGFjZUxpbmU6IGZ1bmN0aW9uKHJlcGxhY2UpIHtcbiAgICAgICAgICAgIHZhciBwb3MgID0gdGhpcy5lZGl0b3IuZ2V0RG9jKCkuZ2V0Q3Vyc29yKCksXG4gICAgICAgICAgICAgICAgdGV4dCA9IHRoaXMuZWRpdG9yLmdldExpbmUocG9zLmxpbmUpLFxuICAgICAgICAgICAgICAgIGh0bWwgPSByZXBsYWNlLnJlcGxhY2UoJyQxJywgdGV4dCk7XG5cbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnJlcGxhY2VSYW5nZShodG1sICwgeyBsaW5lOiBwb3MubGluZSwgY2g6IDAgfSwgeyBsaW5lOiBwb3MubGluZSwgY2g6IHRleHQubGVuZ3RoIH0pO1xuICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogcG9zLmxpbmUsIGNoOiBodG1sLmxlbmd0aCB9KTtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLmZvY3VzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2F2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRvci5zYXZlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgVUkuY29tcG9uZW50cy5odG1sZWRpdG9yLnRlbXBsYXRlID0gW1xuICAgICAgICAnPGRpdiBjbGFzcz1cInVrLWh0bWxlZGl0b3IgdWstY2xlYXJmaXhcIiBkYXRhLW1vZGU9XCJzcGxpdFwiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVrLWh0bWxlZGl0b3ItbmF2YmFyXCI+JyxcbiAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwidWstaHRtbGVkaXRvci1uYXZiYXItbmF2IHVrLWh0bWxlZGl0b3ItdG9vbGJhclwiPjwvdWw+JyxcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVrLWh0bWxlZGl0b3ItbmF2YmFyLWZsaXBcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwidWstaHRtbGVkaXRvci1uYXZiYXItbmF2XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8bGkgY2xhc3M9XCJ1ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlXCI+PGE+ezpsYmxDb2Rldmlld308L2E+PC9saT4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxsaSBjbGFzcz1cInVrLWh0bWxlZGl0b3ItYnV0dG9uLXByZXZpZXdcIj48YT57OmxibFByZXZpZXd9PC9hPjwvbGk+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8bGk+PGEgZGF0YS1odG1sZWRpdG9yLWJ1dHRvbj1cImZ1bGxzY3JlZW5cIj48aSBjbGFzcz1cInVrLWljb24tZXhwYW5kXCI+PC9pPjwvYT48L2xpPicsXG4gICAgICAgICAgICAgICAgICAgICc8L3VsPicsXG4gICAgICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvci1jb250ZW50XCI+JyxcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVrLWh0bWxlZGl0b3ItY29kZVwiPjwvZGl2PicsXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1ay1odG1sZWRpdG9yLXByZXZpZXdcIj48ZGl2PjwvZGl2PjwvZGl2PicsXG4gICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgJzwvZGl2PidcbiAgICBdLmpvaW4oJycpO1xuXG5cbiAgICBVSS5wbHVnaW4oJ2h0bWxlZGl0b3InLCAnYmFzZScsIHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbihlZGl0b3IpIHtcblxuICAgICAgICAgICAgZWRpdG9yLmFkZEJ1dHRvbnMoe1xuXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbjoge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnRnVsbHNjcmVlbicsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24tZXhwYW5kXCI+PC9pPidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvbGQgOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlICA6ICdCb2xkJyxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgIDogJzxpIGNsYXNzPVwidWstaWNvbi1ib2xkXCI+PC9pPidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGl0YWxpYyA6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ0l0YWxpYycsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24taXRhbGljXCI+PC9pPidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHN0cmlrZSA6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ1N0cmlrZXRocm91Z2gnLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLXN0cmlrZXRocm91Z2hcIj48L2k+J1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYmxvY2txdW90ZSA6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ0Jsb2NrcXVvdGUnLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLXF1b3RlLXJpZ2h0XCI+PC9pPidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxpbmsgOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlICA6ICdMaW5rJyxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgIDogJzxpIGNsYXNzPVwidWstaWNvbi1saW5rXCI+PC9pPidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGltYWdlIDoge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnSW1hZ2UnLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLXBpY3R1cmUtb1wiPjwvaT4nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsaXN0VWwgOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlICA6ICdVbm9yZGVyZWQgTGlzdCcsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24tbGlzdC11bFwiPjwvaT4nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsaXN0T2wgOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlICA6ICdPcmRlcmVkIExpc3QnLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLWxpc3Qtb2xcIj48L2k+J1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGFkZEFjdGlvbignYm9sZCcsICc8c3Ryb25nPiQxPC9zdHJvbmc+Jyk7XG4gICAgICAgICAgICBhZGRBY3Rpb24oJ2l0YWxpYycsICc8ZW0+JDE8L2VtPicpO1xuICAgICAgICAgICAgYWRkQWN0aW9uKCdzdHJpa2UnLCAnPGRlbD4kMTwvZGVsPicpO1xuICAgICAgICAgICAgYWRkQWN0aW9uKCdibG9ja3F1b3RlJywgJzxibG9ja3F1b3RlPjxwPiQxPC9wPjwvYmxvY2txdW90ZT4nLCAncmVwbGFjZUxpbmUnKTtcbiAgICAgICAgICAgIGFkZEFjdGlvbignbGluaycsICc8YSBocmVmPVwiaHR0cDovL1wiPiQxPC9hPicpO1xuICAgICAgICAgICAgYWRkQWN0aW9uKCdpbWFnZScsICc8aW1nIHNyYz1cImh0dHA6Ly9cIiBhbHQ9XCIkMVwiPicpO1xuXG4gICAgICAgICAgICB2YXIgbGlzdGZuID0gZnVuY3Rpb24odGFnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5nZXRDdXJzb3JNb2RlKCkgPT0gJ2h0bWwnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdGFnID0gdGFnIHx8ICd1bCc7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNtICAgICAgICA9IGVkaXRvci5lZGl0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MgICAgICAgPSBjbS5nZXREb2MoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyAgICAgICA9IGRvYy5nZXRDdXJzb3IodHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NlbmQgICAgPSBkb2MuZ2V0Q3Vyc29yKGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltICAgICAgICA9IENvZGVNaXJyb3IuaW5uZXJNb2RlKGNtLmdldE1vZGUoKSwgY20uZ2V0VG9rZW5BdChjbS5nZXRDdXJzb3IoKSkuc3RhdGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5MaXN0ICAgID0gaW0gJiYgaW0uc3RhdGUgJiYgaW0uc3RhdGUuY29udGV4dCAmJiBbJ3VsJywnb2wnXS5pbmRleE9mKGltLnN0YXRlLmNvbnRleHQudGFnTmFtZSkgIT0gLTE7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaT1wb3MubGluZTsgaTwocG9zZW5kLmxpbmUrMSk7aSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoJzxsaT4nK2NtLmdldExpbmUoaSkrJzwvbGk+JywgeyBsaW5lOiBpLCBjaDogMCB9LCB7IGxpbmU6IGksIGNoOiBjbS5nZXRMaW5lKGkpLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaW5MaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5yZXBsYWNlUmFuZ2UoJzwnK3RhZysnPicrXCJcXG5cIitjbS5nZXRMaW5lKHBvcy5saW5lKSwgeyBsaW5lOiBwb3MubGluZSwgY2g6IDAgfSwgeyBsaW5lOiBwb3MubGluZSwgY2g6IGNtLmdldExpbmUocG9zLmxpbmUpLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZShjbS5nZXRMaW5lKChwb3NlbmQubGluZSsxKSkrXCJcXG5cIisnPC8nK3RhZysnPicsIHsgbGluZTogKHBvc2VuZC5saW5lKzEpLCBjaDogMCB9LCB7IGxpbmU6IChwb3NlbmQubGluZSsxKSwgY2g6IGNtLmdldExpbmUoKHBvc2VuZC5saW5lKzEpKS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5zZXRDdXJzb3IoeyBsaW5lOiBwb3NlbmQubGluZSsxLCBjaDogY20uZ2V0TGluZShwb3NlbmQubGluZSsxKS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5zZXRDdXJzb3IoeyBsaW5lOiBwb3NlbmQubGluZSwgY2g6IGNtLmdldExpbmUocG9zZW5kLmxpbmUpLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNtLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZWRpdG9yLm9uKCdhY3Rpb24ubGlzdFVsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgbGlzdGZuKCd1bCcpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVkaXRvci5vbignYWN0aW9uLmxpc3RPbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGxpc3Rmbignb2wnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlZGl0b3IuaHRtbGVkaXRvci5vbignY2xpY2snLCAnYVtkYXRhLWh0bWxlZGl0b3ItYnV0dG9uPVwiZnVsbHNjcmVlblwiXScsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgZWRpdG9yLmh0bWxlZGl0b3IudG9nZ2xlQ2xhc3MoJ3VrLWh0bWxlZGl0b3ItZnVsbHNjcmVlbicpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdyYXAgPSBlZGl0b3IuZWRpdG9yLmdldFdyYXBwZXJFbGVtZW50KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmh0bWxlZGl0b3IuaGFzQ2xhc3MoJ3VrLWh0bWxlZGl0b3ItZnVsbHNjcmVlbicpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpeGVkUGFyZW50ID0gZmFsc2UsIHBhcmVudHMgPSBlZGl0b3IuaHRtbGVkaXRvci5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFVJLiQodGhpcykuY3NzKCdwb3NpdGlvbicpPT0nZml4ZWQnICYmICFVSS4kKHRoaXMpLmlzKCdodG1sJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFBhcmVudCA9IFVJLiQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5odG1sZWRpdG9yLmRhdGEoJ2ZpeGVkUGFyZW50cycsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZml4ZWRQYXJlbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zZm9ybWVkID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkUGFyZW50ID0gZml4ZWRQYXJlbnQucGFyZW50KCkuZmluZChwYXJlbnRzKS5lYWNoKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVUkuJCh0aGlzKS5jc3MoJ3RyYW5zZm9ybScpICE9ICdub25lJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1lZC5wdXNoKFVJLiQodGhpcykuZGF0YSgndHJhbnNmb3JtLXJlc2V0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IHRoaXMuc3R5bGUudHJhbnNmb3JtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogdGhpcy5zdHlsZS53ZWJraXRUcmFuc2Zvcm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJzp0aGlzLnN0eWxlLndlYmtpdFRyYW5zaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6dGhpcy5zdHlsZS50cmFuc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogJ25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNpdGlvbic6J25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOidub25lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5odG1sZWRpdG9yLmRhdGEoJ2ZpeGVkUGFyZW50cycsIHRyYW5zZm9ybWVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5lZGl0b3Iuc3RhdGUuZnVsbFNjcmVlblJlc3RvcmUgPSB7c2Nyb2xsVG9wOiB3aW5kb3cucGFnZVlPZmZzZXQsIHNjcm9sbExlZnQ6IHdpbmRvdy5wYWdlWE9mZnNldCwgd2lkdGg6IHdyYXAuc3R5bGUud2lkdGgsIGhlaWdodDogd3JhcC5zdHlsZS5oZWlnaHR9O1xuICAgICAgICAgICAgICAgICAgICB3cmFwLnN0eWxlLndpZHRoICA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB3cmFwLnN0eWxlLmhlaWdodCA9IGVkaXRvci5jb250ZW50LmhlaWdodCgpKydweCc7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBlZGl0b3IuZWRpdG9yLnN0YXRlLmZ1bGxTY3JlZW5SZXN0b3JlO1xuICAgICAgICAgICAgICAgICAgICB3cmFwLnN0eWxlLndpZHRoID0gaW5mby53aWR0aDsgd3JhcC5zdHlsZS5oZWlnaHQgPSBpbmZvLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKGluZm8uc2Nyb2xsTGVmdCwgaW5mby5zY3JvbGxUb3ApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuaHRtbGVkaXRvci5kYXRhKCdmaXhlZFBhcmVudHMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmh0bWxlZGl0b3IuZGF0YSgnZml4ZWRQYXJlbnRzJykuZm9yRWFjaChmdW5jdGlvbihwYXJlbnQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jc3MocGFyZW50LmRhdGEoJ3RyYW5zZm9ybS1yZXNldCcpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmZpdCgpO1xuICAgICAgICAgICAgICAgICAgICBVSS4kd2luLnRyaWdnZXIoJ3Jlc2l6ZScpO1xuICAgICAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlZGl0b3IuYWRkU2hvcnRjdXQoWydDdHJsLVMnLCAnQ21kLVMnXSwgZnVuY3Rpb24oKSB7IGVkaXRvci5lbGVtZW50LnRyaWdnZXIoJ2h0bWxlZGl0b3Itc2F2ZScsIFtlZGl0b3JdKTsgfSk7XG4gICAgICAgICAgICBlZGl0b3IuYWRkU2hvcnRjdXRBY3Rpb24oJ2JvbGQnLCBbJ0N0cmwtQicsICdDbWQtQiddKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gYWRkQWN0aW9uKG5hbWUsIHJlcGxhY2UsIG1vZGUpIHtcbiAgICAgICAgICAgICAgICBlZGl0b3Iub24oJ2FjdGlvbi4nK25hbWUsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmdldEN1cnNvck1vZGUoKSA9PSAnaHRtbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvclttb2RlID09ICdyZXBsYWNlTGluZScgPyAncmVwbGFjZUxpbmUnIDogJ3JlcGxhY2VTZWxlY3Rpb24nXShyZXBsYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBVSS5wbHVnaW4oJ2h0bWxlZGl0b3InLCAnbWFya2Rvd24nLCB7XG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZWRpdG9yKSB7XG5cbiAgICAgICAgICAgIHZhciBwYXJzZXIgPSBlZGl0b3Iub3B0aW9ucy5tZHBhcnNlciB8fCB3aW5kb3cubWFya2VkIHx8IG51bGw7XG5cbiAgICAgICAgICAgIGlmICghcGFyc2VyKSByZXR1cm47XG5cbiAgICAgICAgICAgIGlmIChlZGl0b3Iub3B0aW9ucy5tYXJrZG93bikge1xuICAgICAgICAgICAgICAgIGVuYWJsZU1hcmtkb3duKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFkZEFjdGlvbignYm9sZCcsICcqKiQxKionKTtcbiAgICAgICAgICAgIGFkZEFjdGlvbignaXRhbGljJywgJyokMSonKTtcbiAgICAgICAgICAgIGFkZEFjdGlvbignc3RyaWtlJywgJ35+JDF+ficpO1xuICAgICAgICAgICAgYWRkQWN0aW9uKCdibG9ja3F1b3RlJywgJz4gJDEnLCAncmVwbGFjZUxpbmUnKTtcbiAgICAgICAgICAgIGFkZEFjdGlvbignbGluaycsICdbJDFdKGh0dHA6Ly8pJyk7XG4gICAgICAgICAgICBhZGRBY3Rpb24oJ2ltYWdlJywgJyFbJDFdKGh0dHA6Ly8pJyk7XG5cbiAgICAgICAgICAgIGVkaXRvci5vbignYWN0aW9uLmxpc3RVbCcsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5nZXRDdXJzb3JNb2RlKCkgPT0gJ21hcmtkb3duJykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjbSAgICAgID0gZWRpdG9yLmVkaXRvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyAgICAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IodHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NlbmQgID0gY20uZ2V0RG9jKCkuZ2V0Q3Vyc29yKGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPXBvcy5saW5lOyBpPChwb3NlbmQubGluZSsxKTtpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZSgnKiAnK2NtLmdldExpbmUoaSksIHsgbGluZTogaSwgY2g6IDAgfSwgeyBsaW5lOiBpLCBjaDogY20uZ2V0TGluZShpKS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjbS5zZXRDdXJzb3IoeyBsaW5lOiBwb3NlbmQubGluZSwgY2g6IGNtLmdldExpbmUocG9zZW5kLmxpbmUpLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICAgICAgY20uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWRpdG9yLm9uKCdhY3Rpb24ubGlzdE9sJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmdldEN1cnNvck1vZGUoKSA9PSAnbWFya2Rvd24nKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNtICAgICAgPSBlZGl0b3IuZWRpdG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zICAgICA9IGNtLmdldERvYygpLmdldEN1cnNvcih0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2VuZCAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IoZmFsc2UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlZml4ICA9IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcy5saW5lID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZsaW5lID0gY20uZ2V0TGluZShwb3MubGluZS0xKSwgbWF0Y2hlcztcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYobWF0Y2hlcyA9IHByZXZsaW5lLm1hdGNoKC9eKFxcZCspXFwuLykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXggPSBOdW1iZXIobWF0Y2hlc1sxXSkrMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9cG9zLmxpbmU7IGk8KHBvc2VuZC5saW5lKzEpO2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKHByZWZpeCsnLiAnK2NtLmdldExpbmUoaSksIHsgbGluZTogaSwgY2g6IDAgfSwgeyBsaW5lOiBpLCBjaDogY20uZ2V0TGluZShpKS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXgrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNtLnNldEN1cnNvcih7IGxpbmU6IHBvc2VuZC5saW5lLCBjaDogY20uZ2V0TGluZShwb3NlbmQubGluZSkubGVuZ3RoIH0pO1xuICAgICAgICAgICAgICAgICAgICBjbS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlZGl0b3Iub24oJ3JlbmRlckxhdGUnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmVkaXRvci5vcHRpb25zLm1vZGUgPT0gJ2dmbScpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmN1cnJlbnR2YWx1ZSA9IHBhcnNlcihlZGl0b3IuY3VycmVudHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWRpdG9yLm9uKCdjdXJzb3JNb2RlJywgZnVuY3Rpb24oZSwgcGFyYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmVkaXRvci5vcHRpb25zLm1vZGUgPT0gJ2dmbScpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGVkaXRvci5lZGl0b3IuZ2V0RG9jKCkuZ2V0Q3Vyc29yKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yLmVkaXRvci5nZXRUb2tlbkF0KHBvcykuc3RhdGUuYmFzZS5odG1sU3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtLm1vZGUgPSAnbWFya2Rvd24nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFVJLiQuZXh0ZW5kKGVkaXRvciwge1xuXG4gICAgICAgICAgICAgICAgZW5hYmxlTWFya2Rvd246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVNYXJrZG93bigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGlzYWJsZU1hcmtkb3duOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2V0T3B0aW9uKCdtb2RlJywgJ2h0bWxtaXhlZCcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUgYScpLmh0bWwodGhpcy5vcHRpb25zLmxibENvZGV2aWV3KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzd2l0Y2ggbWFya2Rvd24gbW9kZSBvbiBldmVudFxuICAgICAgICAgICAgZWRpdG9yLm9uKHtcbiAgICAgICAgICAgICAgICBlbmFibGVNYXJrZG93biAgOiBmdW5jdGlvbigpIHsgZWRpdG9yLmVuYWJsZU1hcmtkb3duKCk7IH0sXG4gICAgICAgICAgICAgICAgZGlzYWJsZU1hcmtkb3duIDogZnVuY3Rpb24oKSB7IGVkaXRvci5kaXNhYmxlTWFya2Rvd24oKTsgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGVuYWJsZU1hcmtkb3duKCkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5lZGl0b3Iuc2V0T3B0aW9uKCdtb2RlJywgJ2dmbScpO1xuICAgICAgICAgICAgICAgIGVkaXRvci5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlIGEnKS5odG1sKGVkaXRvci5vcHRpb25zLmxibE1hcmtlZHZpZXcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBhZGRBY3Rpb24obmFtZSwgcmVwbGFjZSwgbW9kZSkge1xuICAgICAgICAgICAgICAgIGVkaXRvci5vbignYWN0aW9uLicrbmFtZSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZ2V0Q3Vyc29yTW9kZSgpID09ICdtYXJrZG93bicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvclttb2RlID09ICdyZXBsYWNlTGluZScgPyAncmVwbGFjZUxpbmUnIDogJ3JlcGxhY2VTZWxlY3Rpb24nXShyZXBsYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gVUkuaHRtbGVkaXRvcjtcbn0pOyJdfQ==
