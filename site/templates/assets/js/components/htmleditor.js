!function(t){var e;window.UIkit2&&(e=t(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-htmleditor",["uikit"],function(){return e||t(UIkit2)})}(function(s){"use strict";var e=[];return s.component("htmleditor",{defaults:{iframe:!1,mode:"split",markdown:!1,autocomplete:!0,enablescripts:!1,height:500,maxsplitsize:1e3,codemirror:{mode:"htmlmixed",lineWrapping:!0,dragDrop:!1,autoCloseTags:!0,matchTags:!0,autoCloseBrackets:!0,matchBrackets:!0,indentUnit:4,indentWithTabs:!1,tabSize:4,hintOptions:{completionSingle:!1}},toolbar:["bold","italic","strike","link","image","blockquote","listUl","listOl"],lblPreview:"Preview",lblCodeview:"HTML",lblMarkedview:"Markdown"},boot:function(){s.ready(function(t){s.$("textarea[data-uk-htmleditor]",t).each(function(){var t=s.$(this);t.data("htmleditor")||s.htmleditor(t,s.Utils.options(t.attr("data-uk-htmleditor")))})})},init:function(){var o=this,t=s.components.htmleditor.template;this.CodeMirror=this.options.CodeMirror||CodeMirror,this.buttons={},t=(t=t.replace(/\{:lblPreview}/g,this.options.lblPreview)).replace(/\{:lblCodeview}/g,this.options.lblCodeview),this.htmleditor=s.$(t),this.content=this.htmleditor.find(".uk-htmleditor-content"),this.toolbar=this.htmleditor.find(".uk-htmleditor-toolbar"),this.preview=this.htmleditor.find(".uk-htmleditor-preview").children().eq(0),this.code=this.htmleditor.find(".uk-htmleditor-code"),this.element.before(this.htmleditor).appendTo(this.code),this.editor=this.CodeMirror.fromTextArea(this.element[0],this.options.codemirror),(this.editor.htmleditor=this).editor.on("change",s.Utils.debounce(function(){o.render()},150)),this.editor.on("change",function(){o.editor.save(),o.element.trigger("input")}),this.code.find(".CodeMirror").css("height",this.options.height),this.options.iframe?(this.iframe=s.$('<iframe class="uk-htmleditor-iframe" frameborder="0" scrolling="auto" height="100" width="100%"></iframe>'),this.preview.append(this.iframe),this.iframe[0].contentWindow.document.open(),this.iframe[0].contentWindow.document.close(),this.preview.container=s.$(this.iframe[0].contentWindow.document).find("body"),"string"==typeof this.options.iframe&&this.preview.container.parent().append('<link rel="stylesheet" href="'+this.options.iframe+'">')):this.preview.container=this.preview,s.$win.on("resize load",s.Utils.debounce(function(){o.fit()},200));var n=this.iframe?this.preview.container:o.preview.parent(),r=this.code.find(".CodeMirror-sizer"),l=this.code.find(".CodeMirror-scroll").on("scroll",s.Utils.debounce(function(){if("tab"!=o.htmleditor.attr("data-mode")){var t=r.height()-l.height(),e=(n[0].scrollHeight-(o.iframe?o.iframe.height():n.height()))/t,i=l.scrollTop()*e;n.scrollTop(i)}},10));this.htmleditor.on("click",".uk-htmleditor-button-code, .uk-htmleditor-button-preview",function(t){t.preventDefault(),"tab"==o.htmleditor.attr("data-mode")&&(o.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter(this).addClass("uk-active"),o.activetab=s.$(this).hasClass("uk-htmleditor-button-code")?"code":"preview",o.htmleditor.attr("data-active-tab",o.activetab),o.editor.refresh())}),this.htmleditor.on("click","a[data-htmleditor-button]",function(){o.code.is(":visible")&&o.trigger("action."+s.$(this).data("htmleditor-button"),[o.editor])}),this.preview.parent().css("height",this.code.height()),this.options.autocomplete&&this.CodeMirror.showHint&&this.CodeMirror.hint&&this.CodeMirror.hint.html&&this.editor.on("inputRead",s.Utils.debounce(function(){var t=o.editor.getDoc().getCursor();if("xml"==o.CodeMirror.innerMode(o.editor.getMode(),o.editor.getTokenAt(t).state).mode.name){var e=o.editor.getCursor(),i=o.editor.getTokenAt(e);"<"!=i.string.charAt(0)&&"attribute"!=i.type||o.CodeMirror.showHint(o.editor,o.CodeMirror.hint.html,{completeSingle:!1})}},100)),this.debouncedRedraw=s.Utils.debounce(function(){o.redraw()},5),this.on("init.uk.component",function(){o.debouncedRedraw()}),this.element.attr("data-uk-check-display",1).on("display.uk.check",function(t){this.htmleditor.is(":visible")&&this.fit()}.bind(this)),e.push(this)},addButton:function(t,e){this.buttons[t]=e},addButtons:function(t){s.$.extend(this.buttons,t)},replaceInPreview:function(t,i){var o=this.editor,n=[],r=o.getValue(),l=-1,s=0;function a(t){var e=o.getValue().substring(0,t).split("\n");return{line:e.length-1,ch:e[e.length-1].length}}return this.currentvalue=this.currentvalue.replace(t,function(){var e={matches:arguments,from:a(l=r.indexOf(arguments[0],++l)),to:a(l+arguments[0].length),replace:function(t){o.replaceRange(t,e.from,e.to)},inRange:function(t){return t.line===e.from.line&&t.line===e.to.line?t.ch>=e.from.ch&&t.ch<e.to.ch:t.line===e.from.line&&t.ch>=e.from.ch||t.line>e.from.line&&t.line<e.to.line||t.line===e.to.line&&t.ch<e.to.ch}},t="string"==typeof i?i:i(e,s);return t||""===t?(s++,n.push(e),t):arguments[0]}),n},_buildtoolbar:function(){if(this.options.toolbar&&this.options.toolbar.length){var i=this,o=[];this.toolbar.empty(),this.options.toolbar.forEach(function(t){if(i.buttons[t]){var e=i.buttons[t].title?i.buttons[t].title:t;o.push('<li><a data-htmleditor-button="'+t+'" title="'+e+'" data-uk-tooltip>'+i.buttons[t].label+"</a></li>")}}),this.toolbar.html(o.join("\n"))}},fit:function(){var t=this.options.mode;"split"==t&&this.htmleditor.width()<this.options.maxsplitsize&&(t="tab"),"tab"==t&&(this.activetab||(this.activetab="code",this.htmleditor.attr("data-active-tab",this.activetab)),this.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter("code"==this.activetab?".uk-htmleditor-button-code":".uk-htmleditor-button-preview").addClass("uk-active")),this.editor.refresh(),this.preview.parent().css("height",this.code.height()),this.htmleditor.attr("data-mode",t)},redraw:function(){this._buildtoolbar(),this.render(),this.fit()},getMode:function(){return this.editor.getOption("mode")},getCursorMode:function(){var t={mode:"html"};return this.trigger("cursorMode",[t]),t.mode},render:function(){if(this.currentvalue=this.editor.getValue(),this.options.enablescripts||(this.currentvalue=this.currentvalue.replace(/<(script|style)\b[^<]*(?:(?!<\/(script|style)>)<[^<]*)*<\/(script|style)>/gim,"")),!this.currentvalue)return this.element.val(""),void this.preview.container.html("");this.trigger("render",[this]),this.trigger("renderLate",[this]),this.preview.container.html(this.currentvalue)},addShortcut:function(t,e){var i={};return s.$.isArray(t)||(t=[t]),t.forEach(function(t){i[t]=e}),this.editor.addKeyMap(i),i},addShortcutAction:function(t,e){var i=this;this.addShortcut(e,function(){i.element.trigger("action."+t,[i.editor])})},replaceSelection:function(t){var e=this.editor.getSelection();if(!e.length){for(var i=this.editor.getCursor(),o=this.editor.getLine(i.line),n=i.ch,r=n;r<o.length&&/[\w$]+/.test(o.charAt(r));)++r;for(;n&&/[\w$]+/.test(o.charAt(n-1));)--n;var l=n!=r&&o.slice(n,r);l&&(this.editor.setSelection({line:i.line,ch:n},{line:i.line,ch:r}),e=l)}var s=t.replace("$1",e);this.editor.replaceSelection(s,"end"),this.editor.focus()},replaceLine:function(t){var e=this.editor.getDoc().getCursor(),i=this.editor.getLine(e.line),o=t.replace("$1",i);this.editor.replaceRange(o,{line:e.line,ch:0},{line:e.line,ch:i.length}),this.editor.setCursor({line:e.line,ch:o.length}),this.editor.focus()},save:function(){this.editor.save()}}),s.components.htmleditor.template=['<div class="uk-htmleditor uk-clearfix" data-mode="split">','<div class="uk-htmleditor-navbar">','<ul class="uk-htmleditor-navbar-nav uk-htmleditor-toolbar"></ul>','<div class="uk-htmleditor-navbar-flip">','<ul class="uk-htmleditor-navbar-nav">','<li class="uk-htmleditor-button-code"><a>{:lblCodeview}</a></li>','<li class="uk-htmleditor-button-preview"><a>{:lblPreview}</a></li>','<li><a data-htmleditor-button="fullscreen"><i class="uk-icon-expand"></i></a></li>',"</ul>","</div>","</div>",'<div class="uk-htmleditor-content">','<div class="uk-htmleditor-code"></div>','<div class="uk-htmleditor-preview"><div></div></div>',"</div>","</div>"].join(""),s.plugin("htmleditor","base",{init:function(a){a.addButtons({fullscreen:{title:"Fullscreen",label:'<i class="uk-icon-expand"></i>'},bold:{title:"Bold",label:'<i class="uk-icon-bold"></i>'},italic:{title:"Italic",label:'<i class="uk-icon-italic"></i>'},strike:{title:"Strikethrough",label:'<i class="uk-icon-strikethrough"></i>'},blockquote:{title:"Blockquote",label:'<i class="uk-icon-quote-right"></i>'},link:{title:"Link",label:'<i class="uk-icon-link"></i>'},image:{title:"Image",label:'<i class="uk-icon-picture-o"></i>'},listUl:{title:"Unordered List",label:'<i class="uk-icon-list-ul"></i>'},listOl:{title:"Ordered List",label:'<i class="uk-icon-list-ol"></i>'}}),e("bold","<strong>$1</strong>"),e("italic","<em>$1</em>"),e("strike","<del>$1</del>"),e("blockquote","<blockquote><p>$1</p></blockquote>","replaceLine"),e("link",'<a href="http://">$1</a>'),e("image",'<img src="http://" alt="$1">');var t=function(t){if("html"==a.getCursorMode()){t=t||"ul";for(var e=a.editor,i=e.getDoc(),o=i.getCursor(!0),n=i.getCursor(!1),r=CodeMirror.innerMode(e.getMode(),e.getTokenAt(e.getCursor()).state),l=r&&r.state&&r.state.context&&-1!=["ul","ol"].indexOf(r.state.context.tagName),s=o.line;s<n.line+1;s++)e.replaceRange("<li>"+e.getLine(s)+"</li>",{line:s,ch:0},{line:s,ch:e.getLine(s).length});l?e.setCursor({line:n.line,ch:e.getLine(n.line).length}):(e.replaceRange("<"+t+">\n"+e.getLine(o.line),{line:o.line,ch:0},{line:o.line,ch:e.getLine(o.line).length}),e.replaceRange(e.getLine(n.line+1)+"\n</"+t+">",{line:n.line+1,ch:0},{line:n.line+1,ch:e.getLine(n.line+1).length}),e.setCursor({line:n.line+1,ch:e.getLine(n.line+1).length})),e.focus()}};function e(t,e,i){a.on("action."+t,function(){"html"==a.getCursorMode()&&a["replaceLine"==i?"replaceLine":"replaceSelection"](e)})}a.on("action.listUl",function(){t("ul")}),a.on("action.listOl",function(){t("ol")}),a.htmleditor.on("click",'a[data-htmleditor-button="fullscreen"]',function(){a.htmleditor.toggleClass("uk-htmleditor-fullscreen");var t=a.editor.getWrapperElement();if(a.htmleditor.hasClass("uk-htmleditor-fullscreen")){var e=!1,i=a.htmleditor.parents().each(function(){"fixed"!=s.$(this).css("position")||s.$(this).is("html")||(e=s.$(this))});if(a.htmleditor.data("fixedParents",!1),e){var o=[];e=e.parent().find(i).each(function(){"none"!=s.$(this).css("transform")&&o.push(s.$(this).data("transform-reset",{transform:this.style.transform,"-webkit-transform":this.style.webkitTransform,"-webkit-transition":this.style.webkitTransition,transition:this.style.transition}).css({transform:"none","-webkit-transform":"none","-webkit-transition":"none",transition:"none"}))}),a.htmleditor.data("fixedParents",o)}a.editor.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height=a.content.height()+"px",document.documentElement.style.overflow="hidden"}else{document.documentElement.style.overflow="";var n=a.editor.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),a.htmleditor.data("fixedParents")&&a.htmleditor.data("fixedParents").forEach(function(t){t.css(t.data("transform-reset"))})}setTimeout(function(){a.fit(),s.$win.trigger("resize")},50)}),a.addShortcut(["Ctrl-S","Cmd-S"],function(){a.element.trigger("htmleditor-save",[a])}),a.addShortcutAction("bold",["Ctrl-B","Cmd-B"])}}),s.plugin("htmleditor","markdown",{init:function(l){var t=l.options.mdparser||window.marked||null;function e(){l.editor.setOption("mode","gfm"),l.htmleditor.find(".uk-htmleditor-button-code a").html(l.options.lblMarkedview)}function i(t,e,i){l.on("action."+t,function(){"markdown"==l.getCursorMode()&&l["replaceLine"==i?"replaceLine":"replaceSelection"](e)})}t&&(l.options.markdown&&e(),i("bold","**$1**"),i("italic","*$1*"),i("strike","~~$1~~"),i("blockquote","> $1","replaceLine"),i("link","[$1](http://)"),i("image","![$1](http://)"),l.on("action.listUl",function(){if("markdown"==l.getCursorMode()){for(var t=l.editor,e=t.getDoc().getCursor(!0),i=t.getDoc().getCursor(!1),o=e.line;o<i.line+1;o++)t.replaceRange("* "+t.getLine(o),{line:o,ch:0},{line:o,ch:t.getLine(o).length});t.setCursor({line:i.line,ch:t.getLine(i.line).length}),t.focus()}}),l.on("action.listOl",function(){if("markdown"==l.getCursorMode()){var t,e=l.editor,i=e.getDoc().getCursor(!0),o=e.getDoc().getCursor(!1),n=1;if(0<i.line)(t=e.getLine(i.line-1).match(/^(\d+)\./))&&(n=Number(t[1])+1);for(var r=i.line;r<o.line+1;r++)e.replaceRange(n+". "+e.getLine(r),{line:r,ch:0},{line:r,ch:e.getLine(r).length}),n++;e.setCursor({line:o.line,ch:e.getLine(o.line).length}),e.focus()}}),l.on("renderLate",function(){"gfm"==l.editor.options.mode&&(l.currentvalue=t(l.currentvalue))}),l.on("cursorMode",function(t,e){if("gfm"==l.editor.options.mode){var i=l.editor.getDoc().getCursor();l.editor.getTokenAt(i).state.base.htmlState||(e.mode="markdown")}}),s.$.extend(l,{enableMarkdown:function(){e(),this.render()},disableMarkdown:function(){this.editor.setOption("mode","htmlmixed"),this.htmleditor.find(".uk-htmleditor-button-code a").html(this.options.lblCodeview),this.render()}}),l.on({enableMarkdown:function(){l.enableMarkdown()},disableMarkdown:function(){l.disableMarkdown()}}))}}),s.htmleditor});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvaHRtbGVkaXRvci5qcyJdLCJuYW1lcyI6WyJhZGRvbiIsImNvbXBvbmVudCIsIndpbmRvdyIsIlVJa2l0MiIsImRlZmluZSIsImFtZCIsIlVJIiwiZWRpdG9ycyIsImRlZmF1bHRzIiwiaWZyYW1lIiwibW9kZSIsIm1hcmtkb3duIiwiYXV0b2NvbXBsZXRlIiwiZW5hYmxlc2NyaXB0cyIsImhlaWdodCIsIm1heHNwbGl0c2l6ZSIsImNvZGVtaXJyb3IiLCJsaW5lV3JhcHBpbmciLCJkcmFnRHJvcCIsImF1dG9DbG9zZVRhZ3MiLCJtYXRjaFRhZ3MiLCJhdXRvQ2xvc2VCcmFja2V0cyIsIm1hdGNoQnJhY2tldHMiLCJpbmRlbnRVbml0IiwiaW5kZW50V2l0aFRhYnMiLCJ0YWJTaXplIiwiaGludE9wdGlvbnMiLCJjb21wbGV0aW9uU2luZ2xlIiwidG9vbGJhciIsImxibFByZXZpZXciLCJsYmxDb2RldmlldyIsImxibE1hcmtlZHZpZXciLCJib290IiwicmVhZHkiLCJjb250ZXh0IiwiJCIsImVhY2giLCJlZGl0b3IiLCJ0aGlzIiwiZGF0YSIsImh0bWxlZGl0b3IiLCJVdGlscyIsIm9wdGlvbnMiLCJhdHRyIiwiaW5pdCIsIiR0aGlzIiwidHBsIiwiY29tcG9uZW50cyIsInRlbXBsYXRlIiwiQ29kZU1pcnJvciIsImJ1dHRvbnMiLCJyZXBsYWNlIiwiY29udGVudCIsImZpbmQiLCJwcmV2aWV3IiwiY2hpbGRyZW4iLCJlcSIsImNvZGUiLCJlbGVtZW50IiwiYmVmb3JlIiwiYXBwZW5kVG8iLCJmcm9tVGV4dEFyZWEiLCJvbiIsImRlYm91bmNlIiwicmVuZGVyIiwic2F2ZSIsInRyaWdnZXIiLCJjc3MiLCJhcHBlbmQiLCJjb250ZW50V2luZG93IiwiZG9jdW1lbnQiLCJvcGVuIiwiY2xvc2UiLCJjb250YWluZXIiLCJwYXJlbnQiLCIkd2luIiwiZml0IiwicHJldmlld0NvbnRhaW5lciIsImNvZGVDb250ZW50IiwiY29kZVNjcm9sbCIsImNvZGVIZWlnaHQiLCJyYXRpbyIsInNjcm9sbEhlaWdodCIsInByZXZpZXdQb3NpdGlvbiIsInNjcm9sbFRvcCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlbW92ZUNsYXNzIiwiZmlsdGVyIiwiYWRkQ2xhc3MiLCJhY3RpdmV0YWIiLCJoYXNDbGFzcyIsInJlZnJlc2giLCJpcyIsInNob3dIaW50IiwiaGludCIsImh0bWwiLCJQT1MiLCJnZXREb2MiLCJnZXRDdXJzb3IiLCJpbm5lck1vZGUiLCJnZXRNb2RlIiwiZ2V0VG9rZW5BdCIsInN0YXRlIiwibmFtZSIsImN1ciIsInRva2VuIiwic3RyaW5nIiwiY2hhckF0IiwidHlwZSIsImNvbXBsZXRlU2luZ2xlIiwiZGVib3VuY2VkUmVkcmF3IiwicmVkcmF3IiwiYmluZCIsInB1c2giLCJhZGRCdXR0b24iLCJidXR0b24iLCJhZGRCdXR0b25zIiwiZXh0ZW5kIiwicmVwbGFjZUluUHJldmlldyIsInJlZ2V4cCIsImNhbGxiYWNrIiwicmVzdWx0cyIsInZhbHVlIiwiZ2V0VmFsdWUiLCJvZmZzZXQiLCJpbmRleCIsInRyYW5zbGF0ZU9mZnNldCIsInJlc3VsdCIsInN1YnN0cmluZyIsInNwbGl0IiwibGluZSIsImxlbmd0aCIsImNoIiwiY3VycmVudHZhbHVlIiwibWF0Y2giLCJtYXRjaGVzIiwiYXJndW1lbnRzIiwiZnJvbSIsImluZGV4T2YiLCJ0byIsInJlcGxhY2VSYW5nZSIsImluUmFuZ2UiLCJjdXJzb3IiLCJfYnVpbGR0b29sYmFyIiwiYmFyIiwiZW1wdHkiLCJmb3JFYWNoIiwidGl0bGUiLCJsYWJlbCIsImpvaW4iLCJ3aWR0aCIsImdldE9wdGlvbiIsImdldEN1cnNvck1vZGUiLCJwYXJhbSIsInZhbCIsImFkZFNob3J0Y3V0IiwibWFwIiwiaXNBcnJheSIsImtleSIsImFkZEtleU1hcCIsImFkZFNob3J0Y3V0QWN0aW9uIiwiYWN0aW9uIiwic2hvcnRjdXRzIiwicmVwbGFjZVNlbGVjdGlvbiIsInRleHQiLCJnZXRTZWxlY3Rpb24iLCJjdXJMaW5lIiwiZ2V0TGluZSIsInN0YXJ0IiwiZW5kIiwidGVzdCIsImN1cldvcmQiLCJzbGljZSIsInNldFNlbGVjdGlvbiIsImZvY3VzIiwicmVwbGFjZUxpbmUiLCJwb3MiLCJzZXRDdXJzb3IiLCJwbHVnaW4iLCJmdWxsc2NyZWVuIiwiYm9sZCIsIml0YWxpYyIsInN0cmlrZSIsImJsb2NrcXVvdGUiLCJsaW5rIiwiaW1hZ2UiLCJsaXN0VWwiLCJsaXN0T2wiLCJhZGRBY3Rpb24iLCJsaXN0Zm4iLCJ0YWciLCJjbSIsImRvYyIsInBvc2VuZCIsImltIiwiaW5MaXN0IiwidGFnTmFtZSIsImkiLCJ0b2dnbGVDbGFzcyIsIndyYXAiLCJnZXRXcmFwcGVyRWxlbWVudCIsImZpeGVkUGFyZW50IiwicGFyZW50cyIsInRyYW5zZm9ybWVkIiwidHJhbnNmb3JtIiwic3R5bGUiLCItd2Via2l0LXRyYW5zZm9ybSIsIndlYmtpdFRyYW5zZm9ybSIsIi13ZWJraXQtdHJhbnNpdGlvbiIsIndlYmtpdFRyYW5zaXRpb24iLCJ0cmFuc2l0aW9uIiwiZnVsbFNjcmVlblJlc3RvcmUiLCJwYWdlWU9mZnNldCIsInNjcm9sbExlZnQiLCJwYWdlWE9mZnNldCIsImRvY3VtZW50RWxlbWVudCIsIm92ZXJmbG93IiwiaW5mbyIsInNjcm9sbFRvIiwic2V0VGltZW91dCIsInBhcnNlciIsIm1kcGFyc2VyIiwibWFya2VkIiwiZW5hYmxlTWFya2Rvd24iLCJzZXRPcHRpb24iLCJwcmVmaXgiLCJOdW1iZXIiLCJiYXNlIiwiaHRtbFN0YXRlIiwiZGlzYWJsZU1hcmtkb3duIl0sIm1hcHBpbmdzIjoiQ0FDQSxTQUFVQSxHQUVOLElBQUlDLEVBRUFDLE9BQU9DLFNBQ1BGLEVBQVlELEVBQU1HLFNBR0QsbUJBQVZDLFFBQXdCQSxPQUFPQyxLQUN0Q0QsT0FBTyxtQkFBb0IsQ0FBQyxTQUFVLFdBQ2xDLE9BQU9ILEdBQWFELEVBQU1HLFVBVnRDLENBY0csU0FBU0csR0FFUixhQUVBLElBQUlDLEVBQVUsR0FrcEJkLE9BaHBCQUQs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QUFjLFNBQVN1QixFQUFHcUUsR0FDaEMsR0FBa0MsT0FBOUJySCxFQUFPQSxPQUFPSyxRQUFRaEMsS0FBZSxDQUNyQyxJQUFJdUssRUFBTTVJLEVBQU9BLE9BQU82RCxTQUFTQyxZQUM1QjlELEVBQU9BLE9BQU9pRSxXQUFXMkUsR0FBSzFFLE1BQU02SCxLQUFLQyxZQUMxQzNFLEVBQU1oSixLQUFPLGVBS3pCSixFQUFHNkIsRUFBRW1GLE9BQU9qRixFQUFRLENBRWhCMkwsZUFBZ0IsV0FDWkEsSUFDQTFMLEtBQUswQixVQUVUc0ssZ0JBQWlCLFdBQ2JoTSxLQUFLRCxPQUFPNEwsVUFBVSxPQUFRLGFBQzlCM0wsS0FBS0UsV0FBV2EsS0FBSyxnQ0FBZ0MyQyxLQUFLMUQsS0FBS0ksUUFBUVosYUFDdkVRLEtBQUswQixZQU1iM0IsRUFBT3lCLEdBQUcsQ0FDTmtLLGVBQWtCLFdBQWEzTCxFQUFPMkwsa0JBQ3RDTSxnQkFBa0IsV0FBYWpNLEVBQU9pTSx5QkFrQjNDaE8sRUFBR2tDIiwiZmlsZSI6ImNvbXBvbmVudHMvaHRtbGVkaXRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cclxuKGZ1bmN0aW9uKGFkZG9uKSB7XHJcblxyXG4gICAgdmFyIGNvbXBvbmVudDtcclxuXHJcbiAgICBpZiAod2luZG93LlVJa2l0Mikge1xyXG4gICAgICAgIGNvbXBvbmVudCA9IGFkZG9uKFVJa2l0Mik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XHJcbiAgICAgICAgZGVmaW5lKCd1aWtpdC1odG1sZWRpdG9yJywgWyd1aWtpdCddLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50IHx8IGFkZG9uKFVJa2l0Mik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59KShmdW5jdGlvbihVSSkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBlZGl0b3JzID0gW107XHJcblxyXG4gICAgVUkuY29tcG9uZW50KCdodG1sZWRpdG9yJywge1xyXG5cclxuICAgICAgICBkZWZhdWx0czoge1xyXG4gICAgICAgICAgICBpZnJhbWUgICAgICAgOiBmYWxzZSxcclxuICAgICAgICAgICAgbW9kZSAgICAgICAgIDogJ3NwbGl0JyxcclxuICAgICAgICAgICAgbWFya2Rvd24gICAgIDogZmFsc2UsXHJcbiAgICAgICAgICAgIGF1dG9jb21wbGV0ZSA6IHRydWUsXHJcbiAgICAgICAgICAgIGVuYWJsZXNjcmlwdHM6IGZhbHNlLFxyXG4gICAgICAgICAgICBoZWlnaHQgICAgICAgOiA1MDAsXHJcbiAgICAgICAgICAgIG1heHNwbGl0c2l6ZSA6IDEwMDAsXHJcbiAgICAgICAgICAgIGNvZGVtaXJyb3IgICA6IHsgbW9kZTogJ2h0bWxtaXhlZCcsIGxpbmVXcmFwcGluZzogdHJ1ZSwgZHJhZ0Ryb3A6IGZhbHNlLCBhdXRvQ2xvc2VUYWdzOiB0cnVlLCBtYXRjaFRhZ3M6IHRydWUsIGF1dG9DbG9zZUJyYWNrZXRzOiB0cnVlLCBtYXRjaEJyYWNrZXRzOiB0cnVlLCBpbmRlbnRVbml0OiA0LCBpbmRlbnRXaXRoVGFiczogZmFsc2UsIHRhYlNpemU6IDQsIGhpbnRPcHRpb25zOiB7Y29tcGxldGlvblNpbmdsZTpmYWxzZX0gfSxcclxuICAgICAgICAgICAgdG9vbGJhciAgICAgIDogWyAnYm9sZCcsICdpdGFsaWMnLCAnc3RyaWtlJywgJ2xpbmsnLCAnaW1hZ2UnLCAnYmxvY2txdW90ZScsICdsaXN0VWwnLCAnbGlzdE9sJyBdLFxyXG4gICAgICAgICAgICBsYmxQcmV2aWV3ICAgOiAnUHJldmlldycsXHJcbiAgICAgICAgICAgIGxibENvZGV2aWV3ICA6ICdIVE1MJyxcclxuICAgICAgICAgICAgbGJsTWFya2VkdmlldzogJ01hcmtkb3duJ1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGJvb3Q6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gaW5pdCBjb2RlXHJcbiAgICAgICAgICAgIFVJLnJlYWR5KGZ1bmN0aW9uKGNvbnRleHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBVSS4kKCd0ZXh0YXJlYVtkYXRhLXVrLWh0bWxlZGl0b3JdJywgY29udGV4dCkuZWFjaChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXRvciA9IFVJLiQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yLmRhdGEoJ2h0bWxlZGl0b3InKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBVSS5odG1sZWRpdG9yKGVkaXRvciwgVUkuVXRpbHMub3B0aW9ucyhlZGl0b3IuYXR0cignZGF0YS11ay1odG1sZWRpdG9yJykpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgJHRoaXMgPSB0aGlzLCB0cGwgPSBVSS5jb21wb25lbnRzLmh0bWxlZGl0b3IudGVtcGxhdGU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkNvZGVNaXJyb3IgPSB0aGlzLm9wdGlvbnMuQ29kZU1pcnJvciB8fCBDb2RlTWlycm9yO1xyXG4gICAgICAgICAgICB0aGlzLmJ1dHRvbnMgICAgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHRwbCA9IHRwbC5yZXBsYWNlKC9cXHs6bGJsUHJldmlld30vZywgdGhpcy5vcHRpb25zLmxibFByZXZpZXcpO1xyXG4gICAgICAgICAgICB0cGwgPSB0cGwucmVwbGFjZSgvXFx7OmxibENvZGV2aWV3fS9nLCB0aGlzLm9wdGlvbnMubGJsQ29kZXZpZXcpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5odG1sZWRpdG9yID0gVUkuJCh0cGwpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQgICAgPSB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItY29udGVudCcpO1xyXG4gICAgICAgICAgICB0aGlzLnRvb2xiYXIgICAgPSB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItdG9vbGJhcicpO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXcgICAgPSB0aGlzLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItcHJldmlldycpLmNoaWxkcmVuKCkuZXEoMCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29kZSAgICAgICA9IHRoaXMuaHRtbGVkaXRvci5maW5kKCcudWstaHRtbGVkaXRvci1jb2RlJyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYmVmb3JlKHRoaXMuaHRtbGVkaXRvcikuYXBwZW5kVG8odGhpcy5jb2RlKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3IgPSB0aGlzLkNvZGVNaXJyb3IuZnJvbVRleHRBcmVhKHRoaXMuZWxlbWVudFswXSwgdGhpcy5vcHRpb25zLmNvZGVtaXJyb3IpO1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRvci5odG1sZWRpdG9yID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5lZGl0b3Iub24oJ2NoYW5nZScsIFVJLlV0aWxzLmRlYm91bmNlKGZ1bmN0aW9uKCkgeyAkdGhpcy5yZW5kZXIoKTsgfSwgMTUwKSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICR0aGlzLmVkaXRvci5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5lbGVtZW50LnRyaWdnZXIoJ2lucHV0Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmNvZGUuZmluZCgnLkNvZGVNaXJyb3InKS5jc3MoJ2hlaWdodCcsIHRoaXMub3B0aW9ucy5oZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgLy8gaWZyYW1lIG1vZGU/XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWZyYW1lKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5pZnJhbWUgPSBVSS4kKCc8aWZyYW1lIGNsYXNzPVwidWstaHRtbGVkaXRvci1pZnJhbWVcIiBmcmFtZWJvcmRlcj1cIjBcIiBzY3JvbGxpbmc9XCJhdXRvXCIgaGVpZ2h0PVwiMTAwXCIgd2lkdGg9XCIxMDAlXCI+PC9pZnJhbWU+Jyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXcuYXBwZW5kKHRoaXMuaWZyYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBtdXN0IG9wZW4gYW5kIGNsb3NlIGRvY3VtZW50IG9iamVjdCB0byBzdGFydCB1c2luZyBpdCFcclxuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudC5jbG9zZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlldy5jb250YWluZXIgPSBVSS4kKHRoaXMuaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpLmZpbmQoJ2JvZHknKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhcHBlbmQgY3VzdG9tIHN0eWxlc2hlZXRcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YodGhpcy5vcHRpb25zLmlmcmFtZSkgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3LmNvbnRhaW5lci5wYXJlbnQoKS5hcHBlbmQoJzxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiJyt0aGlzLm9wdGlvbnMuaWZyYW1lKydcIj4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXcuY29udGFpbmVyID0gdGhpcy5wcmV2aWV3O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBVSS4kd2luLm9uKCdyZXNpemUgbG9hZCcsIFVJLlV0aWxzLmRlYm91bmNlKGZ1bmN0aW9uKCkgeyAkdGhpcy5maXQoKTsgfSwgMjAwKSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcHJldmlld0NvbnRhaW5lciA9IHRoaXMuaWZyYW1lID8gdGhpcy5wcmV2aWV3LmNvbnRhaW5lcjokdGhpcy5wcmV2aWV3LnBhcmVudCgpLFxyXG4gICAgICAgICAgICAgICAgY29kZUNvbnRlbnQgICAgICA9IHRoaXMuY29kZS5maW5kKCcuQ29kZU1pcnJvci1zaXplcicpLFxyXG4gICAgICAgICAgICAgICAgY29kZVNjcm9sbCAgICAgICA9IHRoaXMuY29kZS5maW5kKCcuQ29kZU1pcnJvci1zY3JvbGwnKS5vbignc2Nyb2xsJywgVUkuVXRpbHMuZGVib3VuY2UoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkdGhpcy5odG1sZWRpdG9yLmF0dHIoJ2RhdGEtbW9kZScpID09ICd0YWInKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhbGMgcG9zaXRpb25cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29kZUhlaWdodCAgICAgID0gY29kZUNvbnRlbnQuaGVpZ2h0KCkgLSBjb2RlU2Nyb2xsLmhlaWdodCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3SGVpZ2h0ICAgPSBwcmV2aWV3Q29udGFpbmVyWzBdLnNjcm9sbEhlaWdodCAtICgkdGhpcy5pZnJhbWUgPyAkdGhpcy5pZnJhbWUuaGVpZ2h0KCkgOiBwcmV2aWV3Q29udGFpbmVyLmhlaWdodCgpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW8gICAgICAgICAgID0gcHJldmlld0hlaWdodCAvIGNvZGVIZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdQb3NpdGlvbiA9IGNvZGVTY3JvbGwuc2Nyb2xsVG9wKCkgKiByYXRpbztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXBwbHkgbmV3IHNjcm9sbFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdDb250YWluZXIuc2Nyb2xsVG9wKHByZXZpZXdQb3NpdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgfSwgMTApKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5vbignY2xpY2snLCAnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUsIC51ay1odG1sZWRpdG9yLWJ1dHRvbi1wcmV2aWV3JywgZnVuY3Rpb24oZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMuaHRtbGVkaXRvci5hdHRyKCdkYXRhLW1vZGUnKSA9PSAndGFiJykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlLCAudWstaHRtbGVkaXRvci1idXR0b24tcHJldmlldycpLnJlbW92ZUNsYXNzKCd1ay1hY3RpdmUnKS5maWx0ZXIodGhpcykuYWRkQ2xhc3MoJ3VrLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5hY3RpdmV0YWIgPSBVSS4kKHRoaXMpLmhhc0NsYXNzKCd1ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlJykgPyAnY29kZScgOiAncHJldmlldyc7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuaHRtbGVkaXRvci5hdHRyKCdkYXRhLWFjdGl2ZS10YWInLCAkdGhpcy5hY3RpdmV0YWIpO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmVkaXRvci5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gdG9vbGJhciBhY3Rpb25zXHJcbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5vbignY2xpY2snLCAnYVtkYXRhLWh0bWxlZGl0b3ItYnV0dG9uXScsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghJHRoaXMuY29kZS5pcygnOnZpc2libGUnKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICR0aGlzLnRyaWdnZXIoJ2FjdGlvbi4nICsgVUkuJCh0aGlzKS5kYXRhKCdodG1sZWRpdG9yLWJ1dHRvbicpLCBbJHRoaXMuZWRpdG9yXSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3LnBhcmVudCgpLmNzcygnaGVpZ2h0JywgdGhpcy5jb2RlLmhlaWdodCgpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGF1dG9jb21wbGV0ZVxyXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmF1dG9jb21wbGV0ZSAmJiB0aGlzLkNvZGVNaXJyb3Iuc2hvd0hpbnQgJiYgdGhpcy5Db2RlTWlycm9yLmhpbnQgJiYgdGhpcy5Db2RlTWlycm9yLmhpbnQuaHRtbCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm9uKCdpbnB1dFJlYWQnLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gJHRoaXMuZWRpdG9yLmdldERvYygpLCBQT1MgPSBkb2MuZ2V0Q3Vyc29yKCksIG1vZGUgPSAkdGhpcy5Db2RlTWlycm9yLmlubmVyTW9kZSgkdGhpcy5lZGl0b3IuZ2V0TW9kZSgpLCAkdGhpcy5lZGl0b3IuZ2V0VG9rZW5BdChQT1MpLnN0YXRlKS5tb2RlLm5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtb2RlID09ICd4bWwnKSB7IC8vaHRtbCBkZXBlbmRzIG9uIHhtbFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ciA9ICR0aGlzLmVkaXRvci5nZXRDdXJzb3IoKSwgdG9rZW4gPSAkdGhpcy5lZGl0b3IuZ2V0VG9rZW5BdChjdXIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuLnN0cmluZy5jaGFyQXQoMCkgPT0gJzwnIHx8IHRva2VuLnR5cGUgPT0gJ2F0dHJpYnV0ZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLkNvZGVNaXJyb3Iuc2hvd0hpbnQoJHRoaXMuZWRpdG9yLCAkdGhpcy5Db2RlTWlycm9yLmhpbnQuaHRtbCwgeyBjb21wbGV0ZVNpbmdsZTogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCAxMDApKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5kZWJvdW5jZWRSZWRyYXcgPSBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbiAoKSB7ICR0aGlzLnJlZHJhdygpOyB9LCA1KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMub24oJ2luaXQudWsuY29tcG9uZW50JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5kZWJvdW5jZWRSZWRyYXcoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXR0cignZGF0YS11ay1jaGVjay1kaXNwbGF5JywgMSkub24oJ2Rpc3BsYXkudWsuY2hlY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5odG1sZWRpdG9yLmlzKFwiOnZpc2libGVcIikpIHRoaXMuZml0KCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICBlZGl0b3JzLnB1c2godGhpcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYWRkQnV0dG9uOiBmdW5jdGlvbihuYW1lLCBidXR0b24pIHtcclxuICAgICAgICAgICAgdGhpcy5idXR0b25zW25hbWVdID0gYnV0dG9uO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFkZEJ1dHRvbnM6IGZ1bmN0aW9uKGJ1dHRvbnMpIHtcclxuICAgICAgICAgICAgVUkuJC5leHRlbmQodGhpcy5idXR0b25zLCBidXR0b25zKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXBsYWNlSW5QcmV2aWV3OiBmdW5jdGlvbihyZWdleHAsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3IsIHJlc3VsdHMgPSBbXSwgdmFsdWUgPSBlZGl0b3IuZ2V0VmFsdWUoKSwgb2Zmc2V0ID0gLTEsIGluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudHZhbHVlID0gdGhpcy5jdXJyZW50dmFsdWUucmVwbGFjZShyZWdleHAsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIG9mZnNldCA9IHZhbHVlLmluZGV4T2YoYXJndW1lbnRzWzBdLCArK29mZnNldCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG1hdGNoICA9IHtcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVzOiBhcmd1bWVudHMsXHJcbiAgICAgICAgICAgICAgICAgICAgZnJvbSAgIDogdHJhbnNsYXRlT2Zmc2V0KG9mZnNldCksXHJcbiAgICAgICAgICAgICAgICAgICAgdG8gICAgIDogdHJhbnNsYXRlT2Zmc2V0KG9mZnNldCArIGFyZ3VtZW50c1swXS5sZW5ndGgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2U6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodmFsdWUsIG1hdGNoLmZyb20sIG1hdGNoLnRvKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGluUmFuZ2U6IGZ1bmN0aW9uKGN1cnNvcikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnNvci5saW5lID09PSBtYXRjaC5mcm9tLmxpbmUgJiYgY3Vyc29yLmxpbmUgPT09IG1hdGNoLnRvLmxpbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJzb3IuY2ggPj0gbWF0Y2guZnJvbS5jaCAmJiBjdXJzb3IuY2ggPCBtYXRjaC50by5jaDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAoY3Vyc29yLmxpbmUgPT09IG1hdGNoLmZyb20ubGluZSAmJiBjdXJzb3IuY2ggICA+PSBtYXRjaC5mcm9tLmNoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjdXJzb3IubGluZSA+ICAgbWF0Y2guZnJvbS5saW5lICYmIGN1cnNvci5saW5lIDwgIG1hdGNoLnRvLmxpbmUpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGN1cnNvci5saW5lID09PSBtYXRjaC50by5saW5lICAgJiYgY3Vyc29yLmNoICAgPCAgbWF0Y2gudG8uY2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHR5cGVvZihjYWxsYmFjaykgPT09ICdzdHJpbmcnID8gY2FsbGJhY2sgOiBjYWxsYmFjayhtYXRjaCwgaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIHJlc3VsdCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGluZGV4Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKG1hdGNoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdHJhbnNsYXRlT2Zmc2V0KG9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGVkaXRvci5nZXRWYWx1ZSgpLnN1YnN0cmluZygwLCBvZmZzZXQpLnNwbGl0KCdcXG4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IGxpbmU6IHJlc3VsdC5sZW5ndGggLSAxLCBjaDogcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXS5sZW5ndGggfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfYnVpbGR0b29sYmFyOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICghKHRoaXMub3B0aW9ucy50b29sYmFyICYmIHRoaXMub3B0aW9ucy50b29sYmFyLmxlbmd0aCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXMsIGJhciA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdGhpcy50b29sYmFyLmVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMudG9vbGJhci5mb3JFYWNoKGZ1bmN0aW9uKGJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEkdGhpcy5idXR0b25zW2J1dHRvbl0pIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSAkdGhpcy5idXR0b25zW2J1dHRvbl0udGl0bGUgPyAkdGhpcy5idXR0b25zW2J1dHRvbl0udGl0bGUgOiBidXR0b247XHJcblxyXG4gICAgICAgICAgICAgICAgYmFyLnB1c2goJzxsaT48YSBkYXRhLWh0bWxlZGl0b3ItYnV0dG9uPVwiJytidXR0b24rJ1wiIHRpdGxlPVwiJyt0aXRsZSsnXCIgZGF0YS11ay10b29sdGlwPicrJHRoaXMuYnV0dG9uc1tidXR0b25dLmxhYmVsKyc8L2E+PC9saT4nKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRvb2xiYXIuaHRtbChiYXIuam9pbignXFxuJykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZpdDogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgbW9kZSA9IHRoaXMub3B0aW9ucy5tb2RlO1xyXG5cclxuICAgICAgICAgICAgaWYgKG1vZGUgPT0gJ3NwbGl0JyAmJiB0aGlzLmh0bWxlZGl0b3Iud2lkdGgoKSA8IHRoaXMub3B0aW9ucy5tYXhzcGxpdHNpemUpIHtcclxuICAgICAgICAgICAgICAgIG1vZGUgPSAndGFiJztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1vZGUgPT0gJ3RhYicpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5hY3RpdmV0YWIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZXRhYiA9ICdjb2RlJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmh0bWxlZGl0b3IuYXR0cignZGF0YS1hY3RpdmUtdGFiJywgdGhpcy5hY3RpdmV0YWIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5maW5kKCcudWstaHRtbGVkaXRvci1idXR0b24tY29kZSwgLnVrLWh0bWxlZGl0b3ItYnV0dG9uLXByZXZpZXcnKS5yZW1vdmVDbGFzcygndWstYWN0aXZlJylcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHRoaXMuYWN0aXZldGFiID09ICdjb2RlJyA/ICcudWstaHRtbGVkaXRvci1idXR0b24tY29kZScgOiAnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLXByZXZpZXcnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygndWstYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3LnBhcmVudCgpLmNzcygnaGVpZ2h0JywgdGhpcy5jb2RlLmhlaWdodCgpKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaHRtbGVkaXRvci5hdHRyKCdkYXRhLW1vZGUnLCBtb2RlKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZWRyYXc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idWlsZHRvb2xiYXIoKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgdGhpcy5maXQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRNb2RlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdG9yLmdldE9wdGlvbignbW9kZScpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEN1cnNvck1vZGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW0gPSB7IG1vZGU6ICdodG1sJ307XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY3Vyc29yTW9kZScsIFtwYXJhbV0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcGFyYW0ubW9kZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50dmFsdWUgPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZW5hYmxlc2NyaXB0cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50dmFsdWUgPSB0aGlzLmN1cnJlbnR2YWx1ZS5yZXBsYWNlKC88KHNjcmlwdHxzdHlsZSlcXGJbXjxdKig/Oig/ITxcXC8oc2NyaXB0fHN0eWxlKT4pPFtePF0qKSo8XFwvKHNjcmlwdHxzdHlsZSk+L2ltZywgJycpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBlbXB0eSBjb2RlXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5jdXJyZW50dmFsdWUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudmFsKCcnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlldy5jb250YWluZXIuaHRtbCgnJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3JlbmRlcicsIFt0aGlzXSk7XHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcigncmVuZGVyTGF0ZScsIFt0aGlzXSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXcuY29udGFpbmVyLmh0bWwodGhpcy5jdXJyZW50dmFsdWUpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFkZFNob3J0Y3V0OiBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgbWFwID0ge307XHJcbiAgICAgICAgICAgIGlmICghVUkuJC5pc0FycmF5KG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gW25hbWVdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBuYW1lLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBtYXBba2V5XSA9IGNhbGxiYWNrO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLmFkZEtleU1hcChtYXApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hcDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhZGRTaG9ydGN1dEFjdGlvbjogZnVuY3Rpb24oYWN0aW9uLCBzaG9ydGN1dHMpIHtcclxuICAgICAgICAgICAgdmFyIGVkaXRvciA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkU2hvcnRjdXQoc2hvcnRjdXRzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5lbGVtZW50LnRyaWdnZXIoJ2FjdGlvbi4nICsgYWN0aW9uLCBbZWRpdG9yLmVkaXRvcl0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXBsYWNlU2VsZWN0aW9uOiBmdW5jdGlvbihyZXBsYWNlKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMuZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF0ZXh0Lmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjdXIgICAgID0gdGhpcy5lZGl0b3IuZ2V0Q3Vyc29yKCksXHJcbiAgICAgICAgICAgICAgICAgICAgY3VyTGluZSA9IHRoaXMuZWRpdG9yLmdldExpbmUoY3VyLmxpbmUpLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ICAgPSBjdXIuY2gsXHJcbiAgICAgICAgICAgICAgICAgICAgZW5kICAgICA9IHN0YXJ0O1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlIChlbmQgPCBjdXJMaW5lLmxlbmd0aCAmJiAvW1xcdyRdKy8udGVzdChjdXJMaW5lLmNoYXJBdChlbmQpKSkgKytlbmQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoc3RhcnQgJiYgL1tcXHckXSsvLnRlc3QoY3VyTGluZS5jaGFyQXQoc3RhcnQgLSAxKSkpIC0tc3RhcnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGN1cldvcmQgPSBzdGFydCAhPSBlbmQgJiYgY3VyTGluZS5zbGljZShzdGFydCwgZW5kKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY3VyV29yZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldFNlbGVjdGlvbih7IGxpbmU6IGN1ci5saW5lLCBjaDogc3RhcnR9LCB7IGxpbmU6IGN1ci5saW5lLCBjaDogZW5kIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSBjdXJXb3JkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgaHRtbCA9IHJlcGxhY2UucmVwbGFjZSgnJDEnLCB0ZXh0KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oaHRtbCwgJ2VuZCcpO1xyXG4gICAgICAgICAgICB0aGlzLmVkaXRvci5mb2N1cygpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlcGxhY2VMaW5lOiBmdW5jdGlvbihyZXBsYWNlKSB7XHJcbiAgICAgICAgICAgIHZhciBwb3MgID0gdGhpcy5lZGl0b3IuZ2V0RG9jKCkuZ2V0Q3Vyc29yKCksXHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGhpcy5lZGl0b3IuZ2V0TGluZShwb3MubGluZSksXHJcbiAgICAgICAgICAgICAgICBodG1sID0gcmVwbGFjZS5yZXBsYWNlKCckMScsIHRleHQpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5lZGl0b3IucmVwbGFjZVJhbmdlKGh0bWwgLCB7IGxpbmU6IHBvcy5saW5lLCBjaDogMCB9LCB7IGxpbmU6IHBvcy5saW5lLCBjaDogdGV4dC5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHBvcy5saW5lLCBjaDogaHRtbC5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLmZvY3VzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2F2ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNhdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgVUkuY29tcG9uZW50cy5odG1sZWRpdG9yLnRlbXBsYXRlID0gW1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvciB1ay1jbGVhcmZpeFwiIGRhdGEtbW9kZT1cInNwbGl0XCI+JyxcclxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1ay1odG1sZWRpdG9yLW5hdmJhclwiPicsXHJcbiAgICAgICAgICAgICAgICAnPHVsIGNsYXNzPVwidWstaHRtbGVkaXRvci1uYXZiYXItbmF2IHVrLWh0bWxlZGl0b3ItdG9vbGJhclwiPjwvdWw+JyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvci1uYXZiYXItZmxpcFwiPicsXHJcbiAgICAgICAgICAgICAgICAgICAgJzx1bCBjbGFzcz1cInVrLWh0bWxlZGl0b3ItbmF2YmFyLW5hdlwiPicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICc8bGkgY2xhc3M9XCJ1ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlXCI+PGE+ezpsYmxDb2Rldmlld308L2E+PC9saT4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGxpIGNsYXNzPVwidWstaHRtbGVkaXRvci1idXR0b24tcHJldmlld1wiPjxhPns6bGJsUHJldmlld308L2E+PC9saT4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGxpPjxhIGRhdGEtaHRtbGVkaXRvci1idXR0b249XCJmdWxsc2NyZWVuXCI+PGkgY2xhc3M9XCJ1ay1pY29uLWV4cGFuZFwiPjwvaT48L2E+PC9saT4nLFxyXG4gICAgICAgICAgICAgICAgICAgICc8L3VsPicsXHJcbiAgICAgICAgICAgICAgICAnPC9kaXY+JyxcclxuICAgICAgICAgICAgJzwvZGl2PicsXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvci1jb250ZW50XCI+JyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvci1jb2RlXCI+PC9kaXY+JyxcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstaHRtbGVkaXRvci1wcmV2aWV3XCI+PGRpdj48L2Rpdj48L2Rpdj4nLFxyXG4gICAgICAgICAgICAnPC9kaXY+JyxcclxuICAgICAgICAnPC9kaXY+J1xyXG4gICAgXS5qb2luKCcnKTtcclxuXHJcblxyXG4gICAgVUkucGx1Z2luKCdodG1sZWRpdG9yJywgJ2Jhc2UnLCB7XHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVkaXRvcikge1xyXG5cclxuICAgICAgICAgICAgZWRpdG9yLmFkZEJ1dHRvbnMoe1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW46IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnRnVsbHNjcmVlbicsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgIDogJzxpIGNsYXNzPVwidWstaWNvbi1leHBhbmRcIj48L2k+J1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGJvbGQgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ0JvbGQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24tYm9sZFwiPjwvaT4nXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaXRhbGljIDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlICA6ICdJdGFsaWMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24taXRhbGljXCI+PC9pPidcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdHJpa2UgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ1N0cmlrZXRocm91Z2gnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24tc3RyaWtldGhyb3VnaFwiPjwvaT4nXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYmxvY2txdW90ZSA6IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnQmxvY2txdW90ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgIDogJzxpIGNsYXNzPVwidWstaWNvbi1xdW90ZS1yaWdodFwiPjwvaT4nXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbGluayA6IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnTGluaycsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwgIDogJzxpIGNsYXNzPVwidWstaWNvbi1saW5rXCI+PC9pPidcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBpbWFnZSA6IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnSW1hZ2UnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsICA6ICc8aSBjbGFzcz1cInVrLWljb24tcGljdHVyZS1vXCI+PC9pPidcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBsaXN0VWwgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgIDogJ1Vub3JkZXJlZCBMaXN0JyxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLWxpc3QtdWxcIj48L2k+J1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxpc3RPbCA6IHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZSAgOiAnT3JkZXJlZCBMaXN0JyxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbCAgOiAnPGkgY2xhc3M9XCJ1ay1pY29uLWxpc3Qtb2xcIj48L2k+J1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhZGRBY3Rpb24oJ2JvbGQnLCAnPHN0cm9uZz4kMTwvc3Ryb25nPicpO1xyXG4gICAgICAgICAgICBhZGRBY3Rpb24oJ2l0YWxpYycsICc8ZW0+JDE8L2VtPicpO1xyXG4gICAgICAgICAgICBhZGRBY3Rpb24oJ3N0cmlrZScsICc8ZGVsPiQxPC9kZWw+Jyk7XHJcbiAgICAgICAgICAgIGFkZEFjdGlvbignYmxvY2txdW90ZScsICc8YmxvY2txdW90ZT48cD4kMTwvcD48L2Jsb2NrcXVvdGU+JywgJ3JlcGxhY2VMaW5lJyk7XHJcbiAgICAgICAgICAgIGFkZEFjdGlvbignbGluaycsICc8YSBocmVmPVwiaHR0cDovL1wiPiQxPC9hPicpO1xyXG4gICAgICAgICAgICBhZGRBY3Rpb24oJ2ltYWdlJywgJzxpbWcgc3JjPVwiaHR0cDovL1wiIGFsdD1cIiQxXCI+Jyk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbGlzdGZuID0gZnVuY3Rpb24odGFnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmdldEN1cnNvck1vZGUoKSA9PSAnaHRtbCcpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGFnID0gdGFnIHx8ICd1bCc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjbSAgICAgICAgPSBlZGl0b3IuZWRpdG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MgICAgICAgPSBjbS5nZXREb2MoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zICAgICAgID0gZG9jLmdldEN1cnNvcih0cnVlKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zZW5kICAgID0gZG9jLmdldEN1cnNvcihmYWxzZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltICAgICAgICA9IENvZGVNaXJyb3IuaW5uZXJNb2RlKGNtLmdldE1vZGUoKSwgY20uZ2V0VG9rZW5BdChjbS5nZXRDdXJzb3IoKSkuc3RhdGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkxpc3QgICAgPSBpbSAmJiBpbS5zdGF0ZSAmJiBpbS5zdGF0ZS5jb250ZXh0ICYmIFsndWwnLCdvbCddLmluZGV4T2YoaW0uc3RhdGUuY29udGV4dC50YWdOYW1lKSAhPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaT1wb3MubGluZTsgaTwocG9zZW5kLmxpbmUrMSk7aSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZSgnPGxpPicrY20uZ2V0TGluZShpKSsnPC9saT4nLCB7IGxpbmU6IGksIGNoOiAwIH0sIHsgbGluZTogaSwgY2g6IGNtLmdldExpbmUoaSkubGVuZ3RoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbkxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKCc8Jyt0YWcrJz4nK1wiXFxuXCIrY20uZ2V0TGluZShwb3MubGluZSksIHsgbGluZTogcG9zLmxpbmUsIGNoOiAwIH0sIHsgbGluZTogcG9zLmxpbmUsIGNoOiBjbS5nZXRMaW5lKHBvcy5saW5lKS5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZShjbS5nZXRMaW5lKChwb3NlbmQubGluZSsxKSkrXCJcXG5cIisnPC8nK3RhZysnPicsIHsgbGluZTogKHBvc2VuZC5saW5lKzEpLCBjaDogMCB9LCB7IGxpbmU6IChwb3NlbmQubGluZSsxKSwgY2g6IGNtLmdldExpbmUoKHBvc2VuZC5saW5lKzEpKS5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNtLnNldEN1cnNvcih7IGxpbmU6IHBvc2VuZC5saW5lKzEsIGNoOiBjbS5nZXRMaW5lKHBvc2VuZC5saW5lKzEpLmxlbmd0aCB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbS5zZXRDdXJzb3IoeyBsaW5lOiBwb3NlbmQubGluZSwgY2g6IGNtLmdldExpbmUocG9zZW5kLmxpbmUpLmxlbmd0aCB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNtLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBlZGl0b3Iub24oJ2FjdGlvbi5saXN0VWwnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGxpc3RmbigndWwnKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBlZGl0b3Iub24oJ2FjdGlvbi5saXN0T2wnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGxpc3Rmbignb2wnKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBlZGl0b3IuaHRtbGVkaXRvci5vbignY2xpY2snLCAnYVtkYXRhLWh0bWxlZGl0b3ItYnV0dG9uPVwiZnVsbHNjcmVlblwiXScsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGVkaXRvci5odG1sZWRpdG9yLnRvZ2dsZUNsYXNzKCd1ay1odG1sZWRpdG9yLWZ1bGxzY3JlZW4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgd3JhcCA9IGVkaXRvci5lZGl0b3IuZ2V0V3JhcHBlckVsZW1lbnQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLmh0bWxlZGl0b3IuaGFzQ2xhc3MoJ3VrLWh0bWxlZGl0b3ItZnVsbHNjcmVlbicpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaXhlZFBhcmVudCA9IGZhbHNlLCBwYXJlbnRzID0gZWRpdG9yLmh0bWxlZGl0b3IucGFyZW50cygpLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFVJLiQodGhpcykuY3NzKCdwb3NpdGlvbicpPT0nZml4ZWQnICYmICFVSS4kKHRoaXMpLmlzKCdodG1sJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkUGFyZW50ID0gVUkuJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IuaHRtbGVkaXRvci5kYXRhKCdmaXhlZFBhcmVudHMnLCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXhlZFBhcmVudCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zZm9ybWVkID0gW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXhlZFBhcmVudCA9IGZpeGVkUGFyZW50LnBhcmVudCgpLmZpbmQocGFyZW50cykuZWFjaChmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChVSS4kKHRoaXMpLmNzcygndHJhbnNmb3JtJykgIT0gJ25vbmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtZWQucHVzaChVSS4kKHRoaXMpLmRhdGEoJ3RyYW5zZm9ybS1yZXNldCcsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IHRoaXMuc3R5bGUudHJhbnNmb3JtLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiB0aGlzLnN0eWxlLndlYmtpdFRyYW5zZm9ybSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNpdGlvbic6dGhpcy5zdHlsZS53ZWJraXRUcmFuc2l0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbic6dGhpcy5zdHlsZS50cmFuc2l0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdub25lJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNmb3JtJzogJ25vbmUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJzonbm9uZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uJzonbm9uZSdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmh0bWxlZGl0b3IuZGF0YSgnZml4ZWRQYXJlbnRzJywgdHJhbnNmb3JtZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmVkaXRvci5zdGF0ZS5mdWxsU2NyZWVuUmVzdG9yZSA9IHtzY3JvbGxUb3A6IHdpbmRvdy5wYWdlWU9mZnNldCwgc2Nyb2xsTGVmdDogd2luZG93LnBhZ2VYT2Zmc2V0LCB3aWR0aDogd3JhcC5zdHlsZS53aWR0aCwgaGVpZ2h0OiB3cmFwLnN0eWxlLmhlaWdodH07XHJcbiAgICAgICAgICAgICAgICAgICAgd3JhcC5zdHlsZS53aWR0aCAgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB3cmFwLnN0eWxlLmhlaWdodCA9IGVkaXRvci5jb250ZW50LmhlaWdodCgpKydweCc7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSBlZGl0b3IuZWRpdG9yLnN0YXRlLmZ1bGxTY3JlZW5SZXN0b3JlO1xyXG4gICAgICAgICAgICAgICAgICAgIHdyYXAuc3R5bGUud2lkdGggPSBpbmZvLndpZHRoOyB3cmFwLnN0eWxlLmhlaWdodCA9IGluZm8uaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbyhpbmZvLnNjcm9sbExlZnQsIGluZm8uc2Nyb2xsVG9wKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRvci5odG1sZWRpdG9yLmRhdGEoJ2ZpeGVkUGFyZW50cycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvci5odG1sZWRpdG9yLmRhdGEoJ2ZpeGVkUGFyZW50cycpLmZvckVhY2goZnVuY3Rpb24ocGFyZW50KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jc3MocGFyZW50LmRhdGEoJ3RyYW5zZm9ybS1yZXNldCcpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmZpdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIFVJLiR3aW4udHJpZ2dlcigncmVzaXplJyk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZWRpdG9yLmFkZFNob3J0Y3V0KFsnQ3RybC1TJywgJ0NtZC1TJ10sIGZ1bmN0aW9uKCkgeyBlZGl0b3IuZWxlbWVudC50cmlnZ2VyKCdodG1sZWRpdG9yLXNhdmUnLCBbZWRpdG9yXSk7IH0pO1xyXG4gICAgICAgICAgICBlZGl0b3IuYWRkU2hvcnRjdXRBY3Rpb24oJ2JvbGQnLCBbJ0N0cmwtQicsICdDbWQtQiddKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZEFjdGlvbihuYW1lLCByZXBsYWNlLCBtb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iub24oJ2FjdGlvbi4nK25hbWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZ2V0Q3Vyc29yTW9kZSgpID09ICdodG1sJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3JbbW9kZSA9PSAncmVwbGFjZUxpbmUnID8gJ3JlcGxhY2VMaW5lJyA6ICdyZXBsYWNlU2VsZWN0aW9uJ10ocmVwbGFjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBVSS5wbHVnaW4oJ2h0bWxlZGl0b3InLCAnbWFya2Rvd24nLCB7XHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGVkaXRvcikge1xyXG5cclxuICAgICAgICAgICAgdmFyIHBhcnNlciA9IGVkaXRvci5vcHRpb25zLm1kcGFyc2VyIHx8IHdpbmRvdy5tYXJrZWQgfHwgbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmICghcGFyc2VyKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBpZiAoZWRpdG9yLm9wdGlvbnMubWFya2Rvd24pIHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZU1hcmtkb3duKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZEFjdGlvbignYm9sZCcsICcqKiQxKionKTtcclxuICAgICAgICAgICAgYWRkQWN0aW9uKCdpdGFsaWMnLCAnKiQxKicpO1xyXG4gICAgICAgICAgICBhZGRBY3Rpb24oJ3N0cmlrZScsICd+fiQxfn4nKTtcclxuICAgICAgICAgICAgYWRkQWN0aW9uKCdibG9ja3F1b3RlJywgJz4gJDEnLCAncmVwbGFjZUxpbmUnKTtcclxuICAgICAgICAgICAgYWRkQWN0aW9uKCdsaW5rJywgJ1skMV0oaHR0cDovLyknKTtcclxuICAgICAgICAgICAgYWRkQWN0aW9uKCdpbWFnZScsICchWyQxXShodHRwOi8vKScpO1xyXG5cclxuICAgICAgICAgICAgZWRpdG9yLm9uKCdhY3Rpb24ubGlzdFVsJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5nZXRDdXJzb3JNb2RlKCkgPT0gJ21hcmtkb3duJykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY20gICAgICA9IGVkaXRvci5lZGl0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyAgICAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IodHJ1ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2VuZCAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IoZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPXBvcy5saW5lOyBpPChwb3NlbmQubGluZSsxKTtpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKCcqICcrY20uZ2V0TGluZShpKSwgeyBsaW5lOiBpLCBjaDogMCB9LCB7IGxpbmU6IGksIGNoOiBjbS5nZXRMaW5lKGkpLmxlbmd0aCB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNtLnNldEN1cnNvcih7IGxpbmU6IHBvc2VuZC5saW5lLCBjaDogY20uZ2V0TGluZShwb3NlbmQubGluZSkubGVuZ3RoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNtLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZWRpdG9yLm9uKCdhY3Rpb24ubGlzdE9sJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5nZXRDdXJzb3JNb2RlKCkgPT0gJ21hcmtkb3duJykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY20gICAgICA9IGVkaXRvci5lZGl0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyAgICAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IodHJ1ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2VuZCAgPSBjbS5nZXREb2MoKS5nZXRDdXJzb3IoZmFsc2UpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVmaXggID0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcy5saW5lID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmxpbmUgPSBjbS5nZXRMaW5lKHBvcy5saW5lLTEpLCBtYXRjaGVzO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYobWF0Y2hlcyA9IHByZXZsaW5lLm1hdGNoKC9eKFxcZCspXFwuLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpeCA9IE51bWJlcihtYXRjaGVzWzFdKSsxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPXBvcy5saW5lOyBpPChwb3NlbmQubGluZSsxKTtpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY20ucmVwbGFjZVJhbmdlKHByZWZpeCsnLiAnK2NtLmdldExpbmUoaSksIHsgbGluZTogaSwgY2g6IDAgfSwgeyBsaW5lOiBpLCBjaDogY20uZ2V0TGluZShpKS5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpeCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY20uc2V0Q3Vyc29yKHsgbGluZTogcG9zZW5kLmxpbmUsIGNoOiBjbS5nZXRMaW5lKHBvc2VuZC5saW5lKS5sZW5ndGggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY20uZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBlZGl0b3Iub24oJ3JlbmRlckxhdGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZWRpdG9yLm9wdGlvbnMubW9kZSA9PSAnZ2ZtJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5jdXJyZW50dmFsdWUgPSBwYXJzZXIoZWRpdG9yLmN1cnJlbnR2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZWRpdG9yLm9uKCdjdXJzb3JNb2RlJywgZnVuY3Rpb24oZSwgcGFyYW0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZWRpdG9yLm9wdGlvbnMubW9kZSA9PSAnZ2ZtJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3MgPSBlZGl0b3IuZWRpdG9yLmdldERvYygpLmdldEN1cnNvcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZWRpdG9yLmVkaXRvci5nZXRUb2tlbkF0KHBvcykuc3RhdGUuYmFzZS5odG1sU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0ubW9kZSA9ICdtYXJrZG93bic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIFVJLiQuZXh0ZW5kKGVkaXRvciwge1xyXG5cclxuICAgICAgICAgICAgICAgIGVuYWJsZU1hcmtkb3duOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbmFibGVNYXJrZG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZGlzYWJsZU1hcmtkb3duOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5zZXRPcHRpb24oJ21vZGUnLCAnaHRtbG1peGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5odG1sZWRpdG9yLmZpbmQoJy51ay1odG1sZWRpdG9yLWJ1dHRvbi1jb2RlIGEnKS5odG1sKHRoaXMub3B0aW9ucy5sYmxDb2Rldmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gc3dpdGNoIG1hcmtkb3duIG1vZGUgb24gZXZlbnRcclxuICAgICAgICAgICAgZWRpdG9yLm9uKHtcclxuICAgICAgICAgICAgICAgIGVuYWJsZU1hcmtkb3duICA6IGZ1bmN0aW9uKCkgeyBlZGl0b3IuZW5hYmxlTWFya2Rvd24oKTsgfSxcclxuICAgICAgICAgICAgICAgIGRpc2FibGVNYXJrZG93biA6IGZ1bmN0aW9uKCkgeyBlZGl0b3IuZGlzYWJsZU1hcmtkb3duKCk7IH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBlbmFibGVNYXJrZG93bigpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5lZGl0b3Iuc2V0T3B0aW9uKCdtb2RlJywgJ2dmbScpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLmh0bWxlZGl0b3IuZmluZCgnLnVrLWh0bWxlZGl0b3ItYnV0dG9uLWNvZGUgYScpLmh0bWwoZWRpdG9yLm9wdGlvbnMubGJsTWFya2Vkdmlldyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZEFjdGlvbihuYW1lLCByZXBsYWNlLCBtb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iub24oJ2FjdGlvbi4nK25hbWUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlZGl0b3IuZ2V0Q3Vyc29yTW9kZSgpID09ICdtYXJrZG93bicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yW21vZGUgPT0gJ3JlcGxhY2VMaW5lJyA/ICdyZXBsYWNlTGluZScgOiAncmVwbGFjZVNlbGVjdGlvbiddKHJlcGxhY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIFVJLmh0bWxlZGl0b3I7XHJcbn0pOyJdfQ==
