!function(i){var t;window.UIkit2&&(t=i(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-lightbox",["uikit"],function(){return t||i(UIkit2)})}(function(g){"use strict";var d,r={};return g.component("lightbox",{defaults:{allowfullscreen:!0,duration:400,group:!1,keyboard:!0},index:0,items:!1,boot:function(){g.$html.on("click","[data-uk-lightbox]",function(i){i.preventDefault();var t=g.$(this);t.data("lightbox")||g.lightbox(t,g.Utils.options(t.attr("data-uk-lightbox"))),t.data("lightbox").show(t)}),g.$doc.on("keyup",function(i){if(d&&d.is(":visible")&&d.lightbox.options.keyboard)switch(i.preventDefault(),i.keyCode){case 37:d.lightbox.previous();break;case 39:d.lightbox.next()}})},init:function(){var t=[];if(this.index=0,this.siblings=[],this.element&&this.element.length){var i=this.options.group?g.$('[data-uk-lightbox*="'+this.options.group+'"]'):this.element;i.each(function(){var i=g.$(this);t.push({source:i.attr("href"),title:i.attr("data-title")||i.attr("title"),type:i.attr("data-lightbox-type")||"auto",link:i})}),this.index=i.index(this.element),this.siblings=t}else this.options.group&&this.options.group.length&&(this.siblings=this.options.group);this.trigger("lightbox-init",[this])},show:function(e){this.modal=function(i){if(d)return d.lightbox=i,d;(d=g.$(['<div class="uk-modal">','<div class="uk-modal-dialog uk-modal-dialog-lightbox uk-slidenav-position" style="margin-left:auto;margin-right:auto;width:200px;height:200px;top:'+Math.abs(window.innerHeight/2-200)+'px;">','<a href="#" class="uk-modal-close uk-close uk-close-alt"></a>','<div class="uk-lightbox-content"></div>','<div class="uk-modal-spinner uk-hidden"></div>',"</div>","</div>"].join("")).appendTo("body")).dialog=d.find(".uk-modal-dialog:first"),d.content=d.find(".uk-lightbox-content:first"),d.loader=d.find(".uk-modal-spinner:first"),d.closer=d.find(".uk-close.uk-close-alt"),d.modal=g.modal(d,{modal:!1}),d.on("swipeRight swipeLeft",function(i){d.lightbox["swipeLeft"==i.type?"next":"previous"]()}).on("click","[data-lightbox-previous], [data-lightbox-next]",function(i){i.preventDefault(),d.lightbox[g.$(this).is("[data-lightbox-next]")?"next":"previous"]()}),d.on("hide.uk.modal",function(i){d.content.html("")});var t={w:window.innerWidth,h:window.innerHeight};return g.$win.on("load resize orientationchange",g.Utils.debounce(function(i){t.w!==window.innerWidth&&d.is(":visible")&&!g.Utils.isFullscreen()&&d.lightbox.fitSize(),t={w:window.innerWidth,h:window.innerHeight}},100)),d.lightbox=i,d}(this),this.modal.dialog.stop(),this.modal.content.stop();var i,t,o=this,n=g.$.Deferred();"object"==typeof(e=e||0)&&this.siblings.forEach(function(i,t){e[0]===i.link[0]&&(e=t)}),e<0?e=this.siblings.length-e:this.siblings[e]||(e=0),t=this.siblings[e],i={lightbox:o,source:t.source,type:t.type,index:e,promise:n,title:t.title,item:t,meta:{content:"",width:null,height:null}},this.index=e,this.modal.content.empty(),this.modal.is(":visible")||(this.modal.content.css({width:"",height:""}).empty(),this.modal.modal.show()),this.modal.loader.removeClass("uk-hidden"),n.promise().done(function(){o.data=i,o.fitSize(i)}).fail(function(){i.meta.content='<div class="uk-position-cover uk-flex uk-flex-middle uk-flex-center"><strong>Loading resource failed!</strong></div>',i.meta.width=400,i.meta.height=300,o.data=i,o.fitSize(i)}),o.trigger("showitem.uk.lightbox",[i])},fitSize:function(){var i=this,t=this.data,e=this.modal.dialog.outerWidth()-this.modal.dialog.width(),o=parseInt(this.modal.dialog.css("margin-top"),10)+parseInt(this.modal.dialog.css("margin-bottom"),10),n=t.meta.content,s=i.options.duration;1<this.siblings.length&&(n=[n,'<a href="#" class="uk-slidenav uk-slidenav-contrast uk-slidenav-previous uk-hidden-touch" data-lightbox-previous></a>','<a href="#" class="uk-slidenav uk-slidenav-contrast uk-slidenav-next uk-hidden-touch" data-lightbox-next></a>'].join(""));var h,a,l=g.$("<div>&nbsp;</div>").css({opacity:0,position:"absolute",top:0,left:0,width:"100%",maxWidth:i.modal.dialog.css("max-width"),padding:i.modal.dialog.css("padding"),margin:i.modal.dialog.css("margin")}),d=t.meta.width,r=t.meta.height;l.appendTo("body").width(),h=l.width(),a=window.innerHeight-o,l.remove(),this.modal.dialog.find(".uk-modal-caption").remove(),t.title&&(this.modal.dialog.append('<div class="uk-modal-caption">'+t.title+"</div>"),a-=this.modal.dialog.find(".uk-modal-caption").outerHeight()),h<t.meta.width&&(r=Math.floor(r*(h/d)),d=h),a<r&&(r=Math.floor(a),d=Math.ceil(t.meta.width*(a/t.meta.height))),this.modal.content.css("opacity",0).width(d).html(n),"iframe"==t.type&&this.modal.content.find("iframe:first").height(r);var u=r+e,c=Math.floor(window.innerHeight/2-u/2)-o;c<0&&(c=0),this.modal.closer.addClass("uk-hidden"),i.modal.data("mwidth")==d&&i.modal.data("mheight")==r&&(s=0),this.modal.dialog.animate({width:d+e,height:r+e,top:c},s,"swing",function(){i.modal.loader.addClass("uk-hidden"),i.modal.content.css({width:""}).animate({opacity:1},function(){i.modal.closer.removeClass("uk-hidden")}),i.modal.data({mwidth:d,mheight:r})})},next:function(){this.show(this.siblings[this.index+1]?this.index+1:0)},previous:function(){this.show(this.siblings[this.index-1]?this.index-1:this.siblings.length-1)}}),g.plugin("lightbox","image",{init:function(i){i.on("showitem.uk.lightbox",function(i,o){if("image"==o.type||o.source&&o.source.match(/\.(jpg|jpeg|png|gif|svg)$/i)){var t=function(i,t,e){o.meta={content:'<img class="uk-responsive-width" width="'+t+'" height="'+e+'" src ="'+i+'">',width:t,height:e},o.type="image",o.promise.resolve()};if(r[o.source])t(o.source,r[o.source].width,r[o.source].height);else{var e=new Image;e.onerror=function(){o.promise.reject("Loading image failed")},e.onload=function(){r[o.source]={width:e.width,height:e.height},t(o.source,r[o.source].width,r[o.source].height)},e.src=o.source}}})}}),g.plugin("lightbox","youtube",{init:function(i){var a=/(\/\/.*?youtube\.[a-z]+)\/watch\?v=([^&]+)&?(.*)/,l=/youtu\.be\/(.*)/;i.on("showitem.uk.lightbox",function(i,o){var t,e,n=function(i,t,e){o.meta={content:'<iframe src="//www.youtube.com/embed/'+i+'" width="'+t+'" height="'+e+'" style="max-width:100%;"'+(d.lightbox.options.allowfullscreen?" allowfullscreen":"")+"></iframe>",width:t,height:e},o.type="iframe",o.promise.resolve()};if((e=o.source.match(a))&&(t=e[2]),(e=o.source.match(l))&&(t=e[1]),t){if(r[t])n(t,r[t].width,r[t].height);else{var s=new Image,h=!1;s.onerror=function(){r[t]={width:640,height:320},n(t,r[t].width,r[t].height)},s.onload=function(){120==s.width&&90==s.height?h?(r[t]={width:640,height:320},n(t,r[t].width,r[t].height)):(h=!0,s.src="//img.youtube.com/vi/"+t+"/0.jpg"):(r[t]={width:s.width,height:s.height},n(t,s.width,s.height))},s.src="//img.youtube.com/vi/"+t+"/maxresdefault.jpg"}i.stopImmediatePropagation()}})}}),g.plugin("lightbox","vimeo",{init:function(i){var n,s=/(\/\/.*?)vimeo\.[a-z]+\/([0-9]+).*?/;i.on("showitem.uk.lightbox",function(i,o){var t,e=function(i,t,e){o.meta={content:'<iframe src="//player.vimeo.com/video/'+i+'" width="'+t+'" height="'+e+'" style="width:100%;box-sizing:border-box;"'+(d.lightbox.options.allowfullscreen?" allowfullscreen":"")+"></iframe>",width:t,height:e},o.type="iframe",o.promise.resolve()};(n=o.source.match(s))&&(t=n[2],r[t]?e(t,r[t].width,r[t].height):g.$.ajax({type:"GET",url:"//vimeo.com/api/oembed.json?url="+encodeURI(o.source),jsonp:"callback",dataType:"jsonp",success:function(i){r[t]={width:i.width,height:i.height},e(t,r[t].width,r[t].height)}}),i.stopImmediatePropagation())})}}),g.plugin("lightbox","video",{init:function(i){i.on("showitem.uk.lightbox",function(i,o){var t=function(i,t,e){o.meta={content:'<video class="uk-responsive-width" src="'+i+'" width="'+t+'" height="'+e+'" controls></video>',width:t,height:e},o.type="video",o.promise.resolve()};if("video"==o.type||o.source.match(/\.(mp4|webm|ogv)$/i))if(r[o.source])t(o.source,r[o.source].width,r[o.source].height);else var e=g.$('<video style="position:fixed;visibility:hidden;top:-10000px;"></video>').attr("src",o.source).appendTo("body"),n=setInterval(function(){e[0].videoWidth&&(clearInterval(n),r[o.source]={width:e[0].videoWidth,height:e[0].videoHeight},t(o.source,r[o.source].width,r[o.source].height),e.remove())},20)})}}),g.plugin("lightbox","iframe",{init:function(s){s.on("showitem.uk.lightbox",function(i,t){var e,o,n;("iframe"===t.type||t.source.match(/\.(html|php)$/))&&(e=t.source,o=s.options.width||800,n=s.options.height||600,t.meta={content:'<iframe class="uk-responsive-width" src="'+e+'" width="'+o+'" height="'+n+'"'+(d.lightbox.options.allowfullscreen?" allowfullscreen":"")+"></iframe>",width:o,height:n},t.type="iframe",t.promise.resolve())})}}),g.lightbox.create=function(i,t){if(i){var e=[];return i.forEach(function(i){e.push(g.$.extend({source:"",title:"",type:"auto",link:!1},"string"==typeof i?{source:i}:i))}),g.lightbox(g.$.extend({},t,{group:e}))}},g.lightbox});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvbGlnaHRib3guanMiXSwibmFtZXMiOlsiYWRkb24iLCJjb21wb25lbnQiLCJ3aW5kb3ciLCJVSWtpdDIiLCJkZWZpbmUiLCJhbWQiLCJVSSIsIm1vZGFsIiwiY2FjaGUiLCJkZWZhdWx0cyIsImFsbG93ZnVsbHNjcmVlbiIsImR1cmF0aW9uIiwiZ3JvdXAiLCJrZXlib2FyZCIsImluZGV4IiwiaXRlbXMiLCJib290IiwiJGh0bWwiLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImxpbmsiLCIkIiwidGhpcyIsImRhdGEiLCJsaWdodGJveCIsIlV0aWxzIiwib3B0aW9ucyIsImF0dHIiLCJzaG93IiwiJGRvYyIsImlzIiwia2V5Q29kZSIsInByZXZpb3VzIiwibmV4dCIsImluaXQiLCJzaWJsaW5ncyIsImVsZW1lbnQiLCJsZW5ndGgiLCJkb21TaWJsaW5ncyIsImVhY2giLCJlbGUiLCJwdXNoIiwic291cmNlIiwidGl0bGUiLCJ0eXBlIiwidHJpZ2dlciIsIk1hdGgiLCJhYnMiLCJpbm5lckhlaWdodCIsImpvaW4iLCJhcHBlbmRUbyIsImRpYWxvZyIsImZpbmQiLCJjb250ZW50IiwibG9hZGVyIiwiY2xvc2VyIiwiaHRtbCIsInJlc2l6ZUNhY2hlIiwidyIsImlubmVyV2lkdGgiLCJoIiwiJHdpbiIsImRlYm91bmNlIiwiaXNGdWxsc2NyZWVuIiwiZml0U2l6ZSIsImdldE1vZGFsIiwic3RvcCIsIml0ZW0iLCIkdGhpcyIsInByb21pc2UiLCJEZWZlcnJlZCIsImZvckVhY2giLCJzIiwiaWR4IiwibWV0YSIsIndpZHRoIiwiaGVpZ2h0IiwiZW1wdHkiLCJjc3MiLCJyZW1vdmVDbGFzcyIsImRvbmUiLCJmYWlsIiwicGFkIiwib3V0ZXJXaWR0aCIsImRwYWQiLCJwYXJzZUludCIsIm1heHdpZHRoIiwibWF4aGVpZ2h0IiwidG1wIiwib3BhY2l0eSIsInBvc2l0aW9uIiwidG9wIiwibGVmdCIsIm1heFdpZHRoIiwicGFkZGluZyIsIm1hcmdpbiIsInJlbW92ZSIsImFwcGVuZCIsIm91dGVySGVpZ2h0IiwiZmxvb3IiLCJjZWlsIiwiZGgiLCJ0IiwiYWRkQ2xhc3MiLCJhbmltYXRlIiwibXdpZHRoIiwibWhlaWdodCIsInBsdWdpbiIsIm1hdGNoIiwicmVzb2x2ZSIsImltZyIsIkltYWdlIiwib25lcnJvciIsInJlamVjdCIsIm9ubG9hZCIsInNyYyIsInlvdXR1YmVSZWdFeHAiLCJ5b3V0dWJlUmVnRXhwU2hvcnQiLCJpZCIsIm1hdGNoZXMiLCJsb3dyZXMiLCJzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24iLCJyZWdleCIsImFqYXgiLCJ1cmwiLCJlbmNvZGVVUkkiLCJqc29ucCIsImRhdGFUeXBlIiwic3VjY2VzcyIsInZpZCIsImlkbGUiLCJzZXRJbnRlcnZhbCIsInZpZGVvV2lkdGgiLCJjbGVhckludGVydmFsIiwidmlkZW9IZWlnaHQiLCJjcmVhdGUiLCJleHRlbmQiXSwibWFwcGluZ3MiOiJDQUNBLFNBQVVBLEdBRU4sSUFBSUMsRUFFQUMsT0FBT0MsU0FDUEYsRUFBWUQsRUFBTUcsU0FHRCxtQkFBVkMsUUFBd0JBLE9BQU9DLEtBQ3RDRCxPQUFPLGlCQUFrQixDQUFDLFNBQVUsV0FDaEMsT0FBT0gsR0FBYUQsRUFBTUcsVUFWdEMsQ0FjRyxTQUFTRyxHQUVSLGFBRUEsSUFBSUMsRUFBT0MsRUFBUSxHQXVqQm5CLE9BcmpCQUYsRUFBR0wsVUFBVSxXQUFZLENBRXJCUSxTQUFVLENBQ05DLGlCQUFrQixFQUNsQkMsU0FBa0IsSUFDbEJDLE9BQWtCLEVBQ2xCQyxVQUFrQixHQUd0QkMsTUFBUSxFQUNSQyxPQUFRLEVBRVJDLEtBQU0sV0FFRlYsRUFBR1csTUFBTUMsR0FBRyxRQUFTLHFCQUFzQixTQUFTQyxHQUVoREEsRUFBRUMsaUJBRUYsSUFBSUMsRUFBT2YsRUFBR2dCLEVBQUVDLE1BRVhGLEVBQUtHLEtBQUssYUFFWGxCLEVBQUdtQixTQUFTSixFQUFNZixFQUFHb0IsTUFBTUMsUUFBUU4sRUFBS08sS0FBSyxzQkFHakRQLEVB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QUdtQixTQUFTK0csT0FBUyxTQUFTekgsRUFBT1ksR0FFakMsR0FBS1osRUFBTCxDQUVBLElBQUlILEVBQVEsR0FjWixPQVpBRyxFQUFNeUQsUUFBUSxTQUFTSixHQUVuQnhELEVBQU04QixLQUFLcEMsRUFBR2dCLEVBQUVtSCxPQUFPLENBQ25COUYsT0FBUyxHQUNUQyxNQUFTLEdBQ1RDLEtBQVMsT0FDVHhCLE1BQVMsR0FDTyxpQkFBVixFQUFxQixDQUFDc0IsT0FBVXlCLEdBQVFBLE1BR2xEOUQsRUFBR21CLFNBQVNuQixFQUFHZ0IsRUFBRW1ILE9BQU8sR0FBSTlHLEVBQVMsQ0FBQ2YsTUFBUUEsT0FLL0NOLEVBQUdtQiIsImZpbGUiOiJjb21wb25lbnRzL2xpZ2h0Ym94LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIFVJa2l0IDIuMjcuMiB8IGh0dHA6Ly93d3cuZ2V0dWlraXQuY29tIHwgKGMpIDIwMTQgWU9PdGhlbWUgfCBNSVQgTGljZW5zZSAqL1xyXG4oZnVuY3Rpb24oYWRkb24pIHtcclxuXHJcbiAgICB2YXIgY29tcG9uZW50O1xyXG5cclxuICAgIGlmICh3aW5kb3cuVUlraXQyKSB7XHJcbiAgICAgICAgY29tcG9uZW50ID0gYWRkb24oVUlraXQyKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsgLy8gQU1EXHJcbiAgICAgICAgZGVmaW5lKCd1aWtpdC1saWdodGJveCcsIFsndWlraXQnXSwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudCB8fCBhZGRvbihVSWtpdDIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufSkoZnVuY3Rpb24oVUkpe1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBtb2RhbCwgY2FjaGUgPSB7fTtcclxuXHJcbiAgICBVSS5jb21wb25lbnQoJ2xpZ2h0Ym94Jywge1xyXG5cclxuICAgICAgICBkZWZhdWx0czoge1xyXG4gICAgICAgICAgICBhbGxvd2Z1bGxzY3JlZW4gOiB0cnVlLFxyXG4gICAgICAgICAgICBkdXJhdGlvbiAgICAgICAgOiA0MDAsXHJcbiAgICAgICAgICAgIGdyb3VwICAgICAgICAgICA6IGZhbHNlLFxyXG4gICAgICAgICAgICBrZXlib2FyZCAgICAgICAgOiB0cnVlXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaW5kZXggOiAwLFxyXG4gICAgICAgIGl0ZW1zIDogZmFsc2UsXHJcblxyXG4gICAgICAgIGJvb3Q6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgVUkuJGh0bWwub24oJ2NsaWNrJywgJ1tkYXRhLXVrLWxpZ2h0Ym94XScsIGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbGluayA9IFVJLiQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFsaW5rLmRhdGEoJ2xpZ2h0Ym94JykpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgVUkubGlnaHRib3gobGluaywgVUkuVXRpbHMub3B0aW9ucyhsaW5rLmF0dHIoJ2RhdGEtdWstbGlnaHRib3gnKSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxpbmsuZGF0YSgnbGlnaHRib3gnKS5zaG93KGxpbmspO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIGtleWJvYXJkIG5hdmlnYXRpb25cclxuICAgICAgICAgICAgVUkuJGRvYy5vbigna2V5dXAnLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1vZGFsICYmIG1vZGFsLmlzKCc6dmlzaWJsZScpICYmIG1vZGFsLmxpZ2h0Ym94Lm9wdGlvbnMua2V5Ym9hcmQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2goZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5saWdodGJveC5wcmV2aW91cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5saWdodGJveC5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHNpYmxpbmdzID0gW107XHJcblxyXG4gICAgICAgICAgICB0aGlzLmluZGV4ICAgID0gMDtcclxuICAgICAgICAgICAgdGhpcy5zaWJsaW5ncyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRvbVNpYmxpbmdzICA9IHRoaXMub3B0aW9ucy5ncm91cCA/IFVJLiQoJ1tkYXRhLXVrLWxpZ2h0Ym94Kj1cIicrdGhpcy5vcHRpb25zLmdyb3VwKydcIl0nKSA6IHRoaXMuZWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgICAgICBkb21TaWJsaW5ncy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlID0gVUkuJCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2libGluZ3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IGVsZS5hdHRyKCdocmVmJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlICA6IGVsZS5hdHRyKCdkYXRhLXRpdGxlJykgfHwgZWxlLmF0dHIoJ3RpdGxlJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgICA6IGVsZS5hdHRyKFwiZGF0YS1saWdodGJveC10eXBlXCIpIHx8ICdhdXRvJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGluayAgIDogZWxlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmluZGV4ICAgID0gZG9tU2libGluZ3MuaW5kZXgodGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2libGluZ3MgPSBzaWJsaW5ncztcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLmdyb3VwICYmIHRoaXMub3B0aW9ucy5ncm91cC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2libGluZ3MgPSB0aGlzLm9wdGlvbnMuZ3JvdXA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignbGlnaHRib3gtaW5pdCcsIFt0aGlzXSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgc2hvdzogZnVuY3Rpb24oaW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubW9kYWwgPSBnZXRNb2RhbCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHN0b3AgcHJldmlvdXMgYW5pbWF0aW9uXHJcbiAgICAgICAgICAgIHRoaXMubW9kYWwuZGlhbG9nLnN0b3AoKTtcclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5jb250ZW50LnN0b3AoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXMsIHByb21pc2UgPSBVSS4kLkRlZmVycmVkKCksIGRhdGEsIGl0ZW07XHJcblxyXG4gICAgICAgICAgICBpbmRleCA9IGluZGV4IHx8IDA7XHJcblxyXG4gICAgICAgICAgICAvLyBpbmRleCBpcyBhIGpRdWVyeSBvYmplY3Qgb3IgRE9NIGVsZW1lbnRcclxuICAgICAgICAgICAgaWYgKHR5cGVvZihpbmRleCkgPT0gJ29iamVjdCcpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNpYmxpbmdzLmZvckVhY2goZnVuY3Rpb24ocywgaWR4KXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4WzBdID09PSBzLmxpbmtbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBpZHg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGZpeCBpbmRleCBpZiBuZWVkZWRcclxuICAgICAgICAgICAgaWYgKCBpbmRleCA8IDAgKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IHRoaXMuc2libGluZ3MubGVuZ3RoIC0gaW5kZXg7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuc2libGluZ3NbaW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGl0ZW0gICA9IHRoaXMuc2libGluZ3NbaW5kZXhdO1xyXG5cclxuICAgICAgICAgICAgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGxpZ2h0Ym94IDogJHRoaXMsXHJcbiAgICAgICAgICAgICAgICBzb3VyY2UgICA6IGl0ZW0uc291cmNlLFxyXG4gICAgICAgICAgICAgICAgdHlwZSAgICAgOiBpdGVtLnR5cGUsXHJcbiAgICAgICAgICAgICAgICBpbmRleCAgICA6IGluZGV4LFxyXG4gICAgICAgICAgICAgICAgcHJvbWlzZSAgOiBwcm9taXNlLFxyXG4gICAgICAgICAgICAgICAgdGl0bGUgICAgOiBpdGVtLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgaXRlbSAgICAgOiBpdGVtLFxyXG4gICAgICAgICAgICAgICAgbWV0YSAgICAgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCA6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICAgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCAgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmNvbnRlbnQuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5tb2RhbC5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RhbC5jb250ZW50LmNzcyh7d2lkdGg6JycsIGhlaWdodDonJ30pLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLm1vZGFsLnNob3coKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5sb2FkZXIucmVtb3ZlQ2xhc3MoJ3VrLWhpZGRlbicpO1xyXG5cclxuICAgICAgICAgICAgcHJvbWlzZS5wcm9taXNlKCkuZG9uZShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICR0aGlzLmZpdFNpemUoZGF0YSk7XHJcblxyXG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgZGF0YS5tZXRhLmNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cInVrLXBvc2l0aW9uLWNvdmVyIHVrLWZsZXggdWstZmxleC1taWRkbGUgdWstZmxleC1jZW50ZXJcIj48c3Ryb25nPkxvYWRpbmcgcmVzb3VyY2UgZmFpbGVkITwvc3Ryb25nPjwvZGl2Pic7XHJcbiAgICAgICAgICAgICAgICBkYXRhLm1ldGEud2lkdGggICA9IDQwMDtcclxuICAgICAgICAgICAgICAgIGRhdGEubWV0YS5oZWlnaHQgID0gMzAwO1xyXG5cclxuICAgICAgICAgICAgICAgICR0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgJHRoaXMuZml0U2l6ZShkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCdzaG93aXRlbS51ay5saWdodGJveCcsIFtkYXRhXSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZml0U2l6ZTogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgJHRoaXMgICAgPSB0aGlzLFxyXG4gICAgICAgICAgICAgICAgZGF0YSAgICAgPSB0aGlzLmRhdGEsXHJcbiAgICAgICAgICAgICAgICBwYWQgICAgICA9IHRoaXMubW9kYWwuZGlhbG9nLm91dGVyV2lkdGgoKSAtIHRoaXMubW9kYWwuZGlhbG9nLndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICBkcGFkVG9wICA9IHBhcnNlSW50KHRoaXMubW9kYWwuZGlhbG9nLmNzcygnbWFyZ2luLXRvcCcpLCAxMCksXHJcbiAgICAgICAgICAgICAgICBkcGFkQm90ICA9IHBhcnNlSW50KHRoaXMubW9kYWwuZGlhbG9nLmNzcygnbWFyZ2luLWJvdHRvbScpLCAxMCksXHJcbiAgICAgICAgICAgICAgICBkcGFkICAgICA9IGRwYWRUb3AgKyBkcGFkQm90LFxyXG4gICAgICAgICAgICAgICAgY29udGVudCAgPSBkYXRhLm1ldGEuY29udGVudCxcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gJHRoaXMub3B0aW9ucy5kdXJhdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNpYmxpbmdzLmxlbmd0aCA+IDEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJ1ay1zbGlkZW5hdiB1ay1zbGlkZW5hdi1jb250cmFzdCB1ay1zbGlkZW5hdi1wcmV2aW91cyB1ay1oaWRkZW4tdG91Y2hcIiBkYXRhLWxpZ2h0Ym94LXByZXZpb3VzPjwvYT4nLFxyXG4gICAgICAgICAgICAgICAgICAgICc8YSBocmVmPVwiI1wiIGNsYXNzPVwidWstc2xpZGVuYXYgdWstc2xpZGVuYXYtY29udHJhc3QgdWstc2xpZGVuYXYtbmV4dCB1ay1oaWRkZW4tdG91Y2hcIiBkYXRhLWxpZ2h0Ym94LW5leHQ+PC9hPidcclxuICAgICAgICAgICAgICAgIF0uam9pbignJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSB3aWR0aFxyXG4gICAgICAgICAgICB2YXIgdG1wID0gVUkuJCgnPGRpdj4mbmJzcDs8L2Rpdj4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eSAgIDogMCxcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uICA6ICdhYnNvbHV0ZScsXHJcbiAgICAgICAgICAgICAgICB0b3AgICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgbGVmdCAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgIHdpZHRoICAgICA6ICcxMDAlJyxcclxuICAgICAgICAgICAgICAgIG1heFdpZHRoICA6ICR0aGlzLm1vZGFsLmRpYWxvZy5jc3MoJ21heC13aWR0aCcpLFxyXG4gICAgICAgICAgICAgICAgcGFkZGluZyAgIDogJHRoaXMubW9kYWwuZGlhbG9nLmNzcygncGFkZGluZycpLFxyXG4gICAgICAgICAgICAgICAgbWFyZ2luICAgIDogJHRoaXMubW9kYWwuZGlhbG9nLmNzcygnbWFyZ2luJylcclxuICAgICAgICAgICAgfSksIG1heHdpZHRoLCBtYXhoZWlnaHQsIHcgPSBkYXRhLm1ldGEud2lkdGgsIGggPSBkYXRhLm1ldGEuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgdG1wLmFwcGVuZFRvKCdib2R5Jykud2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIG1heHdpZHRoICA9IHRtcC53aWR0aCgpO1xyXG4gICAgICAgICAgICBtYXhoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBkcGFkO1xyXG5cclxuICAgICAgICAgICAgdG1wLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5kaWFsb2cuZmluZCgnLnVrLW1vZGFsLWNhcHRpb24nKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChkYXRhLnRpdGxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmRpYWxvZy5hcHBlbmQoJzxkaXYgY2xhc3M9XCJ1ay1tb2RhbC1jYXB0aW9uXCI+JytkYXRhLnRpdGxlKyc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgIG1heGhlaWdodCAtPSB0aGlzLm1vZGFsLmRpYWxvZy5maW5kKCcudWstbW9kYWwtY2FwdGlvbicpLm91dGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChtYXh3aWR0aCA8IGRhdGEubWV0YS53aWR0aCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGggPSBNYXRoLmZsb29yKCBoICogKG1heHdpZHRoIC8gdykgKTtcclxuICAgICAgICAgICAgICAgIHcgPSBtYXh3aWR0aDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG1heGhlaWdodCA8IGgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBoID0gTWF0aC5mbG9vcihtYXhoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgdyA9IE1hdGguY2VpbChkYXRhLm1ldGEud2lkdGggKiAobWF4aGVpZ2h0L2RhdGEubWV0YS5oZWlnaHQpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5jb250ZW50LmNzcygnb3BhY2l0eScsIDApLndpZHRoKHcpLmh0bWwoY29udGVudCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YS50eXBlID09ICdpZnJhbWUnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmNvbnRlbnQuZmluZCgnaWZyYW1lOmZpcnN0JykuaGVpZ2h0KGgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZGggICA9IGggKyBwYWQsXHJcbiAgICAgICAgICAgICAgICB0ICAgID0gTWF0aC5mbG9vcih3aW5kb3cuaW5uZXJIZWlnaHQvMiAtIGRoLzIpIC0gZHBhZDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0IDwgMCkgeyB0ID0gMDsgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RhbC5jbG9zZXIuYWRkQ2xhc3MoJ3VrLWhpZGRlbicpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCR0aGlzLm1vZGFsLmRhdGEoJ213aWR0aCcpID09IHcgJiYgICR0aGlzLm1vZGFsLmRhdGEoJ21oZWlnaHQnKSA9PSBoKSB7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMubW9kYWwuZGlhbG9nLmFuaW1hdGUoe3dpZHRoOiB3ICsgcGFkLCBoZWlnaHQ6IGggKyBwYWQsIHRvcDogdCB9LCBkdXJhdGlvbiwgJ3N3aW5nJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5tb2RhbC5sb2FkZXIuYWRkQ2xhc3MoJ3VrLWhpZGRlbicpO1xyXG4gICAgICAgICAgICAgICAgJHRoaXMubW9kYWwuY29udGVudC5jc3Moe3dpZHRoOicnfSkuYW5pbWF0ZSh7b3BhY2l0eTogMX0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLm1vZGFsLmNsb3Nlci5yZW1vdmVDbGFzcygndWstaGlkZGVuJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkdGhpcy5tb2RhbC5kYXRhKHttd2lkdGg6IHcsIG1oZWlnaHQ6IGh9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdyh0aGlzLnNpYmxpbmdzWyh0aGlzLmluZGV4KzEpXSA/ICh0aGlzLmluZGV4KzEpIDogMCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcHJldmlvdXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3codGhpcy5zaWJsaW5nc1sodGhpcy5pbmRleC0xKV0gPyAodGhpcy5pbmRleC0xKSA6IHRoaXMuc2libGluZ3MubGVuZ3RoLTEpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLyBQbHVnaW5zXHJcblxyXG4gICAgVUkucGx1Z2luKCdsaWdodGJveCcsICdpbWFnZScsIHtcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24obGlnaHRib3gpIHtcclxuXHJcbiAgICAgICAgICAgIGxpZ2h0Ym94Lm9uKCdzaG93aXRlbS51ay5saWdodGJveCcsIGZ1bmN0aW9uKGUsIGRhdGEpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnR5cGUgPT0gJ2ltYWdlJyB8fCBkYXRhLnNvdXJjZSAmJiBkYXRhLnNvdXJjZS5tYXRjaCgvXFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8c3ZnKSQvaSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc29sdmUgPSBmdW5jdGlvbihzb3VyY2UsIHdpZHRoLCBoZWlnaHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubWV0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgOiAnPGltZyBjbGFzcz1cInVrLXJlc3BvbnNpdmUtd2lkdGhcIiB3aWR0aD1cIicrd2lkdGgrJ1wiIGhlaWdodD1cIicraGVpZ2h0KydcIiBzcmMgPVwiJytzb3VyY2UrJ1wiPicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCAgIDogd2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgIDogaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnR5cGUgPSAnaW1hZ2UnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNhY2hlW2RhdGEuc291cmNlXSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1nLm9uZXJyb3IgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wcm9taXNlLnJlamVjdCgnTG9hZGluZyBpbWFnZSBmYWlsZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVbZGF0YS5zb3VyY2VdID0ge3dpZHRoOiBpbWcud2lkdGgsIGhlaWdodDogaW1nLmhlaWdodH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEuc291cmNlLCBjYWNoZVtkYXRhLnNvdXJjZV0ud2lkdGgsIGNhY2hlW2RhdGEuc291cmNlXS5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9IGRhdGEuc291cmNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEuc291cmNlLCBjYWNoZVtkYXRhLnNvdXJjZV0ud2lkdGgsIGNhY2hlW2RhdGEuc291cmNlXS5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgVUkucGx1Z2luKCdsaWdodGJveCcsICd5b3V0dWJlJywge1xyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihsaWdodGJveCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHlvdXR1YmVSZWdFeHAgPSAvKFxcL1xcLy4qP3lvdXR1YmVcXC5bYS16XSspXFwvd2F0Y2hcXD92PShbXiZdKykmPyguKikvLFxyXG4gICAgICAgICAgICAgICAgeW91dHViZVJlZ0V4cFNob3J0ID0gL3lvdXR1XFwuYmVcXC8oLiopLztcclxuXHJcblxyXG4gICAgICAgICAgICBsaWdodGJveC5vbignc2hvd2l0ZW0udWsubGlnaHRib3gnLCBmdW5jdGlvbihlLCBkYXRhKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaWQsIG1hdGNoZXMsIHJlc29sdmUgPSBmdW5jdGlvbihpZCwgd2lkdGgsIGhlaWdodCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm1ldGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICc8aWZyYW1lIHNyYz1cIi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkLycraWQrJ1wiIHdpZHRoPVwiJyt3aWR0aCsnXCIgaGVpZ2h0PVwiJytoZWlnaHQrJ1wiIHN0eWxlPVwibWF4LXdpZHRoOjEwMCU7XCInKyhtb2RhbC5saWdodGJveC5vcHRpb25zLmFsbG93ZnVsbHNjcmVlbj8nIGFsbG93ZnVsbHNjcmVlbic6JycpKyc+PC9pZnJhbWU+JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudHlwZSA9ICdpZnJhbWUnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlcyA9IGRhdGEuc291cmNlLm1hdGNoKHlvdXR1YmVSZWdFeHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBtYXRjaGVzWzJdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzID0gZGF0YS5zb3VyY2UubWF0Y2goeW91dHViZVJlZ0V4cFNob3J0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gbWF0Y2hlc1sxXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaWQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWNhY2hlW2lkXSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpLCBsb3dyZXMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5vbmVycm9yID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlW2lkXSA9IHt3aWR0aDo2NDAsIGhlaWdodDozMjB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpZCwgY2FjaGVbaWRdLndpZHRoLCBjYWNoZVtpZF0uaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy95b3V0dWJlIGRlZmF1bHQgNDA0IHRodW1iLCBmYWxsIGJhY2sgdG8gbG93cmVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW1nLndpZHRoID09IDEyMCAmJiBpbWcuaGVpZ2h0ID09IDkwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsb3dyZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG93cmVzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9ICcvL2ltZy55b3V0dWJlLmNvbS92aS8nICsgaWQgKyAnLzAuanBnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZVtpZF0gPSB7d2lkdGg6IDY0MCwgaGVpZ2h0OiAzMjB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGlkLCBjYWNoZVtpZF0ud2lkdGgsIGNhY2hlW2lkXS5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVbaWRdID0ge3dpZHRoOiBpbWcud2lkdGgsIGhlaWdodDogaW1nLmhlaWdodH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpZCwgaW1nLndpZHRoLCBpbWcuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSAnLy9pbWcueW91dHViZS5jb20vdmkvJytpZCsnL21heHJlc2RlZmF1bHQuanBnJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpZCwgY2FjaGVbaWRdLndpZHRoLCBjYWNoZVtpZF0uaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICBVSS5wbHVnaW4oJ2xpZ2h0Ym94JywgJ3ZpbWVvJywge1xyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihsaWdodGJveCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gLyhcXC9cXC8uKj8pdmltZW9cXC5bYS16XStcXC8oWzAtOV0rKS4qPy8sIG1hdGNoZXM7XHJcblxyXG5cclxuICAgICAgICAgICAgbGlnaHRib3gub24oJ3Nob3dpdGVtLnVrLmxpZ2h0Ym94JywgZnVuY3Rpb24oZSwgZGF0YSl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGlkLCByZXNvbHZlID0gZnVuY3Rpb24oaWQsIHdpZHRoLCBoZWlnaHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAnPGlmcmFtZSBzcmM9XCIvL3BsYXllci52aW1lby5jb20vdmlkZW8vJytpZCsnXCIgd2lkdGg9XCInK3dpZHRoKydcIiBoZWlnaHQ9XCInK2hlaWdodCsnXCIgc3R5bGU9XCJ3aWR0aDoxMDAlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtcIicrKG1vZGFsLmxpZ2h0Ym94Lm9wdGlvbnMuYWxsb3dmdWxsc2NyZWVuPycgYWxsb3dmdWxsc2NyZWVuJzonJykrJz48L2lmcmFtZT4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50eXBlID0gJ2lmcmFtZSc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzID0gZGF0YS5zb3VyY2UubWF0Y2gocmVnZXgpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gbWF0Y2hlc1syXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIWNhY2hlW2lkXSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgVUkuJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgICAgIDogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgICAgICA6ICcvL3ZpbWVvLmNvbS9hcGkvb2VtYmVkLmpzb24/dXJsPScgKyBlbmNvZGVVUkkoZGF0YS5zb3VyY2UpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbnAgICAgOiAnY2FsbGJhY2snLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGUgOiAnanNvbnAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyAgOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVbaWRdID0ge3dpZHRoOmRhdGEud2lkdGgsIGhlaWdodDpkYXRhLmhlaWdodH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpZCwgY2FjaGVbaWRdLndpZHRoLCBjYWNoZVtpZF0uaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaWQsIGNhY2hlW2lkXS53aWR0aCwgY2FjaGVbaWRdLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBVSS5wbHVnaW4oJ2xpZ2h0Ym94JywgJ3ZpZGVvJywge1xyXG5cclxuICAgICAgICBpbml0OiBmdW5jdGlvbihsaWdodGJveCkge1xyXG5cclxuICAgICAgICAgICAgbGlnaHRib3gub24oJ3Nob3dpdGVtLnVrLmxpZ2h0Ym94JywgZnVuY3Rpb24oZSwgZGF0YSl7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlID0gZnVuY3Rpb24oc291cmNlLCB3aWR0aCwgaGVpZ2h0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubWV0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogJzx2aWRlbyBjbGFzcz1cInVrLXJlc3BvbnNpdmUtd2lkdGhcIiBzcmM9XCInK3NvdXJjZSsnXCIgd2lkdGg9XCInK3dpZHRoKydcIiBoZWlnaHQ9XCInK2hlaWdodCsnXCIgY29udHJvbHM+PC92aWRlbz4nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50eXBlID0gJ3ZpZGVvJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudHlwZSA9PSAndmlkZW8nIHx8IGRhdGEuc291cmNlLm1hdGNoKC9cXC4obXA0fHdlYm18b2d2KSQvaSkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjYWNoZVtkYXRhLnNvdXJjZV0pIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aWQgPSBVSS4kKCc8dmlkZW8gc3R5bGU9XCJwb3NpdGlvbjpmaXhlZDt2aXNpYmlsaXR5OmhpZGRlbjt0b3A6LTEwMDAwcHg7XCI+PC92aWRlbz4nKS5hdHRyKCdzcmMnLCBkYXRhLnNvdXJjZSkuYXBwZW5kVG8oJ2JvZHknKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZGxlID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZFswXS52aWRlb1dpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpZGxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZVtkYXRhLnNvdXJjZV0gPSB7d2lkdGg6IHZpZFswXS52aWRlb1dpZHRoLCBoZWlnaHQ6IHZpZFswXS52aWRlb0hlaWdodH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhLnNvdXJjZSwgY2FjaGVbZGF0YS5zb3VyY2VdLndpZHRoLCBjYWNoZVtkYXRhLnNvdXJjZV0uaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAyMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YS5zb3VyY2UsIGNhY2hlW2RhdGEuc291cmNlXS53aWR0aCwgY2FjaGVbZGF0YS5zb3VyY2VdLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgVUkucGx1Z2luKCdsaWdodGJveCcsICdpZnJhbWUnLCB7XHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uIChsaWdodGJveCkge1xyXG5cclxuICAgICAgICAgICAgbGlnaHRib3gub24oJ3Nob3dpdGVtLnVrLmxpZ2h0Ym94JywgZnVuY3Rpb24gKGUsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZSA9IGZ1bmN0aW9uIChzb3VyY2UsIHdpZHRoLCBoZWlnaHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5tZXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAnPGlmcmFtZSBjbGFzcz1cInVrLXJlc3BvbnNpdmUtd2lkdGhcIiBzcmM9XCInICsgc291cmNlICsgJ1wiIHdpZHRoPVwiJyArIHdpZHRoICsgJ1wiIGhlaWdodD1cIicgKyBoZWlnaHQgKyAnXCInKyhtb2RhbC5saWdodGJveC5vcHRpb25zLmFsbG93ZnVsbHNjcmVlbj8nIGFsbG93ZnVsbHNjcmVlbic6JycpKyc+PC9pZnJhbWU+JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEudHlwZSA9ICdpZnJhbWUnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS50eXBlID09PSAnaWZyYW1lJyB8fCBkYXRhLnNvdXJjZS5tYXRjaCgvXFwuKGh0bWx8cGhwKSQvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YS5zb3VyY2UsIChsaWdodGJveC5vcHRpb25zLndpZHRoIHx8IDgwMCksIChsaWdodGJveC5vcHRpb25zLmhlaWdodCB8fCA2MDApKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldE1vZGFsKGxpZ2h0Ym94KSB7XHJcblxyXG4gICAgICAgIGlmIChtb2RhbCkge1xyXG4gICAgICAgICAgICBtb2RhbC5saWdodGJveCA9IGxpZ2h0Ym94O1xyXG4gICAgICAgICAgICByZXR1cm4gbW9kYWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpbml0IGxpZ2h0Ym94IGNvbnRhaW5lclxyXG4gICAgICAgIG1vZGFsID0gVUkuJChbXHJcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstbW9kYWxcIj4nLFxyXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1ay1tb2RhbC1kaWFsb2cgdWstbW9kYWwtZGlhbG9nLWxpZ2h0Ym94IHVrLXNsaWRlbmF2LXBvc2l0aW9uXCIgc3R5bGU9XCJtYXJnaW4tbGVmdDphdXRvO21hcmdpbi1yaWdodDphdXRvO3dpZHRoOjIwMHB4O2hlaWdodDoyMDBweDt0b3A6JytNYXRoLmFicyh3aW5kb3cuaW5uZXJIZWlnaHQvMiAtIDIwMCkrJ3B4O1wiPicsXHJcbiAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJ1ay1tb2RhbC1jbG9zZSB1ay1jbG9zZSB1ay1jbG9zZS1hbHRcIj48L2E+JyxcclxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVrLWxpZ2h0Ym94LWNvbnRlbnRcIj48L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidWstbW9kYWwtc3Bpbm5lciB1ay1oaWRkZW5cIj48L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgJzwvZGl2PicsXHJcbiAgICAgICAgICAgICc8L2Rpdj4nXHJcbiAgICAgICAgXS5qb2luKCcnKSkuYXBwZW5kVG8oJ2JvZHknKTtcclxuXHJcbiAgICAgICAgbW9kYWwuZGlhbG9nICA9IG1vZGFsLmZpbmQoJy51ay1tb2RhbC1kaWFsb2c6Zmlyc3QnKTtcclxuICAgICAgICBtb2RhbC5jb250ZW50ID0gbW9kYWwuZmluZCgnLnVrLWxpZ2h0Ym94LWNvbnRlbnQ6Zmlyc3QnKTtcclxuICAgICAgICBtb2RhbC5sb2FkZXIgID0gbW9kYWwuZmluZCgnLnVrLW1vZGFsLXNwaW5uZXI6Zmlyc3QnKTtcclxuICAgICAgICBtb2RhbC5jbG9zZXIgID0gbW9kYWwuZmluZCgnLnVrLWNsb3NlLnVrLWNsb3NlLWFsdCcpO1xyXG4gICAgICAgIG1vZGFsLm1vZGFsICAgPSBVSS5tb2RhbChtb2RhbCwge21vZGFsOmZhbHNlfSk7XHJcblxyXG4gICAgICAgIC8vIG5leHQgLyBwcmV2aW91c1xyXG4gICAgICAgIG1vZGFsLm9uKCdzd2lwZVJpZ2h0IHN3aXBlTGVmdCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgbW9kYWwubGlnaHRib3hbZS50eXBlPT0nc3dpcGVMZWZ0JyA/ICduZXh0JzoncHJldmlvdXMnXSgpO1xyXG4gICAgICAgIH0pLm9uKCdjbGljaycsICdbZGF0YS1saWdodGJveC1wcmV2aW91c10sIFtkYXRhLWxpZ2h0Ym94LW5leHRdJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgbW9kYWwubGlnaHRib3hbVUkuJCh0aGlzKS5pcygnW2RhdGEtbGlnaHRib3gtbmV4dF0nKSA/ICduZXh0JzoncHJldmlvdXMnXSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBkZXN0cm95IGNvbnRlbnQgb24gbW9kYWwgaGlkZVxyXG4gICAgICAgIG1vZGFsLm9uKCdoaWRlLnVrLm1vZGFsJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBtb2RhbC5jb250ZW50Lmh0bWwoJycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgcmVzaXplQ2FjaGUgPSB7dzogd2luZG93LmlubmVyV2lkdGgsIGg6d2luZG93LmlubmVySGVpZ2h0fTtcclxuXHJcbiAgICAgICAgVUkuJHdpbi5vbignbG9hZCByZXNpemUgb3JpZW50YXRpb25jaGFuZ2UnLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgICAgIGlmIChyZXNpemVDYWNoZS53ICE9PSB3aW5kb3cuaW5uZXJXaWR0aCAmJiBtb2RhbC5pcygnOnZpc2libGUnKSAmJiAhVUkuVXRpbHMuaXNGdWxsc2NyZWVuKCkpIHtcclxuICAgICAgICAgICAgICAgIG1vZGFsLmxpZ2h0Ym94LmZpdFNpemUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVzaXplQ2FjaGUgPSB7dzogd2luZG93LmlubmVyV2lkdGgsIGg6d2luZG93LmlubmVySGVpZ2h0fTtcclxuXHJcbiAgICAgICAgfSwgMTAwKSk7XHJcblxyXG4gICAgICAgIG1vZGFsLmxpZ2h0Ym94ID0gbGlnaHRib3g7XHJcblxyXG4gICAgICAgIHJldHVybiBtb2RhbDtcclxuICAgIH1cclxuXHJcbiAgICBVSS5saWdodGJveC5jcmVhdGUgPSBmdW5jdGlvbihpdGVtcywgb3B0aW9ucykge1xyXG5cclxuICAgICAgICBpZiAoIWl0ZW1zKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBncm91cCA9IFtdLCBvO1xyXG5cclxuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHJcbiAgICAgICAgICAgIGdyb3VwLnB1c2goVUkuJC5leHRlbmQoe1xyXG4gICAgICAgICAgICAgICAgc291cmNlIDogJycsXHJcbiAgICAgICAgICAgICAgICB0aXRsZSAgOiAnJyxcclxuICAgICAgICAgICAgICAgIHR5cGUgICA6ICdhdXRvJyxcclxuICAgICAgICAgICAgICAgIGxpbmsgICA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sICh0eXBlb2YoaXRlbSkgPT0gJ3N0cmluZycgPyB7J3NvdXJjZSc6IGl0ZW19IDogaXRlbSkpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbyA9IFVJLmxpZ2h0Ym94KFVJLiQuZXh0ZW5kKHt9LCBvcHRpb25zLCB7J2dyb3VwJzpncm91cH0pKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG87XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBVSS5saWdodGJveDtcclxufSk7Il19
