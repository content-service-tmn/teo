!function(t){var i;window.UIkit2&&(i=t(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-tooltip",["uikit"],function(){return i||t(UIkit2)})}(function(u){"use strict";var m,v,g;return u.component("tooltip",{defaults:{offset:5,pos:"top",animation:!1,delay:0,cls:"",activeClass:"uk-active",src:function(t){var i=t.attr("title");return void 0!==i&&t.data("cached-title",i).removeAttr("title"),t.data("cached-title")}},tip:"",boot:function(){u.$html.on("mouseenter.tooltip.uikit focus.tooltip.uikit","[data-uk-tooltip]",function(t){var i=u.$(this);i.data("tooltip")||(u.tooltip(i,u.Utils.options(i.attr("data-uk-tooltip"))),i.trigger("mouseenter"))})},init:function(){var i=this;m||(m=u.$('<div class="uk-tooltip"></div>').appendTo("body")),this.on({focus:function(t){i.show()},blur:function(t){i.hide()},mouseenter:function(t){i.show()},mouseleave:function(t){i.hide()}})},show:function(){if(this.tip="function"==typeof this.options.src?this.options.src(this.element):this.options.src,v&&clearTimeout(v),g&&clearInterval(g),"string"==typeof this.tip&&this.tip.length){m.stop().css({top:-2e3,visibility:"hidden"}).removeClass(this.options.activeClass).show(),m.html('<div class="uk-tooltip-inner">'+this.tip+"</div>");var t=this,i=u.$.extend({},this.element.offset(),{width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}),o=m[0].offsetWidth,e=m[0].offsetHeight,s="function"==typeof this.options.offset?this.options.offset.call(this.element):this.options.offset,n="function"==typeof this.options.pos?this.options.pos.call(this.element):this.options.pos,l=n.split("-"),f={display:"none",visibility:"visible",top:i.top+i.height+e,left:i.left};if("fixed"==u.$html.css("position")||"fixed"==u.$body.css("position")){var a=u.$("body").offset(),p=u.$("html").offset(),h=p.top+a.top,c=p.left+a.left;i.left-=c,i.top-=h}"left"!=l[0]&&"right"!=l[0]||"right"!=u.langdirection||(l[0]="left"==l[0]?"right":"left");var r={bottom:{top:i.top+i.height+s,left:i.left+i.width/2-o/2},top:{top:i.top-e-s,left:i.left+i.width/2-o/2},left:{top:i.top+i.height/2-e/2,left:i.left-o-s},right:{top:i.top+i.height/2-e/2,left:i.left+i.width+s}};u.$.extend(f,r[l[0]]),2==l.length&&(f.left="left"==l[1]?i.left:i.left+i.width-o);var d=this.checkBoundary(f.left,f.top,o,e);if(d){switch(d){case"x":n=2==l.length?l[0]+"-"+(f.left<0?"left":"right"):f.left<0?"right":"left";break;case"y":n=2==l.length?(f.top<0?"bottom":"top")+"-"+l[1]:f.top<0?"bottom":"top";break;case"xy":n=2==l.length?(f.top<0?"bottom":"top")+"-"+(f.left<0?"left":"right"):f.left<0?"right":"left"}l=n.split("-"),u.$.extend(f,r[l[0]]),2==l.length&&(f.left="left"==l[1]?i.left:i.left+i.width-o)}f.left-=u.$body.position().left,v=setTimeout(function(){m.css(f).attr("class",["uk-tooltip","uk-tooltip-"+n,t.options.cls].join(" ")),t.options.animation?m.css({opacity:0,display:"block"}).addClass(t.options.activeClass).animate({opacity:1},parseInt(t.options.animation,10)||400):m.show().addClass(t.options.activeClass),v=!1,g=setInterval(function(){t.element.is(":visible")||t.hide()},150)},parseInt(this.options.delay,10)||0)}},hide:function(){if(!this.element.is("input")||this.element[0]!==document.activeElement)if(v&&clearTimeout(v),g&&clearInterval(g),m.stop(),this.options.animation){var t=this;m.fadeOut(parseInt(this.options.animation,10)||400,function(){m.removeClass(t.options.activeClass)})}else m.hide().removeClass(this.options.activeClass)},content:function(){return this.tip},checkBoundary:function(t,i,o,e){var s="";return(t<0||t-u.$win.scrollLeft()+o>window.innerWidth)&&(s+="x"),(i<0||i-u.$win.scrollTop()+e>window.innerHeight)&&(s+="y"),s}}),u.tooltip});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdG9vbHRpcC5qcyJdLCJuYW1lcyI6WyJhZGRvbiIsImNvbXBvbmVudCIsIndpbmRvdyIsIlVJa2l0MiIsImRlZmluZSIsImFtZCIsIlVJIiwiJHRvb2x0aXAiLCJ0b29sdGlwZGVsYXkiLCJjaGVja0lkbGUiLCJkZWZhdWx0cyIsIm9mZnNldCIsInBvcyIsImFuaW1hdGlvbiIsImRlbGF5IiwiY2xzIiwiYWN0aXZlQ2xhc3MiLCJzcmMiLCJlbGUiLCJ0aXRsZSIsImF0dHIiLCJ1bmRlZmluZWQiLCJkYXRhIiwicmVtb3ZlQXR0ciIsInRpcCIsImJvb3QiLCIkaHRtbCIsIm9uIiwiZSIsIiQiLCJ0aGlzIiwidG9vbHRpcCIsIlV0aWxzIiwib3B0aW9ucyIsInRyaWdnZXIiLCJpbml0IiwiJHRoaXMiLCJhcHBlbmRUbyIsImZvY3VzIiwic2hvdyIsImJsdXIiLCJoaWRlIiwibW91c2VlbnRlciIsIm1vdXNlbGVhdmUiLCJlbGVtZW50IiwiY2xlYXJUaW1lb3V0IiwiY2xlYXJJbnRlcnZhbCIsImxlbmd0aCIsInN0b3AiLCJjc3MiLCJ0b3AiLCJ2aXNpYmlsaXR5IiwicmVtb3ZlQ2xhc3MiLCJodG1sIiwiZXh0ZW5kIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImhlaWdodCIsIm9mZnNldEhlaWdodCIsImNhbGwiLCJwb3NpdGlvbiIsInRtcHBvcyIsInNwbGl0IiwidGNzcyIsImRpc3BsYXkiLCJsZWZ0IiwiJGJvZHkiLCJib2R5b2Zmc2V0IiwiaHRtbG9mZnNldCIsImRvY29mZnNldCIsImxhbmdkaXJlY3Rpb24iLCJ2YXJpYW50cyIsImJvdHRvbSIsInJpZ2h0IiwiYm91bmRhcnkiLCJjaGVja0JvdW5kYXJ5Iiwic2V0VGltZW91dCIsImpvaW4iLCJvcGFjaXR5IiwiYWRkQ2xhc3MiLCJhbmltYXRlIiwicGFyc2VJbnQiLCJzZXRJbnRlcnZhbCIsImlzIiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwiZmFkZU91dCIsImNvbnRlbnQiLCJheGlzIiwiJHdpbiIsInNjcm9sbExlZnQiLCJpbm5lcldpZHRoIiwic2Nyb2xsVG9wIiwiaW5uZXJIZWlnaHQiXSwibWFwcGluZ3MiOiJDQUNBLFNBQVVBLEdBQ04sSUFBSUMsRUFFQUMsT0FBT0MsU0FDUEYsRUFBWUQsRUFBTUcsU0FHRCxtQkFBVkMsUUFBd0JBLE9BQU9DLEtBQ3RDRCxPQUFPLGdCQUFpQixDQUFDLFNBQVUsV0FDL0IsT0FBT0gsR0FBYUQsRUFBTUcsVUFUdEMsQ0FhRyxTQUFTRyxHQUVSLGFBRUEsSUFBSUMsRUFDQUMsRUFBY0MsRUFzTmxCLE9BcE5BSCxFQUFHTCxVQUFVLFVBQVcsQ0FFcEJTLFNBQVUsQ0FDTkMsT0FBUSxFQUNSQyxJQUFLLE1BQ0xDLFdBQVcsRUFDWEMsTUFBTyxFQUNQQyxJQUFLLEdBQ0xDLFlBQWEsWUFDYkMsSUFBSyxTQUFTQyxHQUNWLElBQUlDLEVBQVFELEVBQUlFLEtBQUssU0FNckIsWUFKY0MsSUFBVkYsR0FDQUQsRUFBSUksS0FBSyxlQUFnQkgsR0FBT0ksV0FBVyxTQUd4Q0wsRUFBSUksS0FBSyxrQkFJeEJFLElBQUssR0FFTEMsS0FBTSxXQUdGbkIsRUFBR29CLE1BQU1DLEdBQUcsK0NBQWdELG9CQUFxQixTQUFTQyxHQUN0RixJQUFJVixFQUFNWixFQUFHdUIsRUFBRUMsTUFFVlosRUFBSUksS0FBSyxhQUNWaEIsRUFBR3lCLFFBQVFiLEVBQUtaLEVBQUcwQixNQUFNQyxRQUFRZixFQUFJRSxLQUFLLHFCQUMxQ0YsRUFBSWdCLFFBQVEsa0JBS3hCQyxLQUFNLFdBRUYsSUFBSUMsRUFBUU4sS0FFUHZCLElBQ0RBLEVBQVdELEVBQUd1QixFQUFFLGtDQUFrQ1EsU0FBUyxTQUcvRFAsS0FBS0gsR0FBRyxDQUNKVyxNQUFhLFNBQVNWLEdBQUtRLEVBQU1HLFFBQ2pDQyxLQUFhLFNBQVNaLEdBQUtRLEVBQU1LLFFBQ2pDQyxXQUFhLFNBQVNkLEdBQUtRLEVBQU1HLFFBQ2pDSSxXQUFhLFNBQVNmLEdBQUtRLEVBQU1LLFdBSXpDRixLQUFNLFdBT0Ys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QUFNSyxRQUN6QyxNQUVKd0MsU0FBU25ELEtBQUtHLFFBQVFuQixNQUFPLEtBQU8sS0FHM0MyQixLQUFNLFdBRUYsSUFBSVgsS0FBS2MsUUFBUXVDLEdBQUcsVUFBWXJELEtBQUtjLFFBQVEsS0FBS3dDLFNBQVNDLGNBTzNELEdBTEk3RSxHQUFjcUMsYUFBYXJDLEdBQzNCQyxHQUFZcUMsY0FBY3JDLEdBRTlCRixFQUFTeUMsT0FFTGxCLEtBQUtHLFFBQVFwQixVQUFXLENBRXhCLElBQUl1QixFQUFRTixLQUVadkIsRUFBUytFLFFBQVFMLFNBQVNuRCxLQUFLRyxRQUFRcEIsVUFBVyxLQUFPLElBQUssV0FDMUROLEVBQVM2QyxZQUFZaEIsRUFBTUgsUUFBUWpCLG9CQUl2Q1QsRUFBU2tDLE9BQU9XLFlBQVl0QixLQUFLRyxRQUFRakIsY0FJakR1RSxRQUFTLFdBQ0wsT0FBT3pELEtBQUtOLEtBR2hCbUQsY0FBZSxTQUFTVixFQUFNZixFQUFLSyxFQUFPRSxHQUV0QyxJQUFJK0IsRUFBTyxHQVVYLE9BUkd2QixFQUFPLEdBQU9BLEVBQU8zRCxFQUFHbUYsS0FBS0MsYUFBY25DLEVBQVNyRCxPQUFPeUYsY0FDM0RILEdBQVEsTUFHUnRDLEVBQU0sR0FBT0EsRUFBTTVDLEVBQUdtRixLQUFLRyxZQUFhbkMsRUFBVXZELE9BQU8yRixlQUN6REwsR0FBUSxLQUdKQSxLQUlSbEYsRUFBR3lCIiwiZmlsZSI6ImNvbXBvbmVudHMvdG9vbHRpcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cbihmdW5jdGlvbihhZGRvbikge1xuICAgIHZhciBjb21wb25lbnQ7XG5cbiAgICBpZiAod2luZG93LlVJa2l0Mikge1xuICAgICAgICBjb21wb25lbnQgPSBhZGRvbihVSWtpdDIpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoJ3Vpa2l0LXRvb2x0aXAnLCBbJ3Vpa2l0J10sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50IHx8IGFkZG9uKFVJa2l0Mik7XG4gICAgICAgIH0pO1xuICAgIH1cblxufSkoZnVuY3Rpb24oVUkpe1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgJHRvb2x0aXAsICAgLy8gdG9vbHRpcCBjb250YWluZXJcbiAgICAgICAgdG9vbHRpcGRlbGF5LCBjaGVja0lkbGU7XG5cbiAgICBVSS5jb21wb25lbnQoJ3Rvb2x0aXAnLCB7XG5cbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIG9mZnNldDogNSxcbiAgICAgICAgICAgIHBvczogJ3RvcCcsXG4gICAgICAgICAgICBhbmltYXRpb246IGZhbHNlLFxuICAgICAgICAgICAgZGVsYXk6IDAsIC8vIGluIG1pbGlzZWNvbmRzXG4gICAgICAgICAgICBjbHM6ICcnLFxuICAgICAgICAgICAgYWN0aXZlQ2xhc3M6ICd1ay1hY3RpdmUnLFxuICAgICAgICAgICAgc3JjOiBmdW5jdGlvbihlbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBlbGUuYXR0cigndGl0bGUnKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aXRsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZS5kYXRhKCdjYWNoZWQtdGl0bGUnLCB0aXRsZSkucmVtb3ZlQXR0cigndGl0bGUnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlLmRhdGEoXCJjYWNoZWQtdGl0bGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgdGlwOiAnJyxcblxuICAgICAgICBib290OiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgLy8gaW5pdCBjb2RlXG4gICAgICAgICAgICBVSS4kaHRtbC5vbignbW91c2VlbnRlci50b29sdGlwLnVpa2l0IGZvY3VzLnRvb2x0aXAudWlraXQnLCAnW2RhdGEtdWstdG9vbHRpcF0nLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZSA9IFVJLiQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWVsZS5kYXRhKCd0b29sdGlwJykpIHtcbiAgICAgICAgICAgICAgICAgICAgVUkudG9vbHRpcChlbGUsIFVJLlV0aWxzLm9wdGlvbnMoZWxlLmF0dHIoJ2RhdGEtdWstdG9vbHRpcCcpKSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZS50cmlnZ2VyKCdtb3VzZWVudGVyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghJHRvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAkdG9vbHRpcCA9IFVJLiQoJzxkaXYgY2xhc3M9XCJ1ay10b29sdGlwXCI+PC9kaXY+JykuYXBwZW5kVG8oXCJib2R5XCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICBmb2N1cyAgICAgIDogZnVuY3Rpb24oZSkgeyAkdGhpcy5zaG93KCk7IH0sXG4gICAgICAgICAgICAgICAgYmx1ciAgICAgICA6IGZ1bmN0aW9uKGUpIHsgJHRoaXMuaGlkZSgpOyB9LFxuICAgICAgICAgICAgICAgIG1vdXNlZW50ZXIgOiBmdW5jdGlvbihlKSB7ICR0aGlzLnNob3coKTsgfSxcbiAgICAgICAgICAgICAgICBtb3VzZWxlYXZlIDogZnVuY3Rpb24oZSkgeyAkdGhpcy5oaWRlKCk7IH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB0aGlzLnRpcCA9IHR5cGVvZih0aGlzLm9wdGlvbnMuc3JjKSA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMub3B0aW9ucy5zcmModGhpcy5lbGVtZW50KSA6IHRoaXMub3B0aW9ucy5zcmM7XG5cbiAgICAgICAgICAgIGlmICh0b29sdGlwZGVsYXkpIGNsZWFyVGltZW91dCh0b29sdGlwZGVsYXkpO1xuICAgICAgICAgICAgaWYgKGNoZWNrSWRsZSkgICAgY2xlYXJJbnRlcnZhbChjaGVja0lkbGUpO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mKHRoaXMudGlwKSA9PT0gJ3N0cmluZycgPyAhdGhpcy50aXAubGVuZ3RoOnRydWUpIHJldHVybjtcblxuICAgICAgICAgICAgJHRvb2x0aXAuc3RvcCgpLmNzcyh7dG9wOiAtMjAwMCwgdmlzaWJpbGl0eTogJ2hpZGRlbid9KS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpLnNob3coKTtcbiAgICAgICAgICAgICR0b29sdGlwLmh0bWwoJzxkaXYgY2xhc3M9XCJ1ay10b29sdGlwLWlubmVyXCI+JyArIHRoaXMudGlwICsgJzwvZGl2PicpO1xuXG4gICAgICAgICAgICB2YXIgJHRoaXMgICAgICA9IHRoaXMsXG4gICAgICAgICAgICAgICAgcG9zICAgICAgICA9IFVJLiQuZXh0ZW5kKHt9LCB0aGlzLmVsZW1lbnQub2Zmc2V0KCksIHt3aWR0aDogdGhpcy5lbGVtZW50WzBdLm9mZnNldFdpZHRoLCBoZWlnaHQ6IHRoaXMuZWxlbWVudFswXS5vZmZzZXRIZWlnaHR9KSxcbiAgICAgICAgICAgICAgICB3aWR0aCAgICAgID0gJHRvb2x0aXBbMF0ub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0ICAgICA9ICR0b29sdGlwWzBdLm9mZnNldEhlaWdodCxcbiAgICAgICAgICAgICAgICBvZmZzZXQgICAgID0gdHlwZW9mKHRoaXMub3B0aW9ucy5vZmZzZXQpID09PSBcImZ1bmN0aW9uXCIgPyB0aGlzLm9wdGlvbnMub2Zmc2V0LmNhbGwodGhpcy5lbGVtZW50KSA6IHRoaXMub3B0aW9ucy5vZmZzZXQsXG4gICAgICAgICAgICAgICAgcG9zaXRpb24gICA9IHR5cGVvZih0aGlzLm9wdGlvbnMucG9zKSA9PT0gXCJmdW5jdGlvblwiID8gdGhpcy5vcHRpb25zLnBvcy5jYWxsKHRoaXMuZWxlbWVudCkgOiB0aGlzLm9wdGlvbnMucG9zLFxuICAgICAgICAgICAgICAgIHRtcHBvcyAgICAgPSBwb3NpdGlvbi5zcGxpdChcIi1cIiksXG4gICAgICAgICAgICAgICAgdGNzcyAgICAgICA9IHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheSAgICA6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eSA6ICd2aXNpYmxlJyxcbiAgICAgICAgICAgICAgICAgICAgdG9wICAgICAgICA6IChwb3MudG9wICsgcG9zLmhlaWdodCArIGhlaWdodCksXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgICAgICAgOiBwb3MubGVmdFxuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgLy8gcHJldmVudCBzdHJhbmdlIHBvc2l0aW9uXG4gICAgICAgICAgICAvLyB3aGVuIHRvb2x0aXAgaXMgaW4gb2ZmY2FudmFzIGV0Yy5cbiAgICAgICAgICAgIGlmIChVSS4kaHRtbC5jc3MoJ3Bvc2l0aW9uJyk9PSdmaXhlZCcgfHwgVUkuJGJvZHkuY3NzKCdwb3NpdGlvbicpPT0nZml4ZWQnKXtcbiAgICAgICAgICAgICAgICB2YXIgYm9keW9mZnNldCA9IFVJLiQoJ2JvZHknKS5vZmZzZXQoKSxcbiAgICAgICAgICAgICAgICAgICAgaHRtbG9mZnNldCA9IFVJLiQoJ2h0bWwnKS5vZmZzZXQoKSxcbiAgICAgICAgICAgICAgICAgICAgZG9jb2Zmc2V0ICA9IHt0b3A6IChodG1sb2Zmc2V0LnRvcCArIGJvZHlvZmZzZXQudG9wKSwgbGVmdDogKGh0bWxvZmZzZXQubGVmdCArIGJvZHlvZmZzZXQubGVmdCl9O1xuXG4gICAgICAgICAgICAgICAgcG9zLmxlZnQgLT0gZG9jb2Zmc2V0LmxlZnQ7XG4gICAgICAgICAgICAgICAgcG9zLnRvcCAgLT0gZG9jb2Zmc2V0LnRvcDtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAoKHRtcHBvc1swXSA9PSAnbGVmdCcgfHwgdG1wcG9zWzBdID09ICdyaWdodCcpICYmIFVJLmxhbmdkaXJlY3Rpb24gPT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgICAgIHRtcHBvc1swXSA9IHRtcHBvc1swXSA9PSAnbGVmdCcgPyAncmlnaHQnIDogJ2xlZnQnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmFyaWFudHMgPSAge1xuICAgICAgICAgICAgICAgIGJvdHRvbSAgOiB7dG9wOiBwb3MudG9wICsgcG9zLmhlaWdodCArIG9mZnNldCwgbGVmdDogcG9zLmxlZnQgKyBwb3Mud2lkdGggLyAyIC0gd2lkdGggLyAyfSxcbiAgICAgICAgICAgICAgICB0b3AgICAgIDoge3RvcDogcG9zLnRvcCAtIGhlaWdodCAtIG9mZnNldCwgbGVmdDogcG9zLmxlZnQgKyBwb3Mud2lkdGggLyAyIC0gd2lkdGggLyAyfSxcbiAgICAgICAgICAgICAgICBsZWZ0ICAgIDoge3RvcDogcG9zLnRvcCArIHBvcy5oZWlnaHQgLyAyIC0gaGVpZ2h0IC8gMiwgbGVmdDogcG9zLmxlZnQgLSB3aWR0aCAtIG9mZnNldH0sXG4gICAgICAgICAgICAgICAgcmlnaHQgICA6IHt0b3A6IHBvcy50b3AgKyBwb3MuaGVpZ2h0IC8gMiAtIGhlaWdodCAvIDIsIGxlZnQ6IHBvcy5sZWZ0ICsgcG9zLndpZHRoICsgb2Zmc2V0fVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgVUkuJC5leHRlbmQodGNzcywgdmFyaWFudHNbdG1wcG9zWzBdXSk7XG5cbiAgICAgICAgICAgIGlmICh0bXBwb3MubGVuZ3RoID09IDIpIHRjc3MubGVmdCA9ICh0bXBwb3NbMV0gPT0gJ2xlZnQnKSA/IChwb3MubGVmdCkgOiAoKHBvcy5sZWZ0ICsgcG9zLndpZHRoKSAtIHdpZHRoKTtcblxuICAgICAgICAgICAgdmFyIGJvdW5kYXJ5ID0gdGhpcy5jaGVja0JvdW5kYXJ5KHRjc3MubGVmdCwgdGNzcy50b3AsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICAgICAgICBpZihib3VuZGFyeSkge1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoKGJvdW5kYXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3gnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wcG9zLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB0bXBwb3NbMF0rXCItXCIrKHRjc3MubGVmdCA8IDAgPyAnbGVmdCc6ICdyaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHRjc3MubGVmdCA8IDAgPyAncmlnaHQnOiAnbGVmdCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3knOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcHBvcy5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gKHRjc3MudG9wIDwgMCA/ICdib3R0b20nOiAndG9wJykrJy0nK3RtcHBvc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSAodGNzcy50b3AgPCAwID8gJ2JvdHRvbSc6ICd0b3AnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAneHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcHBvcy5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uID0gKHRjc3MudG9wIDwgMCA/ICdib3R0b20nOiAndG9wJykrJy0nKyh0Y3NzLmxlZnQgPCAwID8gJ2xlZnQnOiAncmlnaHQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb24gPSB0Y3NzLmxlZnQgPCAwID8gJ3JpZ2h0JzogJ2xlZnQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRtcHBvcyA9IHBvc2l0aW9uLnNwbGl0KCctJyk7XG5cbiAgICAgICAgICAgICAgICBVSS4kLmV4dGVuZCh0Y3NzLCB2YXJpYW50c1t0bXBwb3NbMF1dKTtcblxuICAgICAgICAgICAgICAgIGlmICh0bXBwb3MubGVuZ3RoID09IDIpIHRjc3MubGVmdCA9ICh0bXBwb3NbMV0gPT0gJ2xlZnQnKSA/IChwb3MubGVmdCkgOiAoKHBvcy5sZWZ0ICsgcG9zLndpZHRoKSAtIHdpZHRoKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB0Y3NzLmxlZnQgLT0gVUkuJGJvZHkucG9zaXRpb24oKS5sZWZ0O1xuXG4gICAgICAgICAgICB0b29sdGlwZGVsYXkgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAkdG9vbHRpcC5jc3ModGNzcykuYXR0cignY2xhc3MnLCBbJ3VrLXRvb2x0aXAnLCAndWstdG9vbHRpcC0nK3Bvc2l0aW9uLCAkdGhpcy5vcHRpb25zLmNsc10uam9pbignICcpKTtcblxuICAgICAgICAgICAgICAgIGlmICgkdGhpcy5vcHRpb25zLmFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAkdG9vbHRpcC5jc3Moe29wYWNpdHk6IDAsIGRpc3BsYXk6ICdibG9jayd9KS5hZGRDbGFzcygkdGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzKS5hbmltYXRlKHtvcGFjaXR5OiAxfSwgcGFyc2VJbnQoJHRoaXMub3B0aW9ucy5hbmltYXRpb24sIDEwKSB8fCA0MDApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICR0b29sdGlwLnNob3coKS5hZGRDbGFzcygkdGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0b29sdGlwZGVsYXkgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vIGNsb3NlIHRvb2x0aXAgaWYgZWxlbWVudCB3YXMgcmVtb3ZlZCBvciBoaWRkZW5cbiAgICAgICAgICAgICAgICBjaGVja0lkbGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBpZighJHRoaXMuZWxlbWVudC5pcygnOnZpc2libGUnKSkgJHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH0sIDE1MCk7XG5cbiAgICAgICAgICAgIH0sIHBhcnNlSW50KHRoaXMub3B0aW9ucy5kZWxheSwgMTApIHx8IDApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhpZGU6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmlzKCdpbnB1dCcpICYmIHRoaXMuZWxlbWVudFswXT09PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKHRvb2x0aXBkZWxheSkgY2xlYXJUaW1lb3V0KHRvb2x0aXBkZWxheSk7XG4gICAgICAgICAgICBpZiAoY2hlY2tJZGxlKSAgY2xlYXJJbnRlcnZhbChjaGVja0lkbGUpO1xuXG4gICAgICAgICAgICAkdG9vbHRpcC5zdG9wKCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgJHRoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgJHRvb2x0aXAuZmFkZU91dChwYXJzZUludCh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uLCAxMCkgfHwgNDAwLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAkdG9vbHRpcC5yZW1vdmVDbGFzcygkdGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICR0b29sdGlwLmhpZGUoKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNvbnRlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGlwO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoZWNrQm91bmRhcnk6IGZ1bmN0aW9uKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuXG4gICAgICAgICAgICB2YXIgYXhpcyA9IFwiXCI7XG5cbiAgICAgICAgICAgIGlmKGxlZnQgPCAwIHx8ICgobGVmdCAtIFVJLiR3aW4uc2Nyb2xsTGVmdCgpKSt3aWR0aCkgPiB3aW5kb3cuaW5uZXJXaWR0aCkge1xuICAgICAgICAgICAgICAgYXhpcyArPSBcInhcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYodG9wIDwgMCB8fCAoKHRvcCAtIFVJLiR3aW4uc2Nyb2xsVG9wKCkpK2hlaWdodCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQpIHtcbiAgICAgICAgICAgICAgIGF4aXMgKz0gXCJ5XCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBheGlzO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gVUkudG9vbHRpcDtcbn0pOyJdfQ==
