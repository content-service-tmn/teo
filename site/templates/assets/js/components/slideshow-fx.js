!function(i){var t;window.UIkit2&&(t=i(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-slideshow-fx",["uikit"],function(){return t||i(UIkit2)})}(function(I){"use strict";var M=I.slideshow.animations;I.$.extend(I.slideshow.animations,{slice:function(i,t,e,s){if(!i.data("cover"))return M.fade.apply(this,arguments);for(var n,o=I.$.Deferred(),r=Math.ceil(this.element.width()/this.options.slices),a=t.data("cover").css("background-image"),c=I.$('<li class="uk-slideshow-ghost"></li>').css({top:0,left:0,width:this.container.width(),height:this.container.height(),opacity:1,zIndex:15}),h=c.width(),d=c.height(),p=0;p<this.options.slices;p++){"slice-up-down"==s&&((p%2+2)%2==0?"0":d);var l,u=(this.options.slices,r),f="rect(0px, "+u*(p+1)+"px, "+d+"px, "+r*p+"px)";l="rect(0px, "+u*(p+1)+"px, 0px, "+r*p+"px)",("slice-up"==s||"slice-up-down"==s&&(p%2+2)%2==0)&&(l="rect("+d+"px, "+u*(p+1)+"px, "+d+"px, "+r*p+"px)"),n=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,width:h,height:d,"background-image":a,clip:l,opacity:0,transition:"all "+this.options.duration+"ms ease-in-out "+60*p+"ms","-webkit-transition":"all "+this.options.duration+"ms ease-in-out "+60*p+"ms"}).data("clip",f),c.append(n)}return this.container.append(c),c.children().last().on(I.support.transition.end,function(){setTimeout(function(){c.remove(),o.resolve()},0)}),c.width(),c.children().each(function(){(n=I.$(this)).css({clip:n.data("clip"),opacity:1})}),o.promise()},"slice-up":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-up"])},"slice-down":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-down"])},"slice-up-down":function(i,t,e){return M.slice.apply(this,[i,t,e,"slice-up-down"])},fold:function(i,t,e){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var s,n=I.$.Deferred(),o=Math.ceil(this.element.width()/this.options.slices),r=t.data("cover").css("background-image"),a=I.$('<li class="uk-slideshow-ghost"></li>').css({width:t.width(),height:t.height(),opacity:1,zIndex:15}),c=t.width(),h=t.height(),d=0;d<this.options.slices;d++)s=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,width:c,height:h,"background-image":r,"transform-origin":o*d+"px 0 0",clip:"rect(0px, "+o*(d+1)+"px, "+h+"px, "+o*d+"px)",opacity:0,transform:"scaleX(0.000001)",transition:"all "+this.options.duration+"ms ease-in-out "+(100+60*d)+"ms","-webkit-transition":"all "+this.options.duration+"ms ease-in-out "+(100+60*d)+"ms"}),a.prepend(s);return this.container.append(a),a.width(),a.children().first().on(I.support.transition.end,function(){setTimeout(function(){a.remove(),n.resolve()},0)}).end().css({transform:"scaleX(1)",opacity:1}),n.promise()},puzzle:function(i,t,e){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var s,n,o=I.$.Deferred(),r=this,a=Math.round(this.options.slices/2),c=Math.round(t.width()/a),h=Math.round(t.height()/c),d=Math.round(t.height()/h)+1,p=t.data("cover").css("background-image"),l=I.$('<li class="uk-slideshow-ghost"></li>').css({width:this.container.width(),height:this.container.height(),opacity:1,zIndex:15}),u=this.container.width(),f=this.container.height(),m=0;m<h;m++)for(var x=0;x<a;x++)n=[d*m+"px",(x==a-1?c+2:c)*(x+1)+"px",d*(m+1)+"px",c*x+"px"],s=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,opacity:0,width:u,height:f,"background-image":p,clip:"rect("+n.join(",")+")","-webkit-transform":"translateZ(0)",transform:"translateZ(0)"}),l.append(s);this.container.append(l);var w=v(l.children());return w.each(function(i){I.$(this).css({transition:"all "+r.options.duration+"ms ease-in-out "+(50+25*i)+"ms","-webkit-transition":"all "+r.options.duration+"ms ease-in-out "+(50+25*i)+"ms"})}).last().on(I.support.transition.end,function(){setTimeout(function(){l.remove(),o.resolve()},0)}),l.width(),w.css({opacity:1}),o.promise()},boxes:function(i,t,e,s){if(!t.data("cover"))return M.fade.apply(this,arguments);for(var n,o,r,a=I.$.Deferred(),c=Math.round(this.options.slices/2),h=Math.round(t.width()/c),d=Math.round(t.height()/h),p=Math.round(t.height()/d)+1,l=t.data("cover").css("background-image"),u=I.$('<li class="uk-slideshow-ghost"></li>').css({width:t.width(),height:t.height(),opacity:1,zIndex:15}),f=t.width(),m=t.height(),x=0;x<d;x++)for(r=0;r<c;r++)o=[p*x+"px",(r==c-1?h+2:h)*(r+1)+"px",p*(x+1)+"px",h*r+"px"],n=I.$('<div class="uk-cover-background"></div>').css({position:"absolute",top:0,left:0,opacity:1,width:f,height:m,"background-image":l,"transform-origin":o[3]+" "+o[0]+" 0",clip:"rect("+o.join(",")+")","-webkit-transform":"scale(0.0000000000000001)",transform:"scale(0.0000000000000001)"}),u.append(n);this.container.append(u);var w,v=0,g=0,k=0,b=[[]],y=u.children();for("boxes-reverse"==s&&(y=[].reverse.apply(y)),y.each(function(){b[v][g]=I.$(this),++g==c&&(g=0,b[++v]=[])}),w=r=0;r<c*d;r++){w=r;for(var $=0;$<d;$++)0<=w&&w<c&&b[$][w].css({transition:"all "+this.options.duration+"ms linear "+(50+k)+"ms","-webkit-transition":"all "+this.options.duration+"ms linear "+(50+k)+"ms"}),w--;k+=100}return y.last().on(I.support.transition.end,function(){setTimeout(function(){u.remove(),a.resolve()},0)}),u.width(),y.css({"-webkit-transform":"scale(1)",transform:"scale(1)"}),a.promise()},"boxes-reverse":function(i,t,e){return M.boxes.apply(this,[i,t,e,"boxes-reverse"])},"random-fx":function(){var i=["slice-up","fold","puzzle","slice-down","boxes","slice-up-down","boxes-reverse"];return this.fxIndex=(void 0===this.fxIndex?-1:this.fxIndex)+1,i[this.fxIndex]||(this.fxIndex=0),M[i[this.fxIndex]].apply(this,arguments)}});var v=function(i){for(var t,e,s=i.length;s;t=parseInt(Math.random()*s),e=i[--s],i[s]=i[t],i[t]=e);return i};return I.slideshow.animations});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvc2xpZGVzaG93LWZ4LmpzIl0sIm5hbWVzIjpbImFkZG9uIiwiY29tcG9uZW50Iiwid2luZG93IiwiVUlraXQyIiwiZGVmaW5lIiwiYW1kIiwiVUkiLCJBbmltYXRpb25zIiwic2xpZGVzaG93IiwiYW5pbWF0aW9ucyIsIiQiLCJleHRlbmQiLCJzbGljZSIsImN1cnJlbnQiLCJuZXh0IiwiZGlyIiwiZnJvbWZ4IiwiZGF0YSIsImZhZGUiLCJhcHBseSIsInRoaXMiLCJhcmd1bWVudHMiLCJiYXIiLCJkIiwiRGVmZXJyZWQiLCJzbGljZVdpZHRoIiwiTWF0aCIsImNlaWwiLCJlbGVtZW50Iiwid2lkdGgiLCJvcHRpb25zIiwic2xpY2VzIiwiYmdpbWFnZSIsImNzcyIsImdob3N0IiwidG9wIiwibGVmdCIsImNvbnRhaW5lciIsImhlaWdodCIsIm9wYWNpdHkiLCJ6SW5kZXgiLCJnaG9zdFdpZHRoIiwiZ2hvc3RIZWlnaHQiLCJpIiwiY2xpcGZyb20iLCJjbGlwdG8iLCJwb3NpdGlvbiIsImJhY2tncm91bmQtaW1hZ2UiLCJjbGlwIiwidHJhbnNpdGlvbiIsImR1cmF0aW9uIiwiLXdlYmtpdC10cmFuc2l0aW9uIiwiYXBwZW5kIiwiY2hpbGRyZW4iLCJsYXN0Iiwib24iLCJzdXBwb3J0IiwiZW5kIiwic2V0VGltZW91dCIsInJlbW92ZSIsInJlc29sdmUiLCJlYWNoIiwicHJvbWlzZSIsInNsaWNlLXVwIiwic2xpY2UtZG93biIsInNsaWNlLXVwLWRvd24iLCJmb2xkIiwidHJhbnNmb3JtLW9yaWdpbiIsInRyYW5zZm9ybSIsInByZXBlbmQiLCJmaXJzdCIsInB1enpsZSIsImJveCIsInJlY3QiLCIkdGhpcyIsImJveENvbHMiLCJyb3VuZCIsImJveFdpZHRoIiwiYm94Um93cyIsImJveEhlaWdodCIsInJvd3MiLCJjb2xzIiwiam9pbiIsIi13ZWJraXQtdHJhbnNmb3JtIiwiYm94ZXMiLCJzaHVmZmxlIiwicHJldkNvbCIsInJvd0luZGV4IiwiY29sSW5kZXgiLCJ0aW1lQnVmZiIsImJveDJEYXJyIiwicmV2ZXJzZSIsInJvdyIsImJveGVzLXJldmVyc2UiLCJyYW5kb20tZngiLCJmeEluZGV4IiwidW5kZWZpbmVkIiwiYXJyIiwiaiIsIngiLCJsZW5ndGgiLCJwYXJzZUludCIsInJhbmRvbSJdLCJtYXBwaW5ncyI6IkNBQ0EsU0FBVUEsR0FFTixJQUFJQyxFQUVBQyxPQUFPQyxTQUNQRixFQUFZRCxFQUFNRyxTQUdELG1CQUFWQyxRQUF3QkEsT0FBT0MsS0FDdENELE9BQU8scUJBQXNCLENBQUMsU0FBVSxXQUNwQyxPQUFPSCxHQUFhRCxFQUFNRyxVQVZ0QyxDQWNHLFNBQVNHLEdBRVIsYUFFQSxJQUFJQyxFQUFhRCxFQUFHRSxVQUFVQyxXQUU5QkgsRUFBR0ksRUFBRUMsT0FBT0wsRUFBR0UsVUFBVUMsV0FBWSxDQUNqQ0csTUFBTyxTQUFTQyxFQUFTQyxFQUFNQyxFQUFLQyxHQUVoQyxJQUFLSCxFQUFRSSxLQUFLLFNBQ2QsT0FBT1YsRUFBV1csS0FBS0MsTUFBTUMsS0FBTUMsV0FvQnZDLElBakJBLElBZUlDLEVBZkFDLEVBQUlqQixFQUFHSSxFQUFFYyxXQUVUQyxFQUFhQyxLQUFLQyxLQUFLUCxLQUFLUSxRQUFRQyxRQUFVVCxLQUFLVSxRQUFRQyxRQUMzREMsRUFBYWxCLEVBQUtHLEtBQUssU0FBU2dCLElBQUksb0JBQ3BDQyxFQUFhNUIsRUFBR0ksRUFBRSx3Q0FBd0N1QixJQUFJLENBQzFERSxJQUFTLEVBQ1RDLEtBQVMsRUFDVFAsTUFBU1QsS0FBS2lCLFVBQVVSLFFBQ3hCUyxPQUFTbEIsS0FBS2lCLFVBQVVDLFNBQ3hCQyxRQUFTLEVBQ1RDLE9BQVMsS0FFYkMsRUFBY1AsRUFBTUwsUUFDcEJhLEVBQWNSLEVBQU1JLFNBSWZLLEVBQUksRUFBR0EsRUFBSXZCLEtBQUtVLFFBQVFDLE9BQVFZLElBQUssQ0FFNUIsaUJBQVYzQixLQUNRMkIsRUFBSSxFQUFLLEdBQUssR0FBRyxFQUFJLElBQUlELEdBR3JDLElBRUlFLEVBRkFm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RSxLQUFLMkUsUUFBVSxHQUV2Q3hGLEVBQVdFLEVBQVdXLEtBQUsyRSxVQUFVNUUsTUFBTUMsS0FBTUMsY0FRaEUsSUFBSWdFLEVBQVUsU0FBU1ksR0FDbkIsSUFBSyxJQUFJQyxFQUFHQyxFQUFHeEQsRUFBSXNELEVBQUlHLE9BQVF6RCxFQUFHdUQsRUFBSUcsU0FBUzNFLEtBQUs0RSxTQUFXM0QsR0FBSXdELEVBQUlGLElBQU10RCxHQUFJc0QsRUFBSXRELEdBQUtzRCxFQUFJQyxHQUFJRCxFQUFJQyxHQUFLQyxHQUMzRyxPQUFPRixHQUdYLE9BQU8zRixFQUFHRSxVQUFVQyIsImZpbGUiOiJjb21wb25lbnRzL3NsaWRlc2hvdy1meC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cclxuKGZ1bmN0aW9uKGFkZG9uKSB7XHJcblxyXG4gICAgdmFyIGNvbXBvbmVudDtcclxuXHJcbiAgICBpZiAod2luZG93LlVJa2l0Mikge1xyXG4gICAgICAgIGNvbXBvbmVudCA9IGFkZG9uKFVJa2l0Mik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XHJcbiAgICAgICAgZGVmaW5lKCd1aWtpdC1zbGlkZXNob3ctZngnLCBbJ3Vpa2l0J10sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50IHx8IGFkZG9uKFVJa2l0Mik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59KShmdW5jdGlvbihVSSkge1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIHZhciBBbmltYXRpb25zID0gVUkuc2xpZGVzaG93LmFuaW1hdGlvbnM7XHJcblxyXG4gICAgVUkuJC5leHRlbmQoVUkuc2xpZGVzaG93LmFuaW1hdGlvbnMsIHtcclxuICAgICAgICBzbGljZTogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyLCBmcm9tZngpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICghY3VycmVudC5kYXRhKCdjb3ZlcicpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5mYWRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBkID0gVUkuJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNsaWNlV2lkdGggPSBNYXRoLmNlaWwodGhpcy5lbGVtZW50LndpZHRoKCkgLyB0aGlzLm9wdGlvbnMuc2xpY2VzKSxcclxuICAgICAgICAgICAgICAgIGJnaW1hZ2UgICAgPSBuZXh0LmRhdGEoJ2NvdmVyJykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJyksXHJcbiAgICAgICAgICAgICAgICBnaG9zdCAgICAgID0gVUkuJCgnPGxpIGNsYXNzPVwidWstc2xpZGVzaG93LWdob3N0XCI+PC9saT4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcCAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdCAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgOiB0aGlzLmNvbnRhaW5lci53aWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA6IHRoaXMuY29udGFpbmVyLmhlaWdodCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4IDogMTVcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZ2hvc3RXaWR0aCAgPSBnaG9zdC53aWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgZ2hvc3RIZWlnaHQgPSBnaG9zdC5oZWlnaHQoKSxcclxuICAgICAgICAgICAgICAgIHBvcyAgICAgICAgID0gZnJvbWZ4ID09ICdzbGljZS11cCcgPyBnaG9zdEhlaWdodDonMCcsXHJcbiAgICAgICAgICAgICAgICBiYXI7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub3B0aW9ucy5zbGljZXM7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmcm9tZnggPT0gJ3NsaWNlLXVwLWRvd24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zID0gKChpICUgMikgKyAyKSAlIDI9PTAgPyAnMCc6Z2hvc3RIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoICAgID0gKGkgPT0gdGhpcy5vcHRpb25zLnNsaWNlcy0xKSA/IHNsaWNlV2lkdGggOiBzbGljZVdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsaXB0byAgID0gKCdyZWN0KDBweCwgJysod2lkdGgqKGkrMSkpKydweCwgJytnaG9zdEhlaWdodCsncHgsICcrKHNsaWNlV2lkdGgqaSkrJ3B4KScpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsaXBmcm9tO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vc2xpY2UtZG93biAtIGRlZmF1bHRcclxuICAgICAgICAgICAgICAgIGNsaXBmcm9tID0gKCdyZWN0KDBweCwgJysod2lkdGgqKGkrMSkpKydweCwgMHB4LCAnKyhzbGljZVdpZHRoKmkpKydweCknKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbWZ4ID09ICdzbGljZS11cCcgfHwgKGZyb21meCA9PSAnc2xpY2UtdXAtZG93bicgJiYgKChpICUgMikgKyAyKSAlIDI9PTAgKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsaXBmcm9tID0gKCdyZWN0KCcrZ2hvc3RIZWlnaHQrJ3B4LCAnKyh3aWR0aCooaSsxKSkrJ3B4LCAnK2dob3N0SGVpZ2h0KydweCwgJysoc2xpY2VXaWR0aCppKSsncHgpJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYmFyID0gVUkuJCgnPGRpdiBjbGFzcz1cInVrLWNvdmVyLWJhY2tncm91bmRcIj48L2Rpdj4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgIDogJ2Fic29sdXRlJyxcclxuICAgICAgICAgICAgICAgICAgICAndG9wJyAgICAgICAgICAgICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2xlZnQnICAgICAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCcgICAgICAgICAgICAgIDogZ2hvc3RXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JyAgICAgICAgICAgICA6IGdob3N0SGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kLWltYWdlJyAgIDogYmdpbWFnZSxcclxuICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgICA6IGNsaXBmcm9tLFxyXG4gICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JyAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbicgICAgICAgICA6ICdhbGwgJyt0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKGkqNjApKydtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtdHJhbnNpdGlvbicgOiAnYWxsICcrdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcyBlYXNlLWluLW91dCAnKyhpKjYwKSsnbXMnXHJcblxyXG4gICAgICAgICAgICAgICAgfSkuZGF0YSgnY2xpcCcsIGNsaXB0byk7XHJcblxyXG4gICAgICAgICAgICAgICAgZ2hvc3QuYXBwZW5kKGJhcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChnaG9zdCk7XHJcblxyXG4gICAgICAgICAgICBnaG9zdC5jaGlsZHJlbigpLmxhc3QoKS5vbihVSS5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdob3N0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZ2hvc3Qud2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIGdob3N0LmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGJhciA9IFVJLiQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBiYXIuY3NzKHsgY2xpcDogYmFyLmRhdGEoJ2NsaXAnKSwgb3BhY2l0eTogMSB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgJ3NsaWNlLXVwJzogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zLnNsaWNlLmFwcGx5KHRoaXMsIFtjdXJyZW50LCBuZXh0LCBkaXIsICdzbGljZS11cCddKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAnc2xpY2UtZG93bic6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xyXG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5zbGljZS5hcHBseSh0aGlzLCBbY3VycmVudCwgbmV4dCwgZGlyLCAnc2xpY2UtZG93biddKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAnc2xpY2UtdXAtZG93bic6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xyXG4gICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5zbGljZS5hcHBseSh0aGlzLCBbY3VycmVudCwgbmV4dCwgZGlyLCAnc2xpY2UtdXAtZG93biddKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmb2xkOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICghbmV4dC5kYXRhKCdjb3ZlcicpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5mYWRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBkID0gVUkuJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNsaWNlV2lkdGggPSBNYXRoLmNlaWwodGhpcy5lbGVtZW50LndpZHRoKCkgLyB0aGlzLm9wdGlvbnMuc2xpY2VzKSxcclxuICAgICAgICAgICAgICAgIGJnaW1hZ2UgICAgPSBuZXh0LmRhdGEoJ2NvdmVyJykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJyksXHJcbiAgICAgICAgICAgICAgICBnaG9zdCAgICAgID0gVUkuJCgnPGxpIGNsYXNzPVwidWstc2xpZGVzaG93LWdob3N0XCI+PC9saT4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICA6IG5leHQud2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgOiBuZXh0LmhlaWdodCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4IDogMTVcclxuICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZ2hvc3RXaWR0aCAgPSBuZXh0LndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICBnaG9zdEhlaWdodCA9IG5leHQuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICBiYXI7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub3B0aW9ucy5zbGljZXM7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgICAgIGJhciA9IFVJLiQoJzxkaXYgY2xhc3M9XCJ1ay1jb3Zlci1iYWNrZ3JvdW5kXCI+PC9kaXY+JykuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nICAgICAgICAgICA6ICdhYnNvbHV0ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RvcCcgICAgICAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICdsZWZ0JyAgICAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAnd2lkdGgnICAgICAgICAgICAgICA6IGdob3N0V2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICAgOiBnaG9zdEhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZScgICA6IGJnaW1hZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybS1vcmlnaW4nICAgOiAoc2xpY2VXaWR0aCppKSsncHggMCAwJyxcclxuICAgICAgICAgICAgICAgICAgICAnY2xpcCcgICAgICAgICAgICAgICA6ICgncmVjdCgwcHgsICcrKHNsaWNlV2lkdGgqKGkrMSkpKydweCwgJytnaG9zdEhlaWdodCsncHgsICcrKHNsaWNlV2lkdGgqaSkrJ3B4KScpLFxyXG4gICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JyAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNmb3JtJyAgICAgICAgICA6ICdzY2FsZVgoMC4wMDAwMDEpJyxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbicgICAgICAgICA6ICdhbGwgJyt0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKDEwMCtpKjYwKSsnbXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zaXRpb24nIDogJ2FsbCAnK3RoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMgZWFzZS1pbi1vdXQgJysoMTAwK2kqNjApKydtcydcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGdob3N0LnByZXBlbmQoYmFyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKGdob3N0KTtcclxuXHJcbiAgICAgICAgICAgIGdob3N0LndpZHRoKCk7XHJcblxyXG4gICAgICAgICAgICBnaG9zdC5jaGlsZHJlbigpLmZpcnN0KCkub24oVUkuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdob3N0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH0pLmVuZCgpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06ICdzY2FsZVgoMSknLFxyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBwdXp6bGU6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xyXG5cclxuICAgICAgICAgICAgaWYgKCFuZXh0LmRhdGEoJ2NvdmVyJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zLmZhZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGQgPSBVSS4kLkRlZmVycmVkKCksICR0aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIHZhciBib3hDb2xzICAgPSBNYXRoLnJvdW5kKHRoaXMub3B0aW9ucy5zbGljZXMvMiksXHJcbiAgICAgICAgICAgICAgICBib3hXaWR0aCAgPSBNYXRoLnJvdW5kKG5leHQud2lkdGgoKS9ib3hDb2xzKSxcclxuICAgICAgICAgICAgICAgIGJveFJvd3MgICA9IE1hdGgucm91bmQobmV4dC5oZWlnaHQoKS9ib3hXaWR0aCksXHJcbiAgICAgICAgICAgICAgICBib3hIZWlnaHQgPSBNYXRoLnJvdW5kKG5leHQuaGVpZ2h0KCkvYm94Um93cykrMSxcclxuICAgICAgICAgICAgICAgIGJnaW1hZ2UgICA9IG5leHQuZGF0YSgnY292ZXInKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSxcclxuICAgICAgICAgICAgICAgIGdob3N0ICAgICA9IFVJLiQoJzxsaSBjbGFzcz1cInVrLXNsaWRlc2hvdy1naG9zdFwiPjwvbGk+JykuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgIDogdGhpcy5jb250YWluZXIud2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQgIDogdGhpcy5jb250YWluZXIuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSA6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4ICA6IDE1XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGdob3N0V2lkdGggID0gdGhpcy5jb250YWluZXIud2lkdGgoKSxcclxuICAgICAgICAgICAgICAgIGdob3N0SGVpZ2h0ID0gdGhpcy5jb250YWluZXIuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICBib3gsIHJlY3QsIHdpZHRoO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgcm93cyA9IDA7IHJvd3MgPCBib3hSb3dzOyByb3dzKyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2xzID0gMDsgY29scyA8IGJveENvbHM7IGNvbHMrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgPSAoY29scyA9PSBib3hDb2xzLTEpID8gKGJveFdpZHRoICsgMikgOiBib3hXaWR0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJveEhlaWdodCAqIHJvd3MpICAgICAgICsncHgnLCAvLyB0b3BcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHdpZHRoICAqIChjb2xzKzEpKSAgICAgICsncHgnLCAvLyByaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94SGVpZ2h0ICogKHJvd3MgKyAxKSkgKydweCcsIC8vIGJvdHRvbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94V2lkdGggICogY29scykgICAgICAgKydweCcgIC8vIGxlZnRcclxuICAgICAgICAgICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBib3ggPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZFwiPjwvZGl2PicpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAndG9wJyAgICAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xlZnQnICAgICAgICAgICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JyAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnd2lkdGgnICAgICAgICAgICAgIDogZ2hvc3RXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICA6IGdob3N0SGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZScgIDogYmdpbWFnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NsaXAnICAgICAgICAgICAgICA6ICgncmVjdCgnK3JlY3Quam9pbignLCcpKycpJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybScgOiAndHJhbnNsYXRlWigwKScsIC8vIGZpeGVzIHdlYmtpdCBvcGFjaXR5IGZsaWNrZXJpbmcgYnVnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nICAgICAgICAgOiAndHJhbnNsYXRlWigwKScgICAgICAgICAgLy8gZml4ZXMgbW96IG9wYWNpdHkgZmxpY2tlcmluZyBidWdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZ2hvc3QuYXBwZW5kKGJveCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChnaG9zdCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgYm94ZXMgPSBzaHVmZmxlKGdob3N0LmNoaWxkcmVuKCkpO1xyXG5cclxuICAgICAgICAgICAgYm94ZXMuZWFjaChmdW5jdGlvbihpKSB7XHJcbiAgICAgICAgICAgICAgICBVSS4kKHRoaXMpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAnYWxsICcrJHRoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMgZWFzZS1pbi1vdXQgJysoNTAraSoyNSkrJ21zJyxcclxuICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJzogJ2FsbCAnKyR0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zIGVhc2UtaW4tb3V0ICcrKDUwK2kqMjUpKydtcydcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KS5sYXN0KCkub24oVUkuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBnaG9zdC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGdob3N0LndpZHRoKCk7XHJcblxyXG4gICAgICAgICAgICBib3hlcy5jc3Moe29wYWNpdHk6IDF9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBib3hlczogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyLCBmcm9tZngpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICghbmV4dC5kYXRhKCdjb3ZlcicpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQW5pbWF0aW9ucy5mYWRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBkID0gVUkuJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGJveENvbHMgICA9IE1hdGgucm91bmQodGhpcy5vcHRpb25zLnNsaWNlcy8yKSxcclxuICAgICAgICAgICAgICAgIGJveFdpZHRoICA9IE1hdGgucm91bmQobmV4dC53aWR0aCgpL2JveENvbHMpLFxyXG4gICAgICAgICAgICAgICAgYm94Um93cyAgID0gTWF0aC5yb3VuZChuZXh0LmhlaWdodCgpL2JveFdpZHRoKSxcclxuICAgICAgICAgICAgICAgIGJveEhlaWdodCA9IE1hdGgucm91bmQobmV4dC5oZWlnaHQoKS9ib3hSb3dzKSsxLFxyXG4gICAgICAgICAgICAgICAgYmdpbWFnZSAgID0gbmV4dC5kYXRhKCdjb3ZlcicpLmNzcygnYmFja2dyb3VuZC1pbWFnZScpLFxyXG4gICAgICAgICAgICAgICAgZ2hvc3QgICAgID0gVUkuJCgnPGxpIGNsYXNzPVwidWstc2xpZGVzaG93LWdob3N0XCI+PC9saT4nKS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoICAgOiBuZXh0LndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0ICA6IG5leHQuaGVpZ2h0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSA6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgekluZGV4ICA6IDE1XHJcbiAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGdob3N0V2lkdGggID0gbmV4dC53aWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgZ2hvc3RIZWlnaHQgPSBuZXh0LmhlaWdodCgpLFxyXG4gICAgICAgICAgICAgICAgYm94LCByZWN0LCB3aWR0aCwgY29scztcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIHJvd3MgPSAwOyByb3dzIDwgYm94Um93czsgcm93cysrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChjb2xzID0gMDsgY29scyA8IGJveENvbHM7IGNvbHMrKykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB3aWR0aCAgPSAoY29scyA9PSBib3hDb2xzLTEpID8gKGJveFdpZHRoICsgMikgOiBib3hXaWR0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjdCA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJveEhlaWdodCAqIHJvd3MpICAgICAgICsncHgnLCAvLyB0b3BcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHdpZHRoICAqIChjb2xzKzEpKSAgICAgICsncHgnLCAvLyByaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94SGVpZ2h0ICogKHJvd3MgKyAxKSkgKydweCcsIC8vIGJvdHRvbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYm94V2lkdGggICogY29scykgICAgICAgKydweCcgIC8vIGxlZnRcclxuICAgICAgICAgICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBib3ggPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZFwiPjwvZGl2PicpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgICAgICAgOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAndG9wJyAgICAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xlZnQnICAgICAgICAgICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JyAgICAgICAgICAgOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnd2lkdGgnICAgICAgICAgICAgIDogZ2hvc3RXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCcgICAgICAgICAgICA6IGdob3N0SGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZScgIDogYmdpbWFnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zZm9ybS1vcmlnaW4nICA6IHJlY3RbM10rJyAnK3JlY3RbMF0rJyAwJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NsaXAnICAgICAgICAgICAgICA6ICgncmVjdCgnK3JlY3Quam9pbignLCcpKycpJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybScgOiAnc2NhbGUoMC4wMDAwMDAwMDAwMDAwMDAxKScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nICAgICAgICAgOiAnc2NhbGUoMC4wMDAwMDAwMDAwMDAwMDAxKSdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZ2hvc3QuYXBwZW5kKGJveCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZChnaG9zdCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcm93SW5kZXggPSAwLCBjb2xJbmRleCA9IDAsIHRpbWVCdWZmID0gMCwgYm94MkRhcnIgPSBbW11dLCBib3hlcyA9IGdob3N0LmNoaWxkcmVuKCksIHByZXZDb2w7XHJcblxyXG4gICAgICAgICAgICBpZiAoZnJvbWZ4ID09ICdib3hlcy1yZXZlcnNlJykge1xyXG4gICAgICAgICAgICAgICAgYm94ZXMgPSBbXS5yZXZlcnNlLmFwcGx5KGJveGVzKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYm94ZXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBib3gyRGFycltyb3dJbmRleF1bY29sSW5kZXhdID0gVUkuJCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGNvbEluZGV4Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoY29sSW5kZXggPT0gYm94Q29scykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sSW5kZXggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGJveDJEYXJyW3Jvd0luZGV4XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29scyA9IDAsIHByZXZDb2wgPSAwOyBjb2xzIDwgKGJveENvbHMgKiBib3hSb3dzKTsgY29scysrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldkNvbCA9IGNvbHM7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgYm94Um93czsgcm93KyspIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZDb2wgPj0gMCAmJiBwcmV2Q29sIDwgYm94Q29scykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYm94MkRhcnJbcm93XVtwcmV2Q29sXS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb24nOiAnYWxsICcrdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcyBsaW5lYXIgJysoNTArdGltZUJ1ZmYpKydtcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uJzogJ2FsbCAnK3RoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMgbGluZWFyICcrKDUwK3RpbWVCdWZmKSsnbXMnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwcmV2Q29sLS07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aW1lQnVmZiArPSAxMDA7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJveGVzLmxhc3QoKS5vbihVSS5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGdob3N0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZ2hvc3Qud2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIGJveGVzLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiAnc2NhbGUoMSknLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6ICdzY2FsZSgxKSdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgJ2JveGVzLXJldmVyc2UnOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEFuaW1hdGlvbnMuYm94ZXMuYXBwbHkodGhpcywgW2N1cnJlbnQsIG5leHQsIGRpciwgJ2JveGVzLXJldmVyc2UnXSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgJ3JhbmRvbS1meCc6IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IFsnc2xpY2UtdXAnLCAnZm9sZCcsICdwdXp6bGUnLCAnc2xpY2UtZG93bicsICdib3hlcycsICdzbGljZS11cC1kb3duJywgJ2JveGVzLXJldmVyc2UnXTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnhJbmRleCA9ICh0aGlzLmZ4SW5kZXggPT09IHVuZGVmaW5lZCA/IC0xIDogdGhpcy5meEluZGV4KSArIDE7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWFuaW1hdGlvbnNbdGhpcy5meEluZGV4XSkgdGhpcy5meEluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25zW2FuaW1hdGlvbnNbdGhpcy5meEluZGV4XV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgLy8gaGVscGVyIGZ1bmN0aW9uc1xyXG5cclxuICAgIC8vIFNodWZmbGUgYW4gYXJyYXlcclxuICAgIHZhciBzaHVmZmxlID0gZnVuY3Rpb24oYXJyKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaiwgeCwgaSA9IGFyci5sZW5ndGg7IGk7IGogPSBwYXJzZUludChNYXRoLnJhbmRvbSgpICogaSksIHggPSBhcnJbLS1pXSwgYXJyW2ldID0gYXJyW2pdLCBhcnJbal0gPSB4KSB7fVxyXG4gICAgICAgIHJldHVybiBhcnI7XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBVSS5zbGlkZXNob3cuYW5pbWF0aW9ucztcclxufSk7Il19
