!function(t){var s;window.UIkit2&&(s=t(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-nestable",["uikit"],function(){return s||t(UIkit2)})}(function(v){"use strict";var o,a="ontouchstart"in window,h=v.$html,E=[],i=v.$win,n=a?"touchstart":"mousedown",r=a?"touchmove":"mousemove",d=a?"touchend":"mouseup",p=a?"touchcancel":"mouseup";return v.component("nestable",{defaults:{listBaseClass:"uk-nestable",listClass:"uk-nestable-list",listItemClass:"uk-nestable-item",dragClass:"uk-nestable-dragged",movingClass:"uk-nestable-moving",noChildrenClass:"uk-nestable-nochildren",emptyClass:"uk-nestable-empty",handleClass:"",collapsedClass:"uk-collapsed",placeholderClass:"uk-nestable-placeholder",noDragClass:"uk-nestable-nodrag",group:!1,maxDepth:10,threshold:20,idlethreshold:10},boot:function(){v.$html.on("mousemove touchmove",function(t){if(o){var s=o.offset().top;s<v.$win.scrollTop()?v.$win.scrollTop(v.$win.scrollTop()-Math.ceil(o.height()/2)):s+o.height()>window.innerHeight+v.$win.scrollTop()&&v.$win.scrollTop(v.$win.scrollTop()+Math.ceil(o.height()/2))}}),v.ready(function(t){v.$("[data-uk-nestable]",t).each(function(){var t=v.$(this);t.data("nestable")||v.nestable(t,v.Utils.options(t.attr("data-uk-nestable")))})})},init:function(){var l=this;Object.keys(this.options).forEach(function(t){-1!=String(t).indexOf("Class")&&(l.options["_"+t]="."+l.options[t])}),this.find(this.options._listItemClass).find(">ul").addClass(this.options.listClass),this.checkEmptyList(),this.reset(),this.element.data("nestable-group",this.options.group||v.Utils.uid("nestable-group")),this.find(this.options._listItemClass).each(function(){l.setParent(v.$(this))}),this.on("click","[data-nestable-action]",function(t){if(!l.dragEl&&(a||0===t.button)){t.preventDefault();var s=v.$(t.currentTarget),e=s.data("nestableAction"),i=s.closest(l.options._listItemClass);"collapse"===e&&l.collapseItem(i),"expand"===e&&l.expandItem(i),"toggle"===e&&l.toggleItem(i)}});var t=function(s){var t=v.$(s.target),e=t.is("a[href]")?t:t.parents("a[href]");s.target!==l.element[0]&&(t.is(l.options._noDragClass)||t.closest(l.options._noDragClass).length||t.is("[data-nestable-action]")||t.closest("[data-nestable-action]").length||(l.options.handleClass&&!t.hasClass(l.options.handleClass)&&l.options.handleClass&&(t=t.closest(l.options._handleClass)),!t.length||l.dragEl||!a&&0!==s.button||a&&1!==s.touches.length||(s.originalEvent&&s.originalEvent.touches&&(s=evt.originalEvent.touches[0]),l.delayMove=function(t){e=!1,t.preventDefault(),l.dragStart(s),l.trigger("start.uk.nestable",[l]),l.delayMove=!1},l.delayMove.x=parseInt(s.pageX,10),l.delayMove.y=parseInt(s.pageY,10),l.delayMove.threshold=l.options.idlethreshold,e.length&&"touchend"==d&&l.one(d,function(){e&&e.attr("href").trim()&&(location.href=e.attr("href"))}),s.preventDefault())))},s=function(t){t.originalEvent&&t.originalEvent.touches&&(t=t.originalEvent.touches[0]),l.delayMove&&(Math.abs(t.pageX-l.delayMove.x)>l.delayMove.threshold||Math.abs(t.pageY-l.delayMove.y)>l.delayMove.threshold)&&(window.getSelection().toString()?l.delayMove=!1:l.delayMove(t)),l.dragEl&&(t.preventDefault(),l.dragMove(t),l.trigger("move.uk.nestable",[l]))},e=function(t){l.dragEl&&(t.preventDefault(),l.dragStop(a?t.touches[0]:t)),o=!1,l.delayMove=!1};a?(this.element[0].addEventListener(n,t,!1),window.addEventListener(r,s,!1),window.addEventListener(d,e,!1),window.addEventListener(p,e,!1)):(this.on(n,t),i.on(r,s),i.on(d,e))},serialize:function(){var r=this,d=function(t,o){var h=[];return t.children(r.options._listItemClass).each(function(){for(var t,s,e,i=v.$(this),l={},a=i.children(r.options._listClass),n=0;n<i[0].attributes.length;n++)0===(t=i[0].attributes[n]).name.indexOf("data-")&&(s=t.name.substr(5),e=v.Utils.str2json(t.value),l[s]=e||"false"==t.value||"0"==t.value?e:t.value);a.length&&(l.children=d(a,o+1)),h.push(l)}),h};return d(r.element,0)},list:function(n){var o=[],h=function(t,l,a){t.children(n._listItemClass).each(function(t){var s=v.$(this),e=v.$.extend({parent_id:a||null,depth:l,order:t},s.data()),i=s.children(n._listClass);o.push(e),i.length&&h(i,l+1,s.data(n.idProperty||"id"))})};return n=v.$.extend({},this.options,n),h(this.element,0),o},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null;for(var t=0;t<E.length;t++)this.checkEmptyList(E[t]);E=[]},toggleItem:function(t){this[t.hasClass(this.options.collapsedClass)?"expandItem":"collapseItem"](t)},expandItem:function(t){t.removeClass(this.options.collapsedClass)},collapseItem:function(t){t.children(this.options._listClass).length&&t.addClass(this.options.collapsedClass)},expandAll:function(){var t=this;this.find(t.options._listItemClass).each(function(){t.expandItem(v.$(this))})},collapseAll:function(){var t=this;this.find(t.options._listItemClass).each(function(){t.collapseItem(v.$(this))})},setParent:function(t){t.children(this.options._listClass).length&&t.addClass("uk-parent")},unsetParent:function(t){t.removeClass("uk-parent "+this.options.collapsedClass),t.children(this.options._listClass).remove()},dragStart:function(t){var s=this.mouse,e=v.$(t.target).closest(this.options._listItemClass),i=e.offset();this.placeEl=e,s.offsetX=t.pageX-i.left,s.offsetY=t.pageY-i.top,s.startX=s.lastX=i.left,s.startY=s.lastY=i.top,this.dragRootEl=this.element,this.dragEl=v.$("<ul></ul>").addClass(this.options.listClass+" "+this.options.dragClass).append(e.clone()),this.dragEl.css("width",e.width()),this.placeEl.addClass(this.options.placeholderClass),o=this.dragEl,this.tmpDragOnSiblings=[e[0].previousSibling,e[0].nextSibling],v.$body.append(this.dragEl),this.dragEl.css({left:i.left,top:i.top});var l,a,n=this.dragEl.find(this.options._listItemClass);for(l=0;l<n.length;l++)(a=v.$(n[l]).parents(this.options._listClass+","+this.options._listBaseClass).length)>this.dragDepth&&(this.dragDepth=a);h.addClass(this.options.movingClass)},dragStop:function(t){var s=v.$(this.placeEl),e=this.placeEl.parents(this.options._listBaseClass+":first");this.placeEl.removeClass(this.options.placeholderClass),this.dragEl.remove(),this.element[0]!==e[0]?(e.trigger("change.uk.nestable",[e.data("nestable"),s,"added"]),this.element.trigger("change.uk.nestable",[this,s,"removed"])):this.element.trigger("change.uk.nestable",[this,s,"moved"]),this.trigger("stop.uk.nestable",[this,s]),this.reset(),h.removeClass(this.options.movingClass)},dragMove:function(t){var s,e,i,l=this.options,a=this.mouse,n=this.dragRootEl?this.dragRootEl.data("nestable").options.maxDepth:l.maxDepth;this.dragEl.css({left:t.pageX-a.offsetX,top:t.pageY-a.offsetY}),a.lastX=a.nowX,a.lastY=a.nowY,a.nowX=t.pageX,a.nowY=t.pageY,a.distX=a.nowX-a.lastX,a.distY=a.nowY-a.lastY,a.lastDirX=a.dirX,a.lastDirY=a.dirY,a.dirX=0===a.distX?0:0<a.distX?1:-1,a.dirY=0===a.distY?0:0<a.distY?1:-1;var o=Math.abs(a.distX)>Math.abs(a.distY)?1:0;if(!a.moving)return a.dirAx=o,void(a.moving=!0);if(a.dirAx!==o?(a.distAxX=0,a.distAxY=0):(a.distAxX+=Math.abs(a.distX),0!==a.dirX&&a.dirX!==a.lastDirX&&(a.distAxX=0),a.distAxY+=Math.abs(a.distY),0!==a.dirY&&a.dirY!==a.lastDirY&&(a.distAxY=0)),a.dirAx=o,a.dirAx&&a.distAxX>=l.threshold&&(a.distAxX=0,i=this.placeEl.prev("li"),0<a.distX&&i.length&&!i.hasClass(l.collapsedClass)&&!i.hasClass(l.noChildrenClass)&&(s=i.find(l._listClass).last(),this.placeEl.parents(l._listClass+","+l._listBaseClass).length+this.dragDepth<=n&&(s.length?(s=i.children(l._listClass).last()).append(this.placeEl):((s=v.$("<ul/>").addClass(l.listClass)).append(this.placeEl),i.append(s),this.setParent(i)))),a.distX<0&&!this.placeEl.next(l._listItemClass).length)){var h=this.placeEl.closest([l._listBaseClass,l._listClass].join(",")),r=h.closest(l._listItemClass);r.length&&(r.after(this.placeEl),h.children().length||this.unsetParent(r))}var d=!1,p=t.pageX-(window.pageXOffset||document.scrollLeft||0),c=t.pageY-(window.pageYOffset||document.documentElement.scrollTop);if(this.pointEl=v.$(document.elementFromPoint(p,c)),l.handleClass&&this.pointEl.hasClass(l.handleClass))this.pointEl=this.pointEl.closest(l._listItemClass);else{var g=this.pointEl.closest(l._listItemClass);g.length&&(this.pointEl=g)}if(!this.placeEl.find(this.pointEl).length){if(this.pointEl.data("nestable")&&!this.pointEl.children().length)d=!0,this.checkEmptyList(this.pointEl);else if(!this.pointEl.length||!this.pointEl.hasClass(l.listItemClass))return;var u=this.element,f=this.pointEl.closest(this.options._listBaseClass),m=u[0]!=f[0];if(!a.dirAx||m||d){if(m&&l.group!==f.data("nestable-group"))return;if(E.push(u),n<this.dragDepth-1+this.pointEl.parents(l._listClass+","+l._listBaseClass).length)return;var C=t.pageY<this.pointEl.offset().top+this.pointEl.height()/2;e=this.placeEl.parent(),d?this.pointEl.append(this.placeEl):C?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),e.children().length||e.data("nestable")||this.unsetParent(e.parent()),this.checkEmptyList(this.dragRootEl),this.checkEmptyList(u),m&&(this.dragRootEl=f,this.hasNewRoot=this.element[0]!==this.dragRootEl[0])}}},checkEmptyList:function(t){t=t?v.$(t):this.element,this.options.emptyClass&&t[t.children().length?"removeClass":"addClass"](this.options.emptyClass)}}),v.nestable});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvbmVzdGFibGUuanMiXSwibmFtZXMiOlsiYWRkb24iLCJjb21wb25lbnQiLCJ3aW5kb3ciLCJVSWtpdDIiLCJkZWZpbmUiLCJhbWQiLCJVSSIsImRyYWdnaW5nRWxlbWVudCIsImhhc1RvdWNoIiwiaHRtbCIsIiRodG1sIiwidG91Y2hlZGxpc3RzIiwiJHdpbiIsImVTdGFydCIsImVNb3ZlIiwiZUVuZCIsImVDYW5jZWwiLCJkZWZhdWx0cyIsImxpc3RCYXNlQ2xhc3MiLCJsaXN0Q2xhc3MiLCJsaXN0SXRlbUNsYXNzIiwiZHJhZ0NsYXNzIiwibW92aW5nQ2xhc3MiLCJub0NoaWxkcmVuQ2xhc3MiLCJlbXB0eUNsYXNzIiwiaGFuZGxlQ2xhc3MiLCJjb2xsYXBzZWRDbGFzcyIsInBsYWNlaG9sZGVyQ2xhc3MiLCJub0RyYWdDbGFzcyIsImdyb3VwIiwibWF4RGVwdGgiLCJ0aHJlc2hvbGQiLCJpZGxldGhyZXNob2xkIiwiYm9vdCIsIm9uIiwiZSIsInRvcCIsIm9mZnNldCIsInNjcm9sbFRvcCIsIk1hdGgiLCJjZWlsIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJyZWFkeSIsImNvbnRleHQiLCIkIiwiZWFjaCIsImVsZSIsInRoaXMiLCJkYXRhIiwibmVzdGFibGUiLCJVdGlscyIsIm9wdGlvbnMiLCJhdHRyIiwiaW5pdCIsIiR0aGlzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJTdHJpbmciLCJpbmRleE9mIiwiZmluZCIsIl9saXN0SXRlbUNsYXNzIiwiYWRkQ2xhc3MiLCJjaGVja0VtcHR5TGlzdCIsInJlc2V0IiwiZWxlbWVudCIsInVpZCIsInNldFBhcmVudCIsImRyYWdFbCIsImJ1dHRvbiIsInByZXZlbnREZWZhdWx0IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImFjdGlvbiIsIml0ZW0iLCJjbG9zZXN0IiwiY29sbGFwc2VJdGVtIiwiZXhwYW5kSXRlbSIsInRvZ2dsZUl0ZW0iLCJvblN0YXJ0RXZlbnQiLCJoYW5kbGUiLCJsaW5rIiwiaXMiLCJwYXJlbnRzIiwiX25vRHJhZ0NsYXNzIiwibGVuZ3RoIiwiaGFzQ2xhc3MiLCJfaGFuZGxlQ2xhc3MiLCJ0b3VjaGVzIiwib3JpZ2luYWxFdmVudCIsImV2dCIsImRlbGF5TW92ZSIsImRyYWdTdGFydCIsInRyaWdnZXIiLCJ4IiwicGFyc2VJbnQiLCJwYWdlWCIsInkiLCJwYWdlWSIsIm9uZSIsInRyaW0iLCJsb2NhdGlvbiIsImhyZWYiLCJvbk1vdmVFdmVudCIsImFicyIsImdldFNlbGVjdGlvbiIsInRvU3RyaW5nIiwiZHJhZ01vdmUiLCJvbkVuZEV2ZW50IiwiZHJhZ1N0b3AiLCJhZGRFdmVudExpc3RlbmVyIiwic2VyaWFsaXplIiwibGlzdCIsInN0ZXAiLCJsZXZlbCIsImRlcHRoIiwiYXJyYXkiLCJjaGlsZHJlbiIsImF0dHJpYnV0ZSIsInZhbCIsImxpIiwic3ViIiwiX2xpc3RDbGFzcyIsImkiLCJhdHRyaWJ1dGVzIiwibmFtZSIsInN1YnN0ciIsInN0cjJqc29uIiwidmFsdWUiLCJwdXNoIiwicGFyZW50IiwiaW5kZXgiLCJleHRlbmQiLCJwYXJlbnRfaWQiLCJvcmRlciIsImlkUHJvcGVydHkiLCJtb3VzZSIsIm9mZnNldFgiLCJvZmZzZXRZIiwic3RhcnRYIiwic3RhcnRZIiwibGFzdFgiLCJsYXN0WSIsIm5vd1giLCJub3dZIiwiZGlzdFgiLCJkaXN0WSIsImRpckF4IiwiZGlyWCIsImRpclkiLCJsYXN0RGlyWCIsImxhc3REaXJZIiwiZGlzdEF4WCIsImRpc3RBeFkiLCJtb3ZpbmciLCJkcmFnUm9vdEVsIiwiZHJhZ0RlcHRoIiwiaGFzTmV3Um9vdCIsInBvaW50RWwiLCJyZW1vdmVDbGFzcyIsImV4cGFuZEFsbCIsImNvbGxhcHNlQWxsIiwidW5zZXRQYXJlbnQiLCJyZW1vdmUiLCJkcmFnSXRlbSIsInBsYWNlRWwiLCJsZWZ0IiwiYXBwZW5kIiwiY2xvbmUiLCJjc3MiLCJ3aWR0aCIsInRtcERyYWdPblNpYmxpbmdzIiwicHJldmlvdXNTaWJsaW5nIiwibmV4dFNpYmxpbmciLCIkYm9keSIsIml0ZW1zIiwiX2xpc3RCYXNlQ2xhc3MiLCJlbCIsInJvb3QiLCJwcmV2Iiwib3B0IiwibmV3QXgiLCJsYXN0IiwibmV4dCIsInBhcmVudFVsIiwiam9pbiIsInN1cnJvdW5kaW5nTGkiLCJhZnRlciIsImlzRW1wdHkiLCJwb2ludFgiLCJwYWdlWE9mZnNldCIsImRvY3VtZW50Iiwic2Nyb2xsTGVmdCIsInBvaW50WSIsInBhZ2VZT2Zmc2V0IiwiZG9jdW1lbnRFbGVtZW50IiwiZWxlbWVudEZyb21Qb2ludCIsIm5lc3RhYmxlaXRlbSIsInBvaW50RWxSb290IiwidG1wUm9vdCIsImlzTmV3Um9vdCIsImJlZm9yZSJdLCJtYXBwaW5ncyI6IkNBSUEsU0FBVUEsR0FFTixJQUFJQyxFQUVBQyxPQUFPQyxTQUNQRixFQUFZRCxFQUFNRyxTQUdELG1CQUFWQyxRQUF3QkEsT0FBT0MsS0FDdENELE9BQU8saUJBQWtCLENBQUMsU0FBVSxXQUNoQyxPQUFPSCxHQUFhRCxFQUFNRyxVQVZ0QyxDQWNHLFNBQVNHLEdBRVIsYUFFQSxJQUlJQyxFQUpBQyxFQUFlLGlCQUFrQk4sT0FDakNPLEVBQWVILEVBQUdJLE1BQ2xCQyxFQUFlLEdBQ2ZDLEVBQWVOLEVBQUdNLEtBR2xCQyxFQUFVTCxFQUFXLGFBQWdCLFlBQ3JDTSxFQUFVTixFQUFXLFlBQWdCLFlBQ3JDTyxFQUFVUCxFQUFXLFdBQWdCLFVBQ3JDUSxFQUFVUixFQUFXLGNBQWdCLFVBNG1CekMsT0F6bUJBRixFQUFHTCxVQUFVLFdBQVksQ0FFckJnQixTQUFVLENBQ05DLGNBQWtCLGNBQ2xCQyxVQUFrQixtQkFDbEJDLGNBQWtCLG1CQUNsQkMsVUFBa0Isc0JBQ2xCQyxZQUFrQixxQkFDbEJDLGdCQUFrQix5QkFDbEJDLFdBQWtCLG9CQUNsQkMsWUFBa0IsR0FDbEJDLGVBQWtCLGVBQ2xCQyxpQkFBa0IsMEJBQ2xCQyxZQUFrQixxQkFDbEJDLE9BQWtCLEVBQ2xCQyxTQUFrQixHQUNsQkMsVUFBa0IsR0FD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LE9BQVNxRCxHQUFhWixFQUFTLENBR3RDLEdBQUlZLEdBQWFwQixFQUFJekosUUFBVTRLLEVBQVF4SixLQUFLLGtCQUN4QyxPQVFKLEdBTkl0QyxFQUFhd0gsS0FBS3FFLEdBTVYxSyxFQUZKa0IsS0FBSzhHLFVBQVksRUFBSTlHLEtBQUtnSCxRQUFRM0UsUUFBUWlHLEVBQUkxRCxXQUFXLElBQUkwRCxFQUFJSixnQkFBZ0IzRixPQUdyRixPQUdKLElBQUlvSCxFQUFTeEssRUFBRWlFLE1BQVNwRCxLQUFLZ0gsUUFBUTNILFNBQVNELElBQU1ZLEtBQUtnSCxRQUFRdkgsU0FBVyxFQUU1RTJGLEVBQVNwRixLQUFLdUgsUUFBUW5DLFNBRWxCMEQsRUFDQTlJLEtBQUtnSCxRQUFRUyxPQUFPekgsS0FBS3VILFNBQ2xCb0MsRUFDUDNKLEtBQUtnSCxRQUFRMkMsT0FBTzNKLEtBQUt1SCxTQUV6QnZILEtBQUtnSCxRQUFRNkIsTUFBTTdJLEtBQUt1SCxTQUd2Qm5DLEVBQU9iLFdBQVdoQyxRQUNkNkMsRUFBT25GLEtBQUssYUFBYUQsS0FBS29ILFlBQVloQyxFQUFPQSxVQUcxRHBGLEtBQUtpQixlQUFlakIsS0FBSzZHLFlBQ3pCN0csS0FBS2lCLGVBQWV1SSxHQUdoQkUsSUFDQTFKLEtBQUs2RyxXQUFhNEMsRUFDbEJ6SixLQUFLK0csV0FBYS9HLEtBQUttQixRQUFRLEtBQU9uQixLQUFLNkcsV0FBVyxPQUtsRTVGLGVBQWdCLFNBQVNpRCxHQUVyQkEsRUFBUUEsRUFBTzVHLEVBQUd1QyxFQUFFcUUsR0FBUWxFLEtBQUttQixRQUU3Qm5CLEtBQUtJLFFBQVE1QixZQUNiMEYsRUFBTUEsRUFBS0ssV0FBV2hDLE9BQW9CLGNBQVgsWUFBMEJ2QyxLQUFLSSxRQUFRNUIsZUFNM0VsQixFQUFHNEMiLCJmaWxlIjoiY29tcG9uZW50cy9uZXN0YWJsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBVSWtpdCAyLjI3LjIgfCBodHRwOi8vd3d3LmdldHVpa2l0LmNvbSB8IChjKSAyMDE0IFlPT3RoZW1lIHwgTUlUIExpY2Vuc2UgKi9cclxuLypcclxuICogQmFzZWQgb24gTmVzdGFibGUgalF1ZXJ5IFBsdWdpbiAtIENvcHlyaWdodCAoYykgMjAxMiBEYXZpZCBCdXNoZWxsIC0gaHR0cDovL2RidXNoZWxsLmNvbS9cclxuICovXHJcbihmdW5jdGlvbihhZGRvbikge1xyXG5cclxuICAgIHZhciBjb21wb25lbnQ7XHJcblxyXG4gICAgaWYgKHdpbmRvdy5VSWtpdDIpIHtcclxuICAgICAgICBjb21wb25lbnQgPSBhZGRvbihVSWtpdDIpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgICAgIGRlZmluZSgndWlraXQtbmVzdGFibGUnLCBbJ3Vpa2l0J10sIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQgfHwgYWRkb24oVUlraXQyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn0pKGZ1bmN0aW9uKFVJKSB7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIGhhc1RvdWNoICAgICA9ICdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdyxcclxuICAgICAgICBodG1sICAgICAgICAgPSBVSS4kaHRtbCxcclxuICAgICAgICB0b3VjaGVkbGlzdHMgPSBbXSxcclxuICAgICAgICAkd2luICAgICAgICAgPSBVSS4kd2luLFxyXG4gICAgICAgIGRyYWdnaW5nRWxlbWVudDtcclxuXHJcbiAgICB2YXIgZVN0YXJ0ICA9IGhhc1RvdWNoID8gJ3RvdWNoc3RhcnQnICA6ICdtb3VzZWRvd24nLFxyXG4gICAgICAgIGVNb3ZlICAgPSBoYXNUb3VjaCA/ICd0b3VjaG1vdmUnICAgOiAnbW91c2Vtb3ZlJyxcclxuICAgICAgICBlRW5kICAgID0gaGFzVG91Y2ggPyAndG91Y2hlbmQnICAgIDogJ21vdXNldXAnLFxyXG4gICAgICAgIGVDYW5jZWwgPSBoYXNUb3VjaCA/ICd0b3VjaGNhbmNlbCcgOiAnbW91c2V1cCc7XHJcblxyXG5cclxuICAgIFVJLmNvbXBvbmVudCgnbmVzdGFibGUnLCB7XHJcblxyXG4gICAgICAgIGRlZmF1bHRzOiB7XHJcbiAgICAgICAgICAgIGxpc3RCYXNlQ2xhc3MgICA6ICd1ay1uZXN0YWJsZScsXHJcbiAgICAgICAgICAgIGxpc3RDbGFzcyAgICAgICA6ICd1ay1uZXN0YWJsZS1saXN0JyxcclxuICAgICAgICAgICAgbGlzdEl0ZW1DbGFzcyAgIDogJ3VrLW5lc3RhYmxlLWl0ZW0nLFxyXG4gICAgICAgICAgICBkcmFnQ2xhc3MgICAgICAgOiAndWstbmVzdGFibGUtZHJhZ2dlZCcsXHJcbiAgICAgICAgICAgIG1vdmluZ0NsYXNzICAgICA6ICd1ay1uZXN0YWJsZS1tb3ZpbmcnLFxyXG4gICAgICAgICAgICBub0NoaWxkcmVuQ2xhc3MgOiAndWstbmVzdGFibGUtbm9jaGlsZHJlbicsXHJcbiAgICAgICAgICAgIGVtcHR5Q2xhc3MgICAgICA6ICd1ay1uZXN0YWJsZS1lbXB0eScsXHJcbiAgICAgICAgICAgIGhhbmRsZUNsYXNzICAgICA6ICcnLFxyXG4gICAgICAgICAgICBjb2xsYXBzZWRDbGFzcyAgOiAndWstY29sbGFwc2VkJyxcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXJDbGFzczogJ3VrLW5lc3RhYmxlLXBsYWNlaG9sZGVyJyxcclxuICAgICAgICAgICAgbm9EcmFnQ2xhc3MgICAgIDogJ3VrLW5lc3RhYmxlLW5vZHJhZycsXHJcbiAgICAgICAgICAgIGdyb3VwICAgICAgICAgICA6IGZhbHNlLFxyXG4gICAgICAgICAgICBtYXhEZXB0aCAgICAgICAgOiAxMCxcclxuICAgICAgICAgICAgdGhyZXNob2xkICAgICAgIDogMjAsXHJcbiAgICAgICAgICAgIGlkbGV0aHJlc2hvbGQgICA6IDEwLFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGJvb3Q6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgLy8gYWRqdXN0IGRvY3VtZW50IHNjcm9sbGluZ1xyXG4gICAgICAgICAgICBVSS4kaHRtbC5vbignbW91c2Vtb3ZlIHRvdWNobW92ZScsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZHJhZ2dpbmdFbGVtZW50KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSBkcmFnZ2luZ0VsZW1lbnQub2Zmc2V0KCkudG9wO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAodG9wIDwgVUkuJHdpbi5zY3JvbGxUb3AoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBVSS4kd2luLnNjcm9sbFRvcChVSS4kd2luLnNjcm9sbFRvcCgpIC0gTWF0aC5jZWlsKGRyYWdnaW5nRWxlbWVudC5oZWlnaHQoKS8yKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggKHRvcCArIGRyYWdnaW5nRWxlbWVudC5oZWlnaHQoKSkgPiAod2luZG93LmlubmVySGVpZ2h0ICsgVUkuJHdpbi5zY3JvbGxUb3AoKSkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVJLiR3aW4uc2Nyb2xsVG9wKFVJLiR3aW4uc2Nyb2xsVG9wKCkgKyBNYXRoLmNlaWwoZHJhZ2dpbmdFbGVtZW50LmhlaWdodCgpLzIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gaW5pdCBjb2RlXHJcbiAgICAgICAgICAgIFVJLnJlYWR5KGZ1bmN0aW9uKGNvbnRleHQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBVSS4kKFwiW2RhdGEtdWstbmVzdGFibGVdXCIsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZSA9IFVJLiQodGhpcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZWxlLmRhdGEoXCJuZXN0YWJsZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBVSS5uZXN0YWJsZShlbGUsIFVJLlV0aWxzLm9wdGlvbnMoZWxlLmF0dHIoXCJkYXRhLXVrLW5lc3RhYmxlXCIpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgdmFyICR0aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMub3B0aW9ucykuZm9yRWFjaChmdW5jdGlvbihrZXkpe1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKFN0cmluZyhrZXkpLmluZGV4T2YoJ0NsYXNzJykhPS0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMub3B0aW9uc1snXycra2V5XSA9ICcuJyArICR0aGlzLm9wdGlvbnNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZpbmQodGhpcy5vcHRpb25zLl9saXN0SXRlbUNsYXNzKS5maW5kKFwiPnVsXCIpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5saXN0Q2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jaGVja0VtcHR5TGlzdCgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGF0YSgnbmVzdGFibGUtZ3JvdXAnLCB0aGlzLm9wdGlvbnMuZ3JvdXAgfHwgVUkuVXRpbHMudWlkKCduZXN0YWJsZS1ncm91cCcpKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmluZCh0aGlzLm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5zZXRQYXJlbnQoVUkuJCh0aGlzKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5vbignY2xpY2snLCAnW2RhdGEtbmVzdGFibGUtYWN0aW9uXScsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMuZHJhZ0VsIHx8ICghaGFzVG91Y2ggJiYgZS5idXR0b24gIT09IDApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gVUkuJChlLmN1cnJlbnRUYXJnZXQpLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IHRhcmdldC5kYXRhKCduZXN0YWJsZUFjdGlvbicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0gICA9IHRhcmdldC5jbG9zZXN0KCR0aGlzLm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdjb2xsYXBzZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5jb2xsYXBzZUl0ZW0oaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnZXhwYW5kJykge1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmV4cGFuZEl0ZW0oaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAndG9nZ2xlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLnRvZ2dsZUl0ZW0oaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIG9uU3RhcnRFdmVudCA9IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlID0gVUkuJChlLnRhcmdldCksXHJcbiAgICAgICAgICAgICAgICAgICAgbGluayAgID0gaGFuZGxlLmlzKCdhW2hyZWZdJykgPyBoYW5kbGU6aGFuZGxlLnBhcmVudHMoJ2FbaHJlZl0nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09ICR0aGlzLmVsZW1lbnRbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhbmRsZS5pcygkdGhpcy5vcHRpb25zLl9ub0RyYWdDbGFzcykgfHwgaGFuZGxlLmNsb3Nlc3QoJHRoaXMub3B0aW9ucy5fbm9EcmFnQ2xhc3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlLmlzKCdbZGF0YS1uZXN0YWJsZS1hY3Rpb25dJykgfHwgaGFuZGxlLmNsb3Nlc3QoJ1tkYXRhLW5lc3RhYmxlLWFjdGlvbl0nKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCR0aGlzLm9wdGlvbnMuaGFuZGxlQ2xhc3MgJiYgIWhhbmRsZS5oYXNDbGFzcygkdGhpcy5vcHRpb25zLmhhbmRsZUNsYXNzKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHRoaXMub3B0aW9ucy5oYW5kbGVDbGFzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGUgPSBoYW5kbGUuY2xvc2VzdCgkdGhpcy5vcHRpb25zLl9oYW5kbGVDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghaGFuZGxlLmxlbmd0aCB8fCAkdGhpcy5kcmFnRWwgfHwgKCFoYXNUb3VjaCAmJiBlLmJ1dHRvbiAhPT0gMCkgfHwgKGhhc1RvdWNoICYmIGUudG91Y2hlcy5sZW5ndGggIT09IDEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlLm9yaWdpbmFsRXZlbnQgJiYgZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gZXZ0Lm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkdGhpcy5kZWxheU1vdmUgPSBmdW5jdGlvbihldnQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGluayA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5kcmFnU3RhcnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMudHJpZ2dlcignc3RhcnQudWsubmVzdGFibGUnLCBbJHRoaXNdKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXMuZGVsYXlNb3ZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICR0aGlzLmRlbGF5TW92ZS54ICAgICAgICAgPSBwYXJzZUludChlLnBhZ2VYLCAxMCk7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5kZWxheU1vdmUueSAgICAgICAgID0gcGFyc2VJbnQoZS5wYWdlWSwgMTApO1xyXG4gICAgICAgICAgICAgICAgJHRoaXMuZGVsYXlNb3ZlLnRocmVzaG9sZCA9ICR0aGlzLm9wdGlvbnMuaWRsZXRocmVzaG9sZDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobGluay5sZW5ndGggJiYgZUVuZCA9PSAndG91Y2hlbmQnKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLm9uZShlRW5kLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluayAmJiBsaW5rLmF0dHIoJ2hyZWYnKS50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBsaW5rLmF0dHIoJ2hyZWYnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBvbk1vdmVFdmVudCA9IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZS5vcmlnaW5hbEV2ZW50ICYmIGUub3JpZ2luYWxFdmVudC50b3VjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICgkdGhpcy5kZWxheU1vdmUgJiYgKE1hdGguYWJzKGUucGFnZVggLSAkdGhpcy5kZWxheU1vdmUueCkgPiAkdGhpcy5kZWxheU1vdmUudGhyZXNob2xkIHx8IE1hdGguYWJzKGUucGFnZVkgLSAkdGhpcy5kZWxheU1vdmUueSkgPiAkdGhpcy5kZWxheU1vdmUudGhyZXNob2xkKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmRlbGF5TW92ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5kZWxheU1vdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCR0aGlzLmRyYWdFbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5kcmFnTW92ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCdtb3ZlLnVrLm5lc3RhYmxlJywgWyR0aGlzXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgb25FbmRFdmVudCA9IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMuZHJhZ0VsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmRyYWdTdG9wKGhhc1RvdWNoID8gZS50b3VjaGVzWzBdIDogZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZHJhZ2dpbmdFbGVtZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5kZWxheU1vdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChoYXNUb3VjaCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50WzBdLmFkZEV2ZW50TGlzdGVuZXIoZVN0YXJ0LCBvblN0YXJ0RXZlbnQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGVNb3ZlLCBvbk1vdmVFdmVudCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZUVuZCwgb25FbmRFdmVudCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZUNhbmNlbCwgb25FbmRFdmVudCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihlU3RhcnQsIG9uU3RhcnRFdmVudCk7XHJcbiAgICAgICAgICAgICAgICAkd2luLm9uKGVNb3ZlLCBvbk1vdmVFdmVudCk7XHJcbiAgICAgICAgICAgICAgICAkd2luLm9uKGVFbmQsIG9uRW5kRXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YSxcclxuICAgICAgICAgICAgICAgIGRlcHRoID0gMCxcclxuICAgICAgICAgICAgICAgIGxpc3QgID0gdGhpcyxcclxuICAgICAgICAgICAgICAgIHN0ZXAgID0gZnVuY3Rpb24obGV2ZWwsIGRlcHRoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhcnJheSA9IFsgXSwgaXRlbXMgPSBsZXZlbC5jaGlsZHJlbihsaXN0Lm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpdGVtcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpICAgID0gVUkuJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gID0ge30sIGF0dHJpYnV0ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YiAgID0gbGkuY2hpbGRyZW4obGlzdC5vcHRpb25zLl9saXN0Q2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGF0dHIsIHZhbDsgaSA8IGxpWzBdLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZSA9IGxpWzBdLmF0dHJpYnV0ZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUuaW5kZXhPZignZGF0YS0nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgICAgICAgPSBhdHRyaWJ1dGUubmFtZS5zdWJzdHIoNSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsICAgICAgICA9ICBVSS5VdGlscy5zdHIyanNvbihhdHRyaWJ1dGUudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1bYXR0cl0gPSAodmFsIHx8IGF0dHJpYnV0ZS52YWx1ZT09J2ZhbHNlJyB8fCBhdHRyaWJ1dGUudmFsdWU9PScwJykgPyB2YWw6YXR0cmlidXRlLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5jaGlsZHJlbiA9IHN0ZXAoc3ViLCBkZXB0aCArIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheS5wdXNoKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZGF0YSA9IHN0ZXAobGlzdC5lbGVtZW50LCBkZXB0aCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBsaXN0OiBmdW5jdGlvbihvcHRpb25zKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YSAgPSBbXSxcclxuICAgICAgICAgICAgICAgIGxpc3QgID0gdGhpcyxcclxuICAgICAgICAgICAgICAgIGRlcHRoID0gMCxcclxuICAgICAgICAgICAgICAgIHN0ZXAgID0gZnVuY3Rpb24obGV2ZWwsIGRlcHRoLCBwYXJlbnQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gbGV2ZWwuY2hpbGRyZW4ob3B0aW9ucy5fbGlzdEl0ZW1DbGFzcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zLmVhY2goZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpICAgPSBVSS4kKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IFVJLiQuZXh0ZW5kKHtwYXJlbnRfaWQ6IChwYXJlbnQgPyBwYXJlbnQgOiBudWxsKSwgZGVwdGg6IGRlcHRoLCBvcmRlcjogaW5kZXh9LCBsaS5kYXRhKCkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViICA9IGxpLmNoaWxkcmVuKG9wdGlvbnMuX2xpc3RDbGFzcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2goaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcChzdWIsIGRlcHRoICsgMSwgbGkuZGF0YShvcHRpb25zLmlkUHJvcGVydHkgfHwgJ2lkJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgb3B0aW9ucyA9IFVJLiQuZXh0ZW5kKHt9LCBsaXN0Lm9wdGlvbnMsIG9wdGlvbnMpO1xyXG5cclxuICAgICAgICAgICAgc3RlcChsaXN0LmVsZW1lbnQsIGRlcHRoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubW91c2UgPSB7XHJcbiAgICAgICAgICAgICAgICBvZmZzZXRYICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0WSAgIDogMCxcclxuICAgICAgICAgICAgICAgIHN0YXJ0WCAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICBzdGFydFkgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgbGFzdFggICAgIDogMCxcclxuICAgICAgICAgICAgICAgIGxhc3RZICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICBub3dYICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgbm93WSAgICAgIDogMCxcclxuICAgICAgICAgICAgICAgIGRpc3RYICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICBkaXN0WSAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgZGlyQXggICAgIDogMCxcclxuICAgICAgICAgICAgICAgIGRpclggICAgICA6IDAsXHJcbiAgICAgICAgICAgICAgICBkaXJZICAgICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgbGFzdERpclggIDogMCxcclxuICAgICAgICAgICAgICAgIGxhc3REaXJZICA6IDAsXHJcbiAgICAgICAgICAgICAgICBkaXN0QXhYICAgOiAwLFxyXG4gICAgICAgICAgICAgICAgZGlzdEF4WSAgIDogMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLm1vdmluZyAgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5kcmFnRWwgICAgID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5kcmFnUm9vdEVsID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5kcmFnRGVwdGggID0gMDtcclxuICAgICAgICAgICAgdGhpcy5oYXNOZXdSb290ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMucG9pbnRFbCAgICA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8dG91Y2hlZGxpc3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrRW1wdHlMaXN0KHRvdWNoZWRsaXN0c1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvdWNoZWRsaXN0cyA9IFtdO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHRvZ2dsZUl0ZW06IGZ1bmN0aW9uKGxpKSB7XHJcbiAgICAgICAgICAgIHRoaXNbbGkuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmNvbGxhcHNlZENsYXNzKSA/ICdleHBhbmRJdGVtJzonY29sbGFwc2VJdGVtJ10obGkpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGV4cGFuZEl0ZW06IGZ1bmN0aW9uKGxpKSB7XHJcbiAgICAgICAgICAgIGxpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5jb2xsYXBzZWRDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY29sbGFwc2VJdGVtOiBmdW5jdGlvbihsaSkge1xyXG4gICAgICAgICAgICB2YXIgbGlzdHMgPSBsaS5jaGlsZHJlbih0aGlzLm9wdGlvbnMuX2xpc3RDbGFzcyk7XHJcbiAgICAgICAgICAgIGlmIChsaXN0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGxpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5jb2xsYXBzZWRDbGFzcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBleHBhbmRBbGw6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZmluZChsaXN0Lm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0LmV4cGFuZEl0ZW0oVUkuJCh0aGlzKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGNvbGxhcHNlQWxsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLmZpbmQobGlzdC5vcHRpb25zLl9saXN0SXRlbUNsYXNzKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbGlzdC5jb2xsYXBzZUl0ZW0oVUkuJCh0aGlzKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNldFBhcmVudDogZnVuY3Rpb24obGkpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChsaS5jaGlsZHJlbih0aGlzLm9wdGlvbnMuX2xpc3RDbGFzcykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBsaS5hZGRDbGFzcygndWstcGFyZW50Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB1bnNldFBhcmVudDogZnVuY3Rpb24obGkpIHtcclxuICAgICAgICAgICAgbGkucmVtb3ZlQ2xhc3MoJ3VrLXBhcmVudCAnK3RoaXMub3B0aW9ucy5jb2xsYXBzZWRDbGFzcyk7XHJcbiAgICAgICAgICAgIGxpLmNoaWxkcmVuKHRoaXMub3B0aW9ucy5fbGlzdENsYXNzKS5yZW1vdmUoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBkcmFnU3RhcnQ6IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBtb3VzZSAgICA9IHRoaXMubW91c2UsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgICA9IFVJLiQoZS50YXJnZXQpLFxyXG4gICAgICAgICAgICAgICAgZHJhZ0l0ZW0gPSB0YXJnZXQuY2xvc2VzdCh0aGlzLm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICAgPSBkcmFnSXRlbS5vZmZzZXQoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VFbCA9IGRyYWdJdGVtO1xyXG5cclxuICAgICAgICAgICAgbW91c2Uub2Zmc2V0WCA9IGUucGFnZVggLSBvZmZzZXQubGVmdDtcclxuICAgICAgICAgICAgbW91c2Uub2Zmc2V0WSA9IGUucGFnZVkgLSBvZmZzZXQudG9wO1xyXG5cclxuICAgICAgICAgICAgbW91c2Uuc3RhcnRYID0gbW91c2UubGFzdFggPSBvZmZzZXQubGVmdDtcclxuICAgICAgICAgICAgbW91c2Uuc3RhcnRZID0gbW91c2UubGFzdFkgPSBvZmZzZXQudG9wO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kcmFnUm9vdEVsID0gdGhpcy5lbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kcmFnRWwgPSBVSS4kKCc8dWw+PC91bD4nKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubGlzdENsYXNzICsgJyAnICsgdGhpcy5vcHRpb25zLmRyYWdDbGFzcykuYXBwZW5kKGRyYWdJdGVtLmNsb25lKCkpO1xyXG4gICAgICAgICAgICB0aGlzLmRyYWdFbC5jc3MoJ3dpZHRoJywgZHJhZ0l0ZW0ud2lkdGgoKSk7XHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VFbC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJDbGFzcyk7XHJcblxyXG4gICAgICAgICAgICBkcmFnZ2luZ0VsZW1lbnQgPSB0aGlzLmRyYWdFbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudG1wRHJhZ09uU2libGluZ3MgPSBbZHJhZ0l0ZW1bMF0ucHJldmlvdXNTaWJsaW5nLCBkcmFnSXRlbVswXS5uZXh0U2libGluZ107XHJcblxyXG4gICAgICAgICAgICBVSS4kYm9keS5hcHBlbmQodGhpcy5kcmFnRWwpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5kcmFnRWwuY3NzKHtcclxuICAgICAgICAgICAgICAgIGxlZnQgOiBvZmZzZXQubGVmdCxcclxuICAgICAgICAgICAgICAgIHRvcCAgOiBvZmZzZXQudG9wXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gdG90YWwgZGVwdGggb2YgZHJhZ2dpbmcgaXRlbVxyXG4gICAgICAgICAgICB2YXIgaSwgZGVwdGgsIGl0ZW1zID0gdGhpcy5kcmFnRWwuZmluZCh0aGlzLm9wdGlvbnMuX2xpc3RJdGVtQ2xhc3MpO1xyXG5cclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBkZXB0aCA9IFVJLiQoaXRlbXNbaV0pLnBhcmVudHModGhpcy5vcHRpb25zLl9saXN0Q2xhc3MrJywnK3RoaXMub3B0aW9ucy5fbGlzdEJhc2VDbGFzcykubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRlcHRoID4gdGhpcy5kcmFnRGVwdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYWdEZXB0aCA9IGRlcHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBodG1sLmFkZENsYXNzKHRoaXMub3B0aW9ucy5tb3ZpbmdDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZHJhZ1N0b3A6IGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciBlbCAgICAgICA9IFVJLiQodGhpcy5wbGFjZUVsKSxcclxuICAgICAgICAgICAgICAgIHJvb3QgICAgID0gdGhpcy5wbGFjZUVsLnBhcmVudHModGhpcy5vcHRpb25zLl9saXN0QmFzZUNsYXNzKyc6Zmlyc3QnKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxhY2VFbC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXJDbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudFswXSAhPT0gcm9vdFswXSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHJvb3QudHJpZ2dlcignY2hhbmdlLnVrLm5lc3RhYmxlJyxbcm9vdC5kYXRhKCduZXN0YWJsZScpLCBlbCwgJ2FkZGVkJ10pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoJ2NoYW5nZS51ay5uZXN0YWJsZScsIFt0aGlzLCBlbCwgJ3JlbW92ZWQnXSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoJ2NoYW5nZS51ay5uZXN0YWJsZScsW3RoaXMsIGVsLCBcIm1vdmVkXCJdKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdzdG9wLnVrLm5lc3RhYmxlJywgW3RoaXMsIGVsXSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XHJcblxyXG4gICAgICAgICAgICBodG1sLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5tb3ZpbmdDbGFzcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZHJhZ01vdmU6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGxpc3QsIHBhcmVudCwgcHJldiwgbmV4dCwgZGVwdGgsXHJcbiAgICAgICAgICAgICAgICBvcHQgICAgICA9IHRoaXMub3B0aW9ucyxcclxuICAgICAgICAgICAgICAgIG1vdXNlICAgID0gdGhpcy5tb3VzZSxcclxuICAgICAgICAgICAgICAgIG1heERlcHRoID0gdGhpcy5kcmFnUm9vdEVsID8gdGhpcy5kcmFnUm9vdEVsLmRhdGEoJ25lc3RhYmxlJykub3B0aW9ucy5tYXhEZXB0aCA6IG9wdC5tYXhEZXB0aDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZHJhZ0VsLmNzcyh7XHJcbiAgICAgICAgICAgICAgICBsZWZ0IDogZS5wYWdlWCAtIG1vdXNlLm9mZnNldFgsXHJcbiAgICAgICAgICAgICAgICB0b3AgIDogZS5wYWdlWSAtIG1vdXNlLm9mZnNldFlcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBtb3VzZSBwb3NpdGlvbiBsYXN0IGV2ZW50c1xyXG4gICAgICAgICAgICBtb3VzZS5sYXN0WCA9IG1vdXNlLm5vd1g7XHJcbiAgICAgICAgICAgIG1vdXNlLmxhc3RZID0gbW91c2Uubm93WTtcclxuICAgICAgICAgICAgLy8gbW91c2UgcG9zaXRpb24gdGhpcyBldmVudHNcclxuICAgICAgICAgICAgbW91c2Uubm93WCAgPSBlLnBhZ2VYO1xyXG4gICAgICAgICAgICBtb3VzZS5ub3dZICA9IGUucGFnZVk7XHJcbiAgICAgICAgICAgIC8vIGRpc3RhbmNlIG1vdXNlIG1vdmVkIGJldHdlZW4gZXZlbnRzXHJcbiAgICAgICAgICAgIG1vdXNlLmRpc3RYID0gbW91c2Uubm93WCAtIG1vdXNlLmxhc3RYO1xyXG4gICAgICAgICAgICBtb3VzZS5kaXN0WSA9IG1vdXNlLm5vd1kgLSBtb3VzZS5sYXN0WTtcclxuICAgICAgICAgICAgLy8gZGlyZWN0aW9uIG1vdXNlIHdhcyBtb3ZpbmdcclxuICAgICAgICAgICAgbW91c2UubGFzdERpclggPSBtb3VzZS5kaXJYO1xyXG4gICAgICAgICAgICBtb3VzZS5sYXN0RGlyWSA9IG1vdXNlLmRpclk7XHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGlvbiBtb3VzZSBpcyBub3cgbW92aW5nIChvbiBib3RoIGF4aXMpXHJcbiAgICAgICAgICAgIG1vdXNlLmRpclggPSBtb3VzZS5kaXN0WCA9PT0gMCA/IDAgOiBtb3VzZS5kaXN0WCA+IDAgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIG1vdXNlLmRpclkgPSBtb3VzZS5kaXN0WSA9PT0gMCA/IDAgOiBtb3VzZS5kaXN0WSA+IDAgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIC8vIGF4aXMgbW91c2UgaXMgbm93IG1vdmluZyBvblxyXG4gICAgICAgICAgICB2YXIgbmV3QXggICA9IE1hdGguYWJzKG1vdXNlLmRpc3RYKSA+IE1hdGguYWJzKG1vdXNlLmRpc3RZKSA/IDEgOiAwO1xyXG5cclxuICAgICAgICAgICAgLy8gZG8gbm90aGluZyBvbiBmaXJzdCBtb3ZlXHJcbiAgICAgICAgICAgIGlmICghbW91c2UubW92aW5nKSB7XHJcbiAgICAgICAgICAgICAgICBtb3VzZS5kaXJBeCAgPSBuZXdBeDtcclxuICAgICAgICAgICAgICAgIG1vdXNlLm1vdmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNhbGMgZGlzdGFuY2UgbW92ZWQgb24gdGhpcyBheGlzIChhbmQgZGlyZWN0aW9uKVxyXG4gICAgICAgICAgICBpZiAobW91c2UuZGlyQXggIT09IG5ld0F4KSB7XHJcbiAgICAgICAgICAgICAgICBtb3VzZS5kaXN0QXhYID0gMDtcclxuICAgICAgICAgICAgICAgIG1vdXNlLmRpc3RBeFkgPSAwO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbW91c2UuZGlzdEF4WCArPSBNYXRoLmFicyhtb3VzZS5kaXN0WCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobW91c2UuZGlyWCAhPT0gMCAmJiBtb3VzZS5kaXJYICE9PSBtb3VzZS5sYXN0RGlyWCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlLmRpc3RBeFggPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbW91c2UuZGlzdEF4WSArPSBNYXRoLmFicyhtb3VzZS5kaXN0WSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobW91c2UuZGlyWSAhPT0gMCAmJiBtb3VzZS5kaXJZICE9PSBtb3VzZS5sYXN0RGlyWSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlLmRpc3RBeFkgPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1vdXNlLmRpckF4ID0gbmV3QXg7XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogbW92ZSBob3Jpem9udGFsXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBpZiAobW91c2UuZGlyQXggJiYgbW91c2UuZGlzdEF4WCA+PSBvcHQudGhyZXNob2xkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXNldCBtb3ZlIGRpc3RhbmNlIG9uIHgtYXhpcyBmb3IgbmV3IHBoYXNlXHJcbiAgICAgICAgICAgICAgICBtb3VzZS5kaXN0QXhYID0gMDtcclxuICAgICAgICAgICAgICAgIHByZXYgPSB0aGlzLnBsYWNlRWwucHJldignbGknKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpbmNyZWFzZSBob3Jpem9udGFsIGxldmVsIGlmIHByZXZpb3VzIHNpYmxpbmcgZXhpc3RzLCBpcyBub3QgY29sbGFwc2VkLCBhbmQgZG9lcyBub3QgaGF2ZSBhICdubyBjaGlsZHJlbicgY2xhc3NcclxuICAgICAgICAgICAgICAgIGlmIChtb3VzZS5kaXN0WCA+IDAgJiYgcHJldi5sZW5ndGggJiYgIXByZXYuaGFzQ2xhc3Mob3B0LmNvbGxhcHNlZENsYXNzKSAmJiAhcHJldi5oYXNDbGFzcyhvcHQubm9DaGlsZHJlbkNsYXNzKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBjYW5ub3QgaW5jcmVhc2UgbGV2ZWwgd2hlbiBpdGVtIGFib3ZlIGlzIGNvbGxhcHNlZFxyXG4gICAgICAgICAgICAgICAgICAgIGxpc3QgPSBwcmV2LmZpbmQob3B0Ll9saXN0Q2xhc3MpLmxhc3QoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgZGVwdGggbGltaXQgaGFzIHJlYWNoZWRcclxuICAgICAgICAgICAgICAgICAgICBkZXB0aCA9IHRoaXMucGxhY2VFbC5wYXJlbnRzKG9wdC5fbGlzdENsYXNzKycsJytvcHQuX2xpc3RCYXNlQ2xhc3MpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlcHRoICsgdGhpcy5kcmFnRGVwdGggPD0gbWF4RGVwdGgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgc3ViLWxldmVsIGlmIG9uZSBkb2Vzbid0IGV4aXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlzdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QgPSBVSS4kKCc8dWwvPicpLmFkZENsYXNzKG9wdC5saXN0Q2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQodGhpcy5wbGFjZUVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXYuYXBwZW5kKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQYXJlbnQocHJldik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIGFwcGVuZCB0byBuZXh0IGxldmVsIHVwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0ID0gcHJldi5jaGlsZHJlbihvcHQuX2xpc3RDbGFzcykubGFzdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQodGhpcy5wbGFjZUVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBkZWNyZWFzZSBob3Jpem9udGFsIGxldmVsXHJcbiAgICAgICAgICAgICAgICBpZiAobW91c2UuZGlzdFggPCAwKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIGNhbm5vdCBkZWNyZWFzZSB0aGUgbGV2ZWwgaWYgYW4gaXRlbSBwcmVjZWRlcyB0aGUgY3VycmVudCBvbmVcclxuICAgICAgICAgICAgICAgICAgICBuZXh0ID0gdGhpcy5wbGFjZUVsLm5leHQob3B0Ll9saXN0SXRlbUNsYXNzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5leHQubGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgcGFyZW50IHVsIG9mIHRoZSBsaXN0IGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudFVsID0gdGhpcy5wbGFjZUVsLmNsb3Nlc3QoW29wdC5fbGlzdEJhc2VDbGFzcywgb3B0Ll9saXN0Q2xhc3NdLmpvaW4oJywnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyeSB0byBnZXQgdGhlIGxpIHN1cnJvdW5kaW5nIHRoZSB1bFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3Vycm91bmRpbmdMaSA9IHBhcmVudFVsLmNsb3Nlc3Qob3B0Ll9saXN0SXRlbUNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSB1bCBpcyBpbnNpZGUgb2YgYSBsaSAobWVhbmluZyBpdCBpcyBuZXN0ZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdXJyb3VuZGluZ0xpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgY2FuIGRlY3JlYXNlIHRoZSBob3Jpem9udGFsIGxldmVsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXJyb3VuZGluZ0xpLmFmdGVyKHRoaXMucGxhY2VFbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcHJldmlvdXMgcGFyZW50IHVsIGlzIG5vdyBlbXB0eVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRVbC5jaGlsZHJlbigpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQYXJlbnQoc3Vycm91bmRpbmdMaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBpc0VtcHR5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAvLyBmaW5kIGxpc3QgaXRlbSB1bmRlciBjdXJzb3JcclxuICAgICAgICAgICAgdmFyIHBvaW50WCA9IGUucGFnZVggLSAod2luZG93LnBhZ2VYT2Zmc2V0IHx8IGRvY3VtZW50LnNjcm9sbExlZnQgfHwgMCksXHJcbiAgICAgICAgICAgICAgICBwb2ludFkgPSBlLnBhZ2VZIC0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgdGhpcy5wb2ludEVsID0gVUkuJChkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHBvaW50WCwgcG9pbnRZKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0LmhhbmRsZUNsYXNzICYmIHRoaXMucG9pbnRFbC5oYXNDbGFzcyhvcHQuaGFuZGxlQ2xhc3MpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsID0gdGhpcy5wb2ludEVsLmNsb3Nlc3Qob3B0Ll9saXN0SXRlbUNsYXNzKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG5lc3RhYmxlaXRlbSA9IHRoaXMucG9pbnRFbC5jbG9zZXN0KG9wdC5fbGlzdEl0ZW1DbGFzcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG5lc3RhYmxlaXRlbS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwgPSBuZXN0YWJsZWl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYWNlRWwuZmluZCh0aGlzLnBvaW50RWwpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5wb2ludEVsLmRhdGEoJ25lc3RhYmxlJykgJiYgIXRoaXMucG9pbnRFbC5jaGlsZHJlbigpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrRW1wdHlMaXN0KHRoaXMucG9pbnRFbCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucG9pbnRFbC5sZW5ndGggfHwgIXRoaXMucG9pbnRFbC5oYXNDbGFzcyhvcHQubGlzdEl0ZW1DbGFzcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZmluZCBwYXJlbnQgbGlzdCBvZiBpdGVtIHVuZGVyIGN1cnNvclxyXG4gICAgICAgICAgICB2YXIgcG9pbnRFbFJvb3QgPSB0aGlzLmVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICB0bXBSb290ICAgICA9IHRoaXMucG9pbnRFbC5jbG9zZXN0KHRoaXMub3B0aW9ucy5fbGlzdEJhc2VDbGFzcyksXHJcbiAgICAgICAgICAgICAgICBpc05ld1Jvb3QgICA9IHBvaW50RWxSb290WzBdICE9IHRtcFJvb3RbMF07XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogbW92ZSB2ZXJ0aWNhbFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYgKCFtb3VzZS5kaXJBeCB8fCBpc05ld1Jvb3QgfHwgaXNFbXB0eSkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGdyb3VwcyBtYXRjaCBpZiBkcmFnZ2luZyBvdmVyIG5ldyByb290XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOZXdSb290ICYmIG9wdC5ncm91cCAhPT0gdG1wUm9vdC5kYXRhKCduZXN0YWJsZS1ncm91cCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0b3VjaGVkbGlzdHMucHVzaChwb2ludEVsUm9vdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgZGVwdGggbGltaXRcclxuICAgICAgICAgICAgICAgIGRlcHRoID0gdGhpcy5kcmFnRGVwdGggLSAxICsgdGhpcy5wb2ludEVsLnBhcmVudHMob3B0Ll9saXN0Q2xhc3MrJywnK29wdC5fbGlzdEJhc2VDbGFzcykubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkZXB0aCA+IG1heERlcHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBiZWZvcmUgPSBlLnBhZ2VZIDwgKHRoaXMucG9pbnRFbC5vZmZzZXQoKS50b3AgKyB0aGlzLnBvaW50RWwuaGVpZ2h0KCkgLyAyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0aGlzLnBsYWNlRWwucGFyZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvaW50RWwuYXBwZW5kKHRoaXMucGxhY2VFbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZm9yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9pbnRFbC5iZWZvcmUodGhpcy5wbGFjZUVsKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2ludEVsLmFmdGVyKHRoaXMucGxhY2VFbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXJlbnQuY2hpbGRyZW4oKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudC5kYXRhKCduZXN0YWJsZScpKSB0aGlzLnVuc2V0UGFyZW50KHBhcmVudC5wYXJlbnQoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0VtcHR5TGlzdCh0aGlzLmRyYWdSb290RWwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0VtcHR5TGlzdChwb2ludEVsUm9vdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gcGFyZW50IHJvb3QgbGlzdCBoYXMgY2hhbmdlZFxyXG4gICAgICAgICAgICAgICAgaWYgKGlzTmV3Um9vdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1Jvb3RFbCA9IHRtcFJvb3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNOZXdSb290ID0gdGhpcy5lbGVtZW50WzBdICE9PSB0aGlzLmRyYWdSb290RWxbMF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjaGVja0VtcHR5TGlzdDogZnVuY3Rpb24obGlzdCkge1xyXG5cclxuICAgICAgICAgICAgbGlzdCAgPSBsaXN0ID8gVUkuJChsaXN0KSA6IHRoaXMuZWxlbWVudDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZW1wdHlDbGFzcykge1xyXG4gICAgICAgICAgICAgICAgbGlzdFshbGlzdC5jaGlsZHJlbigpLmxlbmd0aCA/ICdhZGRDbGFzcyc6J3JlbW92ZUNsYXNzJ10odGhpcy5vcHRpb25zLmVtcHR5Q2xhc3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBVSS5uZXN0YWJsZTtcclxufSk7Il19
