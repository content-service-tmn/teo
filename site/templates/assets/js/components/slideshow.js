!function(i){var t;window.UIkit2&&(t=i(UIkit2)),"function"==typeof define&&define.amd&&define("uikit-slideshow",["uikit"],function(){return t||i(UIkit2)})}(function(l){"use strict";var u,p=0;l.component("slideshow",{defaults:{animation:"fade",duration:500,height:"auto",start:0,autoplay:!1,autoplayInterval:7e3,videoautoplay:!0,videomute:!0,slices:15,pauseOnHover:!0,kenburns:!1,kenburnsanimations:["uk-animation-middle-left","uk-animation-top-right","uk-animation-bottom-left","uk-animation-top-center","","uk-animation-bottom-right"]},current:!1,interval:null,hovering:!1,boot:function(){l.ready(function(i){l.$("[data-uk-slideshow]",i).each(function(){var i=l.$(this);i.data("slideshow")||l.slideshow(i,l.Utils.options(i.attr("data-uk-slideshow")))})})},init:function(){var s=this;this.container=this.element.hasClass("uk-slideshow")?this.element:l.$(this.find(".uk-slideshow:first")),this.current=this.options.start,this.animating=!1,this.fixFullscreen=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&this.container.hasClass("uk-slideshow-fullscreen"),this.options.kenburns&&(this.kbanimduration=!0===this.options.kenburns?"15s":this.options.kenburns,String(this.kbanimduration).match(/(ms|s)$/)||(this.kbanimduration+="ms"),"string"==typeof this.options.kenburnsanimations&&(this.options.kenburnsanimations=this.options.kenburnsanimations.split(","))),this.update(),this.on("click.uk.slideshow","[data-uk-slideshow-item]",function(i){i.preventDefault();var t=l.$(this).attr("data-uk-slideshow-item");if(s.current!=t){switch(t){case"next":case"previous":s["next"==t?"next":"previous"]();break;default:s.show(parseInt(t,10))}s.stop()}}),l.$win.on("resize load",l.Utils.debounce(function(){s.resize(),s.fixFullscreen&&(s.container.css("height",window.innerHeight),s.slides.css("height",window.innerHeight))},100)),setTimeout(function(){s.resize()},80),this.options.autoplay&&this.start(),this.options.videoautoplay&&this.slides.eq(this.current).data("media")&&this.playmedia(this.slides.eq(this.current).data("media")),this.options.kenburns&&this.applyKenBurns(this.slides.eq(this.current)),this.container.on({mouseenter:function(){s.options.pauseOnHover&&(s.hovering=!0)},mouseleave:function(){s.hovering=!1}}),this.on("swipeRight swipeLeft",function(i){s["swipeLeft"==i.type?"next":"previous"]()}),this.on("display.uk.check",function(){s.element.is(":visible")&&(s.resize(),s.fixFullscreen&&(s.container.css("height",window.innerHeight),s.slides.css("height",window.innerHeight)))}),l.domObserve(this.element,function(i){s.container.children(":not([data-slideshow-slide])").not(".uk-slideshow-ghost").length&&s.update(!0)})},update:function(i){var u,h=this,c=0;this.slides=this.container.children(),this.slidesCount=this.slides.length,this.slides.eq(this.current).length||(this.current=0),this.slides.each(function(s){var i=l.$(this);if(!i.data("processed")){var e=i.children("img,video,iframe").eq(0),t="html";if(i.data("media",e),i.data("sizer",e),e.length){var a;switch(t=e[0].nodeName.toLowerCase(),e[0].nodeName){case"IMG":var n=l.$('<div class="uk-cover-background uk-position-cover"></div>').css({"background-image":"url("+e.attr("src")+")"});e.attr("width")&&e.attr("height")&&(a=l.$("<canvas></canvas>").attr({width:e.attr("width"),height:e.attr("height")}),e.replaceWith(a),e=a,a=void 0),e.css({width:"100%",height:"auto",opacity:0}),i.prepend(n).data("cover",n);break;case"IFRAME":var o=e[0].src,r="sw-"+ ++p;e.attr("src","").on("load",function(){if((s!==h.current||s==h.current&&!h.options.videoautoplay)&&h.pausemedia(e),h.options.videomute){h.mutemedia(e);var i=setInterval((t=0,function(){h.mutemedia(e),4<=++t&&clearInterval(i)}),250)}var t}).data("slideshow",h).attr("data-player-id",r).attr("src",[o,-1<o.indexOf("?")?"&":"?","enablejsapi=1&api=1&player_id="+r].join("")).addClass("uk-position-absolute"),l.support.touch||e.css("pointer-events","none"),a=!0,l.cover&&(l.cover(e),e.attr("data-uk-cover","{}"));break;case"VIDEO":e.addClass("uk-cover-object uk-position-absolute"),a=!0,h.options.videomute&&h.mutemedia(e)}if(a){u=l.$("<canvas></canvas>").attr({width:e[0].width,height:e[0].height});var d=l.$('<img style="width:100%;height:auto;">').attr("src",u[0].toDataURL());i.prepend(d),i.data("sizer",d)}}else i.data("sizer",i);h.hasKenBurns(i)&&i.data("cover").css({"-webkit-animation-duration":h.kbanimduration,"animation-duration":h.kbanimduration}),i.data("processed",++c),i.attr("data-slideshow-slide",t)}}),c&&(this.triggers=this.find("[data-uk-slideshow-item]"),this.slides.attr("aria-hidden","true").removeClass("uk-active").eq(this.current).addClass("uk-active").attr("aria-hidden","false"),this.triggers.filter('[data-uk-slideshow-item="'+this.current+'"]').addClass("uk-active")),i&&c&&this.resize()},resize:function(){if(!this.container.hasClass("uk-slideshow-fullscreen")){var i=this.options.height;"auto"===this.options.height&&(i=0,this.slides.css("height","").each(function(){i=Math.max(i,l.$(this).height())})),this.container.css("height",i),this.slides.css("height",i)}},show:function(i,t){if(!this.animating&&this.current!=i){this.animating=!0;var s=this,e=this.slides.eq(this.current),a=this.slides.eq(i),n=t||(this.current<i?1:-1),o=e.data("media"),r=u[this.options.animation]?this.options.animation:"fade",d=a.data("media");s.applyKenBurns(a),l.support.animation||(r="none"),e=l.$(e),a=l.$(a),s.trigger("beforeshow.uk.slideshow",[a,e,s]),u[r].apply(this,[e,a,n]).then(function(){s.animating&&(o&&o.is("video,iframe")&&s.pausemedia(o),d&&d.is("video,iframe")&&s.playmedia(d),a.addClass("uk-active").attr("aria-hidden","false"),e.removeClass("uk-active").attr("aria-hidden","true"),s.animating=!1,s.current=i,l.Utils.checkDisplay(a,'[class*="uk-animation-"]:not(.uk-cover-background.uk-position-cover)'),s.trigger("show.uk.slideshow",[a,e,s]))}),s.triggers.removeClass("uk-active"),s.triggers.filter('[data-uk-slideshow-item="'+i+'"]').addClass("uk-active")}},applyKenBurns:function(i){if(this.hasKenBurns(i)){var t=this.options.kenburnsanimations,s=this.kbindex||0;i.data("cover").attr("class","uk-cover-background uk-position-cover").width(),i.data("cover").addClass(["uk-animation-scale","uk-animation-reverse",t[s].trim()].join(" ")),this.kbindex=t[s+1]?s+1:0}},hasKenBurns:function(i){return this.options.kenburns&&i.data("cover")},next:function(){this.show(this.slides[this.current+1]?this.current+1:0,1)},previous:function(){this.show(this.slides[this.current-1]?this.current-1:this.slides.length-1,-1)},start:function(){this.stop();var i=this;this.interval=setInterval(function(){i.hovering||i.next()},this.options.autoplayInterval)},stop:function(){this.interval&&clearInterval(this.interval)},playmedia:function(i){if(i&&i[0])switch(i[0].nodeName){case"VIDEO":this.options.videomute||(i[0].muted=!1),i[0].play();break;case"IFRAME":this.options.videomute||i[0].contentWindow.postMessage('{ "event": "command", "func": "unmute", "method":"setVolume", "value":1}',"*"),i[0].contentWindow.postMessage('{ "event": "command", "func": "playVideo", "method":"play"}',"*")}},pausemedia:function(i){switch(i[0].nodeName){case"VIDEO":i[0].pause();break;case"IFRAME":i[0].contentWindow.postMessage('{ "event": "command", "func": "pauseVideo", "method":"pause"}',"*")}},mutemedia:function(i){switch(i[0].nodeName){case"VIDEO":i[0].muted=!0;break;case"IFRAME":i[0].contentWindow.postMessage('{ "event": "command", "func": "mute", "method":"setVolume", "value":0}',"*")}}}),u={none:function(){var i=l.$.Deferred();return i.resolve(),i.promise()},scroll:function(i,t,s){var e=l.$.Deferred();return i.css("animation-duration",this.options.duration+"ms"),t.css("animation-duration",this.options.duration+"ms"),t.css("opacity",1).one(l.support.animation.end,function(){i.css("opacity",0).removeClass(-1==s?"uk-slideshow-scroll-backward-out":"uk-slideshow-scroll-forward-out"),t.removeClass(-1==s?"uk-slideshow-scroll-backward-in":"uk-slideshow-scroll-forward-in"),e.resolve()}.bind(this)),i.addClass(-1==s?"uk-slideshow-scroll-backward-out":"uk-slideshow-scroll-forward-out"),t.addClass(-1==s?"uk-slideshow-scroll-backward-in":"uk-slideshow-scroll-forward-in"),t.width(),e.promise()},swipe:function(i,t,s){var e=l.$.Deferred();return i.css("animation-duration",this.options.duration+"ms"),t.css("animation-duration",this.options.duration+"ms"),t.css("opacity",1).one(l.support.animation.end,function(){i.css("opacity",0).removeClass(-1===s?"uk-slideshow-swipe-backward-out":"uk-slideshow-swipe-forward-out"),t.removeClass(-1===s?"uk-slideshow-swipe-backward-in":"uk-slideshow-swipe-forward-in"),e.resolve()}.bind(this)),i.addClass(-1==s?"uk-slideshow-swipe-backward-out":"uk-slideshow-swipe-forward-out"),t.addClass(-1==s?"uk-slideshow-swipe-backward-in":"uk-slideshow-swipe-forward-in"),t.width(),e.promise()},scale:function(i,t,s){var e=l.$.Deferred();return i.css("animation-duration",this.options.duration+"ms"),t.css("animation-duration",this.options.duration+"ms"),t.css("opacity",1),i.one(l.support.animation.end,function(){i.css("opacity",0).removeClass("uk-slideshow-scale-out"),e.resolve()}.bind(this)),i.addClass("uk-slideshow-scale-out"),i.width(),e.promise()},fade:function(i,t,s){var e=l.$.Deferred();return i.css("animation-duration",this.options.duration+"ms"),t.css("animation-duration",this.options.duration+"ms"),t.css("opacity",1),t.data("cover")||t.data("placeholder")||t.css("opacity",1).one(l.support.animation.end,function(){t.removeClass("uk-slideshow-fade-in")}).addClass("uk-slideshow-fade-in"),i.one(l.support.animation.end,function(){i.css("opacity",0).removeClass("uk-slideshow-fade-out"),e.resolve()}.bind(this)),i.addClass("uk-slideshow-fade-out"),i.width(),e.promise()}},l.slideshow.animations=u,window.addEventListener("message",function(i){var t,s=i.data;if("string"==typeof s)try{s=JSON.parse(s)}catch(i){s={}}i.origin&&-1<i.origin.indexOf("vimeo")&&"ready"==s.event&&s.player_id&&(t=l.$('[data-player-id="'+s.player_id+'"]')).length&&t.data("slideshow").mutemedia(t)},!1)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvc2xpZGVzaG93LmpzIl0sIm5hbWVzIjpbImFkZG9uIiwiY29tcG9uZW50Iiwid2luZG93IiwiVUlraXQyIiwiZGVmaW5lIiwiYW1kIiwiVUkiLCJBbmltYXRpb25zIiwicGxheWVySWQiLCJkZWZhdWx0cyIsImFuaW1hdGlvbiIsImR1cmF0aW9uIiwiaGVpZ2h0Iiwic3RhcnQiLCJhdXRvcGxheSIsImF1dG9wbGF5SW50ZXJ2YWwiLCJ2aWRlb2F1dG9wbGF5IiwidmlkZW9tdXRlIiwic2xpY2VzIiwicGF1c2VPbkhvdmVyIiwia2VuYnVybnMiLCJrZW5idXJuc2FuaW1hdGlvbnMiLCJjdXJyZW50IiwiaW50ZXJ2YWwiLCJob3ZlcmluZyIsImJvb3QiLCJyZWFkeSIsImNvbnRleHQiLCIkIiwiZWFjaCIsInNsaWRlc2hvdyIsInRoaXMiLCJkYXRhIiwiVXRpbHMiLCJvcHRpb25zIiwiYXR0ciIsImluaXQiLCIkdGhpcyIsImNvbnRhaW5lciIsImVsZW1lbnQiLCJoYXNDbGFzcyIsImZpbmQiLCJhbmltYXRpbmciLCJmaXhGdWxsc2NyZWVuIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibWF0Y2giLCJrYmFuaW1kdXJhdGlvbiIsIlN0cmluZyIsInNwbGl0IiwidXBkYXRlIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJzbGlkZSIsInNob3ciLCJwYXJzZUludCIsInN0b3AiLCIkd2luIiwiZGVib3VuY2UiLCJyZXNpemUiLCJjc3MiLCJpbm5lckhlaWdodCIsInNsaWRlcyIsInNldFRpbWVvdXQiLCJlcSIsInBsYXltZWRpYSIsImFwcGx5S2VuQnVybnMiLCJtb3VzZWVudGVyIiwibW91c2VsZWF2ZSIsInR5cGUiLCJpcyIsImRvbU9ic2VydmUiLCJjaGlsZHJlbiIsIm5vdCIsImxlbmd0aCIsImNhbnZhcyIsInByb2Nlc3NlZCIsInNsaWRlc0NvdW50IiwiaW5kZXgiLCJtZWRpYSIsInBsYWNlaG9sZGVyIiwibm9kZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsImNvdmVyIiwiYmFja2dyb3VuZC1pbWFnZSIsIndpZHRoIiwicmVwbGFjZVdpdGgiLCJ1bmRlZmluZWQiLCJvcGFjaXR5IiwicHJlcGVuZCIsInNyYyIsImlmcmFtZUlkIiwicGF1c2VtZWRpYSIsIm11dGVtZWRpYSIsImludiIsInNldEludGVydmFsIiwiaWMiLCJjbGVhckludGVydmFsIiwiaW5kZXhPZiIsImpvaW4iLCJhZGRDbGFzcyIsInN1cHBvcnQiLCJ0b3VjaCIsImltZyIsInRvRGF0YVVSTCIsImhhc0tlbkJ1cm5zIiwiLXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb24iLCJhbmltYXRpb24tZHVyYXRpb24iLCJ0cmlnZ2VycyIsInJlbW92ZUNsYXNzIiwiZmlsdGVyIiwiTWF0aCIsIm1heCIsImRpcmVjdGlvbiIsIm5leHQiLCJkaXIiLCJjdXJyZW50bWVkaWEiLCJuZXh0bWVkaWEiLCJ0cmlnZ2VyIiwiYXBwbHkiLCJ0aGVuIiwiY2hlY2tEaXNwbGF5IiwiYW5pbWF0aW9ucyIsImtiaW5kZXgiLCJ0cmltIiwicHJldmlvdXMiLCJtdXRlZCIsInBsYXkiLCJjb250ZW50V2luZG93IiwicG9zdE1lc3NhZ2UiLCJwYXVzZSIsIm5vbmUiLCJkIiwiRGVmZXJyZWQiLCJyZXNvbHZlIiwicHJvbWlzZSIsInNjcm9sbCIsIm9uZSIsImVuZCIsImJpbmQiLCJzd2lwZSIsInNjYWxlIiwiZmFkZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJpZnJhbWUiLCJKU09OIiwicGFyc2UiLCJlcnIiLCJvcmlnaW4iLCJldmVudCIsInBsYXllcl9pZCJdLCJtYXBwaW5ncyI6IkNBQ0EsU0FBVUEsR0FFTixJQUFJQyxFQUVBQyxPQUFPQyxTQUNQRixFQUFZRCxFQUFNRyxTQUdELG1CQUFWQyxRQUF3QkEsT0FBT0MsS0FDdENELE9BQU8sa0JBQW1CLENBQUMsU0FBVSxXQUNqQyxPQUFPSCxHQUFhRCxFQUFNRyxVQVZ0QyxDQWNHLFNBQVNHLEdBRVIsYUFFQSxJQUFJQyxFQUFZQyxFQUFXLEVBRTNC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RixFQUFLbkYsS0FBSyxnQkFFbENtRixFQUFLdEQsSUFBSSxVQUFXLEdBQUc2RSxJQUFJcEksRUFBR2dHLFFBQVE1RixVQUFVaUksSUFBSyxXQUNqRHhCLEVBQUtMLFlBQVksMEJBQ2xCVCxTQUFTLHdCQUdoQi9FLEVBQVFvSCxJQUFJcEksRUFBR2dHLFFBQVE1RixVQUFVaUksSUFBSyxXQUVsQ3JILEVBQVF1QyxJQUFJLFVBQVcsR0FBR2lELFlBQVkseUJBQ3RDdUIsRUFBRUUsV0FFSkssS0FBSzdHLE9BRVBULEVBQVErRSxTQUFTLHlCQUNqQi9FLEVBQVFnRSxRQUVEK0MsRUFBRUcsWUFJakJsSSxFQUFHd0IsVUFBVTZGLFdBQWFwSCxFQUcxQkwsT0FBTzhJLGlCQUFpQixVQUFXLFNBQTJCNUYsR0FFMUQsSUFBbUI2RixFQUFmakgsRUFBT29CLEVBQUVwQixLQUViLEdBQW9CLGlCQUFWLEVBRU4sSUFDSUEsRUFBT2tILEtBQUtDLE1BQU1uSCxHQUNwQixNQUFNb0gsR0FDSnBILEVBQU8sR0FJWG9CLEVBQUVpRyxTQUF1QyxFQUE3QmpHLEVBQUVpRyxPQUFPbEQsUUFBUSxVQUErQixTQUFkbkUsRUFBS3NILE9BQW9CdEgsRUFBS3VILFlBQzVFTixFQUFTM0ksRUFBR3NCLEVBQUUsb0JBQXFCSSxFQUFLdUgsVUFBVSxPQUV2QzVFLFFBQ1BzRSxFQUFPakgsS0FBSyxhQUFhOEQsVUFBVW1ELEtBRzVDIiwiZmlsZSI6ImNvbXBvbmVudHMvc2xpZGVzaG93LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIFVJa2l0IDIuMjcuMiB8IGh0dHA6Ly93d3cuZ2V0dWlraXQuY29tIHwgKGMpIDIwMTQgWU9PdGhlbWUgfCBNSVQgTGljZW5zZSAqL1xuKGZ1bmN0aW9uKGFkZG9uKSB7XG5cbiAgICB2YXIgY29tcG9uZW50O1xuXG4gICAgaWYgKHdpbmRvdy5VSWtpdDIpIHtcbiAgICAgICAgY29tcG9uZW50ID0gYWRkb24oVUlraXQyKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKCd1aWtpdC1zbGlkZXNob3cnLCBbJ3Vpa2l0J10sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudCB8fCBhZGRvbihVSWtpdDIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbn0pKGZ1bmN0aW9uKFVJKSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIHZhciBBbmltYXRpb25zLCBwbGF5ZXJJZCA9IDA7XG5cbiAgICBVSS5jb21wb25lbnQoJ3NsaWRlc2hvdycsIHtcblxuICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgYW5pbWF0aW9uICAgICAgICAgIDogJ2ZhZGUnLFxuICAgICAgICAgICAgZHVyYXRpb24gICAgICAgICAgIDogNTAwLFxuICAgICAgICAgICAgaGVpZ2h0ICAgICAgICAgICAgIDogJ2F1dG8nLFxuICAgICAgICAgICAgc3RhcnQgICAgICAgICAgICAgIDogMCxcbiAgICAgICAgICAgIGF1dG9wbGF5ICAgICAgICAgICA6IGZhbHNlLFxuICAgICAgICAgICAgYXV0b3BsYXlJbnRlcnZhbCAgIDogNzAwMCxcbiAgICAgICAgICAgIHZpZGVvYXV0b3BsYXkgICAgICA6IHRydWUsXG4gICAgICAgICAgICB2aWRlb211dGUgICAgICAgICAgOiB0cnVlLFxuICAgICAgICAgICAgc2xpY2VzICAgICAgICAgICAgIDogMTUsXG4gICAgICAgICAgICBwYXVzZU9uSG92ZXIgICAgICAgOiB0cnVlLFxuICAgICAgICAgICAga2VuYnVybnMgICAgICAgICAgIDogZmFsc2UsXG4gICAgICAgICAgICBrZW5idXJuc2FuaW1hdGlvbnMgOiBbXG4gICAgICAgICAgICAgICAgJ3VrLWFuaW1hdGlvbi1taWRkbGUtbGVmdCcsXG4gICAgICAgICAgICAgICAgJ3VrLWFuaW1hdGlvbi10b3AtcmlnaHQnLFxuICAgICAgICAgICAgICAgICd1ay1hbmltYXRpb24tYm90dG9tLWxlZnQnLFxuICAgICAgICAgICAgICAgICd1ay1hbmltYXRpb24tdG9wLWNlbnRlcicsXG4gICAgICAgICAgICAgICAgJycsIC8vIG1pZGRsZS1jZW50ZXJcbiAgICAgICAgICAgICAgICAndWstYW5pbWF0aW9uLWJvdHRvbS1yaWdodCdcbiAgICAgICAgICAgIF1cbiAgICAgICAgfSxcblxuICAgICAgICBjdXJyZW50ICA6IGZhbHNlLFxuICAgICAgICBpbnRlcnZhbCA6IG51bGwsXG4gICAgICAgIGhvdmVyaW5nIDogZmFsc2UsXG5cbiAgICAgICAgYm9vdDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIC8vIGluaXQgY29kZVxuICAgICAgICAgICAgVUkucmVhZHkoZnVuY3Rpb24oY29udGV4dCkge1xuXG4gICAgICAgICAgICAgICAgVUkuJCgnW2RhdGEtdWstc2xpZGVzaG93XScsIGNvbnRleHQpLmVhY2goZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWRlc2hvdyA9IFVJLiQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzbGlkZXNob3cuZGF0YSgnc2xpZGVzaG93JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFVJLnNsaWRlc2hvdyhzbGlkZXNob3csIFVJLlV0aWxzLm9wdGlvbnMoc2xpZGVzaG93LmF0dHIoJ2RhdGEtdWstc2xpZGVzaG93JykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHZhciAkdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyICAgICA9IHRoaXMuZWxlbWVudC5oYXNDbGFzcygndWstc2xpZGVzaG93JykgPyB0aGlzLmVsZW1lbnQgOiBVSS4kKHRoaXMuZmluZCgnLnVrLXNsaWRlc2hvdzpmaXJzdCcpKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCAgICAgICA9IHRoaXMub3B0aW9ucy5zdGFydDtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW5nICAgICA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLmZpeEZ1bGxzY3JlZW4gPSBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8oaVBhZHxpUGhvbmV8aVBvZCkvZykgJiYgdGhpcy5jb250YWluZXIuaGFzQ2xhc3MoJ3VrLXNsaWRlc2hvdy1mdWxsc2NyZWVuJyk7IC8vIHZpZXdwb3J0IHVuaXQgZml4IGZvciBoZWlnaHQ6MTAwdmggLSBzaG91bGQgYmUgZml4ZWQgaW4gaU9TIDhcblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5rZW5idXJucykge1xuXG4gICAgICAgICAgICAgICAgdGhpcy5rYmFuaW1kdXJhdGlvbiA9IHRoaXMub3B0aW9ucy5rZW5idXJucyA9PT0gdHJ1ZSA/ICcxNXMnOiB0aGlzLm9wdGlvbnMua2VuYnVybnM7XG5cbiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZyh0aGlzLmtiYW5pbWR1cmF0aW9uKS5tYXRjaCgvKG1zfHMpJC8pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMua2JhbmltZHVyYXRpb24gKz0gJ21zJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mKHRoaXMub3B0aW9ucy5rZW5idXJuc2FuaW1hdGlvbnMpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5rZW5idXJuc2FuaW1hdGlvbnMgPSB0aGlzLm9wdGlvbnMua2VuYnVybnNhbmltYXRpb25zLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuXG4gICAgICAgICAgICB0aGlzLm9uKCdjbGljay51ay5zbGlkZXNob3cnLCAnW2RhdGEtdWstc2xpZGVzaG93LWl0ZW1dJywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNsaWRlID0gVUkuJCh0aGlzKS5hdHRyKCdkYXRhLXVrLXNsaWRlc2hvdy1pdGVtJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMuY3VycmVudCA9PSBzbGlkZSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoKHNsaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ25leHQnOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmV2aW91cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpc1tzbGlkZT09J25leHQnID8gJ25leHQnOidwcmV2aW91cyddKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnNob3cocGFyc2VJbnQoc2xpZGUsIDEwKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHRoaXMuc3RvcCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFVJLiR3aW4ub24oXCJyZXNpemUgbG9hZFwiLCBVSS5VdGlscy5kZWJvdW5jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkdGhpcy5yZXNpemUoKTtcblxuICAgICAgICAgICAgICAgIGlmICgkdGhpcy5maXhGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmNvbnRhaW5lci5jc3MoJ2hlaWdodCcsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLnNsaWRlcy5jc3MoJ2hlaWdodCcsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKSk7XG5cbiAgICAgICAgICAgIC8vIGNocm9tZSBpbWFnZSBsb2FkIGZpeFxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICR0aGlzLnJlc2l6ZSgpO1xuICAgICAgICAgICAgfSwgODApO1xuXG4gICAgICAgICAgICAvLyBTZXQgYXV0b3BsYXlcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYXV0b3BsYXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudmlkZW9hdXRvcGxheSAmJiB0aGlzLnNsaWRlcy5lcSh0aGlzLmN1cnJlbnQpLmRhdGEoJ21lZGlhJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXltZWRpYSh0aGlzLnNsaWRlcy5lcSh0aGlzLmN1cnJlbnQpLmRhdGEoJ21lZGlhJykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmtlbmJ1cm5zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUtlbkJ1cm5zKHRoaXMuc2xpZGVzLmVxKHRoaXMuY3VycmVudCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5vbih7XG4gICAgICAgICAgICAgICAgbW91c2VlbnRlcjogZnVuY3Rpb24oKSB7IGlmICgkdGhpcy5vcHRpb25zLnBhdXNlT25Ib3ZlcikgJHRoaXMuaG92ZXJpbmcgPSB0cnVlOyAgfSxcbiAgICAgICAgICAgICAgICBtb3VzZWxlYXZlOiBmdW5jdGlvbigpIHsgJHRoaXMuaG92ZXJpbmcgPSBmYWxzZTsgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMub24oJ3N3aXBlUmlnaHQgc3dpcGVMZWZ0JywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICR0aGlzW2UudHlwZT09J3N3aXBlTGVmdCcgPyAnbmV4dCcgOiAncHJldmlvdXMnXSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMub24oJ2Rpc3BsYXkudWsuY2hlY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGlmICgkdGhpcy5lbGVtZW50LmlzKCc6dmlzaWJsZScpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJHRoaXMucmVzaXplKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLmZpeEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmNvbnRhaW5lci5jc3MoJ2hlaWdodCcsIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5zbGlkZXMuY3NzKCdoZWlnaHQnLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFVJLmRvbU9ic2VydmUodGhpcy5lbGVtZW50LCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCR0aGlzLmNvbnRhaW5lci5jaGlsZHJlbignOm5vdChbZGF0YS1zbGlkZXNob3ctc2xpZGVdKScpLm5vdCgnLnVrLXNsaWRlc2hvdy1naG9zdCcpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy51cGRhdGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbihyZXNpemUpIHtcblxuICAgICAgICAgICAgdmFyICR0aGlzID0gdGhpcywgY2FudmFzLCBwcm9jZXNzZWQgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLnNsaWRlcyAgICAgICAgPSB0aGlzLmNvbnRhaW5lci5jaGlsZHJlbigpO1xuICAgICAgICAgICAgdGhpcy5zbGlkZXNDb3VudCAgID0gdGhpcy5zbGlkZXMubGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2xpZGVzLmVxKHRoaXMuY3VycmVudCkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zbGlkZXMuZWFjaChmdW5jdGlvbihpbmRleCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNsaWRlID0gVUkuJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGlmIChzbGlkZS5kYXRhKCdwcm9jZXNzZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhID0gc2xpZGUuY2hpbGRyZW4oJ2ltZyx2aWRlbyxpZnJhbWUnKS5lcSgwKSwgdHlwZSA9ICdodG1sJztcblxuICAgICAgICAgICAgICAgIHNsaWRlLmRhdGEoJ21lZGlhJywgbWVkaWEpO1xuICAgICAgICAgICAgICAgIHNsaWRlLmRhdGEoJ3NpemVyJywgbWVkaWEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1lZGlhLmxlbmd0aCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlcjtcblxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gbWVkaWFbMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2gobWVkaWFbMF0ubm9kZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0lNRyc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY292ZXIgPSBVSS4kKCc8ZGl2IGNsYXNzPVwidWstY292ZXItYmFja2dyb3VuZCB1ay1wb3NpdGlvbi1jb3ZlclwiPjwvZGl2PicpLmNzcyh7J2JhY2tncm91bmQtaW1hZ2UnOid1cmwoJysgbWVkaWEuYXR0cignc3JjJykgKyAnKSd9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYS5hdHRyKCd3aWR0aCcpICYmIG1lZGlhLmF0dHIoJ2hlaWdodCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyID0gVUkuJCgnPGNhbnZhcz48L2NhbnZhcz4nKS5hdHRyKHt3aWR0aDptZWRpYS5hdHRyKCd3aWR0aCcpLCBoZWlnaHQ6bWVkaWEuYXR0cignaGVpZ2h0Jyl9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWEucmVwbGFjZVdpdGgocGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYSA9IHBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYS5jc3Moe3dpZHRoOiAnMTAwJScsaGVpZ2h0OiAnYXV0bycsIG9wYWNpdHk6MH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlLnByZXBlbmQoY292ZXIpLmRhdGEoJ2NvdmVyJywgY292ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdJRlJBTUUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNyYyA9IG1lZGlhWzBdLnNyYywgaWZyYW1lSWQgPSAnc3ctJysoKytwbGF5ZXJJZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3JjJywgJycpLm9uKCdsb2FkJywgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAkdGhpcy5jdXJyZW50IHx8IChpbmRleCA9PSAkdGhpcy5jdXJyZW50ICYmICEkdGhpcy5vcHRpb25zLnZpZGVvYXV0b3BsYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMucGF1c2VtZWRpYShtZWRpYSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdGhpcy5vcHRpb25zLnZpZGVvbXV0ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMubXV0ZW1lZGlhKG1lZGlhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnYgPSBzZXRJbnRlcnZhbCgoZnVuY3Rpb24oaWMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMubXV0ZW1lZGlhKG1lZGlhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgrK2ljID49IDQpIGNsZWFySW50ZXJ2YWwoaW52KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKDApLCAyNTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKCdzbGlkZXNob3cnLCAkdGhpcykgIC8vIGFkZCBzZWxmLXJlZmVyZW5jZSBmb3IgdGhlIHZpbWVvLXJlYWR5IGxpc3RlbmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLXBsYXllci1pZCcsIGlmcmFtZUlkKSAgLy8gYWRkIGZyYW1lSWQgZm9yIHRoZSB2aW1lby1yZWFkeSBsaXN0ZW5lclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3JjJywgW3NyYywgKHNyYy5pbmRleE9mKCc/JykgPiAtMSA/ICcmJzonPycpLCAnZW5hYmxlanNhcGk9MSZhcGk9MSZwbGF5ZXJfaWQ9JytpZnJhbWVJZF0uam9pbignJykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygndWstcG9zaXRpb24tYWJzb2x1dGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgcG9pbnRlciBldmVudHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighVUkuc3VwcG9ydC50b3VjaCkgbWVkaWEuY3NzKCdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlciA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVUkuY292ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVUkuY292ZXIobWVkaWEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYS5hdHRyKCdkYXRhLXVrLWNvdmVyJywgJ3t9Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1ZJREVPJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYS5hZGRDbGFzcygndWstY292ZXItb2JqZWN0IHVrLXBvc2l0aW9uLWFic29sdXRlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLm9wdGlvbnMudmlkZW9tdXRlKSAkdGhpcy5tdXRlbWVkaWEobWVkaWEpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlaG9sZGVyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcyAgPSBVSS4kKCc8Y2FudmFzPjwvY2FudmFzPicpLmF0dHIoeyd3aWR0aCc6IG1lZGlhWzBdLndpZHRoLCAnaGVpZ2h0JzogbWVkaWFbMF0uaGVpZ2h0fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW1nID0gVUkuJCgnPGltZyBzdHlsZT1cIndpZHRoOjEwMCU7aGVpZ2h0OmF1dG87XCI+JykuYXR0cignc3JjJywgY2FudmFzWzBdLnRvRGF0YVVSTCgpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGUucHJlcGVuZChpbWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGUuZGF0YSgnc2l6ZXInLCBpbWcpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZS5kYXRhKCdzaXplcicsIHNsaWRlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJHRoaXMuaGFzS2VuQnVybnMoc2xpZGUpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2xpZGUuZGF0YSgnY292ZXInKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgJy13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uJzogJHRoaXMua2JhbmltZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAnYW5pbWF0aW9uLWR1cmF0aW9uJzogJHRoaXMua2JhbmltZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2xpZGUuZGF0YSgncHJvY2Vzc2VkJywgKytwcm9jZXNzZWQpO1xuICAgICAgICAgICAgICAgIHNsaWRlLmF0dHIoJ2RhdGEtc2xpZGVzaG93LXNsaWRlJywgdHlwZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHByb2Nlc3NlZCkge1xuXG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VycyA9IHRoaXMuZmluZCgnW2RhdGEtdWstc2xpZGVzaG93LWl0ZW1dJyk7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXQgc3RhcnQgc2xpZGVcbiAgICAgICAgICAgICAgICB0aGlzLnNsaWRlcy5hdHRyKCdhcmlhLWhpZGRlbicsICd0cnVlJykucmVtb3ZlQ2xhc3MoJ3VrLWFjdGl2ZScpLmVxKHRoaXMuY3VycmVudCkuYWRkQ2xhc3MoJ3VrLWFjdGl2ZScpLmF0dHIoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2Vycy5maWx0ZXIoJ1tkYXRhLXVrLXNsaWRlc2hvdy1pdGVtPVwiJyt0aGlzLmN1cnJlbnQrJ1wiXScpLmFkZENsYXNzKCd1ay1hY3RpdmUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHJlc2l6ZSAmJiBwcm9jZXNzZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2l6ZTogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lci5oYXNDbGFzcygndWstc2xpZGVzaG93LWZ1bGxzY3JlZW4nKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5vcHRpb25zLmhlaWdodDtcblxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oZWlnaHQgPT09ICdhdXRvJykge1xuXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gMDtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2xpZGVzLmNzcygnaGVpZ2h0JywgJycpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IE1hdGgubWF4KGhlaWdodCwgVUkuJCh0aGlzKS5oZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmNzcygnaGVpZ2h0JywgaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuc2xpZGVzLmNzcygnaGVpZ2h0JywgaGVpZ2h0KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93OiBmdW5jdGlvbihpbmRleCwgZGlyZWN0aW9uKSB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGluZyB8fCB0aGlzLmN1cnJlbnQgPT0gaW5kZXgpIHJldHVybjtcblxuICAgICAgICAgICAgdGhpcy5hbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICB2YXIgJHRoaXMgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgICAgICBjdXJyZW50ICAgICAgPSB0aGlzLnNsaWRlcy5lcSh0aGlzLmN1cnJlbnQpLFxuICAgICAgICAgICAgICAgIG5leHQgICAgICAgICA9IHRoaXMuc2xpZGVzLmVxKGluZGV4KSxcbiAgICAgICAgICAgICAgICBkaXIgICAgICAgICAgPSBkaXJlY3Rpb24gPyBkaXJlY3Rpb24gOiB0aGlzLmN1cnJlbnQgPCBpbmRleCA/IDEgOiAtMSxcbiAgICAgICAgICAgICAgICBjdXJyZW50bWVkaWEgPSBjdXJyZW50LmRhdGEoJ21lZGlhJyksXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uICAgID0gQW5pbWF0aW9uc1t0aGlzLm9wdGlvbnMuYW5pbWF0aW9uXSA/IHRoaXMub3B0aW9ucy5hbmltYXRpb24gOiAnZmFkZScsXG4gICAgICAgICAgICAgICAgbmV4dG1lZGlhICAgID0gbmV4dC5kYXRhKCdtZWRpYScpLFxuICAgICAgICAgICAgICAgIGZpbmFsaXplICAgICA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghJHRoaXMuYW5pbWF0aW5nKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRtZWRpYSAmJiBjdXJyZW50bWVkaWEuaXMoJ3ZpZGVvLGlmcmFtZScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5wYXVzZW1lZGlhKGN1cnJlbnRtZWRpYSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dG1lZGlhICYmIG5leHRtZWRpYS5pcygndmlkZW8saWZyYW1lJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnBsYXltZWRpYShuZXh0bWVkaWEpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbmV4dC5hZGRDbGFzcygndWstYWN0aXZlJykuYXR0cignYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5yZW1vdmVDbGFzcygndWstYWN0aXZlJykuYXR0cignYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmFuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkdGhpcy5jdXJyZW50ICAgPSBpbmRleDtcblxuICAgICAgICAgICAgICAgICAgICBVSS5VdGlscy5jaGVja0Rpc3BsYXkobmV4dCwgJ1tjbGFzcyo9XCJ1ay1hbmltYXRpb24tXCJdOm5vdCgudWstY292ZXItYmFja2dyb3VuZC51ay1wb3NpdGlvbi1jb3ZlciknKTtcblxuICAgICAgICAgICAgICAgICAgICAkdGhpcy50cmlnZ2VyKCdzaG93LnVrLnNsaWRlc2hvdycsIFtuZXh0LCBjdXJyZW50LCAkdGhpc10pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICR0aGlzLmFwcGx5S2VuQnVybnMobmV4dCk7XG5cbiAgICAgICAgICAgIC8vIGFuaW1hdGlvbiBmYWxsYmFja1xuICAgICAgICAgICAgaWYgKCFVSS5zdXBwb3J0LmFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9ICdub25lJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3VycmVudCA9IFVJLiQoY3VycmVudCk7XG4gICAgICAgICAgICBuZXh0ICAgID0gVUkuJChuZXh0KTtcblxuICAgICAgICAgICAgJHRoaXMudHJpZ2dlcignYmVmb3Jlc2hvdy51ay5zbGlkZXNob3cnLCBbbmV4dCwgY3VycmVudCwgJHRoaXNdKTtcblxuICAgICAgICAgICAgQW5pbWF0aW9uc1thbmltYXRpb25dLmFwcGx5KHRoaXMsIFtjdXJyZW50LCBuZXh0LCBkaXJdKS50aGVuKGZpbmFsaXplKTtcblxuICAgICAgICAgICAgJHRoaXMudHJpZ2dlcnMucmVtb3ZlQ2xhc3MoJ3VrLWFjdGl2ZScpO1xuICAgICAgICAgICAgJHRoaXMudHJpZ2dlcnMuZmlsdGVyKCdbZGF0YS11ay1zbGlkZXNob3ctaXRlbT1cIicraW5kZXgrJ1wiXScpLmFkZENsYXNzKCd1ay1hY3RpdmUnKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBseUtlbkJ1cm5zOiBmdW5jdGlvbihzbGlkZSkge1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuaGFzS2VuQnVybnMoc2xpZGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IHRoaXMub3B0aW9ucy5rZW5idXJuc2FuaW1hdGlvbnMsXG4gICAgICAgICAgICAgICAgaW5kZXggICAgICA9IHRoaXMua2JpbmRleCB8fCAwO1xuXG5cbiAgICAgICAgICAgIHNsaWRlLmRhdGEoJ2NvdmVyJykuYXR0cignY2xhc3MnLCAndWstY292ZXItYmFja2dyb3VuZCB1ay1wb3NpdGlvbi1jb3ZlcicpLndpZHRoKCk7XG4gICAgICAgICAgICBzbGlkZS5kYXRhKCdjb3ZlcicpLmFkZENsYXNzKFsndWstYW5pbWF0aW9uLXNjYWxlJywgJ3VrLWFuaW1hdGlvbi1yZXZlcnNlJywgYW5pbWF0aW9uc1tpbmRleF0udHJpbSgpXS5qb2luKCcgJykpO1xuXG4gICAgICAgICAgICB0aGlzLmtiaW5kZXggPSBhbmltYXRpb25zW2luZGV4ICsgMV0gPyAoaW5kZXgrMSk6MDtcbiAgICAgICAgfSxcblxuICAgICAgICBoYXNLZW5CdXJuczogZnVuY3Rpb24oc2xpZGUpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5vcHRpb25zLmtlbmJ1cm5zICYmIHNsaWRlLmRhdGEoJ2NvdmVyJykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuc2xpZGVzW3RoaXMuY3VycmVudCArIDFdID8gKHRoaXMuY3VycmVudCArIDEpIDogMCwgMSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJldmlvdXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuc2xpZGVzW3RoaXMuY3VycmVudCAtIDFdID8gKHRoaXMuY3VycmVudCAtIDEpIDogKHRoaXMuc2xpZGVzLmxlbmd0aCAtIDEpLCAtMSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcblxuICAgICAgICAgICAgdmFyICR0aGlzID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICghJHRoaXMuaG92ZXJpbmcpICR0aGlzLm5leHQoKTtcbiAgICAgICAgICAgIH0sIHRoaXMub3B0aW9ucy5hdXRvcGxheUludGVydmFsKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaW50ZXJ2YWwpIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcGxheW1lZGlhOiBmdW5jdGlvbihtZWRpYSkge1xuXG4gICAgICAgICAgICBpZiAoIShtZWRpYSAmJiBtZWRpYVswXSkpIHJldHVybjtcblxuICAgICAgICAgICAgc3dpdGNoKG1lZGlhWzBdLm5vZGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnVklERU8nOlxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLnZpZGVvbXV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWFbMF0ubXV0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnSUZSQU1FJzpcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy52aWRlb211dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhWzBdLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoJ3sgXCJldmVudFwiOiBcImNvbW1hbmRcIiwgXCJmdW5jXCI6IFwidW5tdXRlXCIsIFwibWV0aG9kXCI6XCJzZXRWb2x1bWVcIiwgXCJ2YWx1ZVwiOjF9JywgJyonKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhWzBdLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoJ3sgXCJldmVudFwiOiBcImNvbW1hbmRcIiwgXCJmdW5jXCI6IFwicGxheVZpZGVvXCIsIFwibWV0aG9kXCI6XCJwbGF5XCJ9JywgJyonKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgcGF1c2VtZWRpYTogZnVuY3Rpb24obWVkaWEpIHtcblxuICAgICAgICAgICAgc3dpdGNoKG1lZGlhWzBdLm5vZGVOYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnVklERU8nOlxuICAgICAgICAgICAgICAgICAgICBtZWRpYVswXS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdJRlJBTUUnOlxuICAgICAgICAgICAgICAgICAgICBtZWRpYVswXS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKCd7IFwiZXZlbnRcIjogXCJjb21tYW5kXCIsIFwiZnVuY1wiOiBcInBhdXNlVmlkZW9cIiwgXCJtZXRob2RcIjpcInBhdXNlXCJ9JywgJyonKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgbXV0ZW1lZGlhOiBmdW5jdGlvbihtZWRpYSkge1xuXG4gICAgICAgICAgICBzd2l0Y2gobWVkaWFbMF0ubm9kZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdWSURFTyc6XG4gICAgICAgICAgICAgICAgICAgIG1lZGlhWzBdLm11dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnSUZSQU1FJzpcbiAgICAgICAgICAgICAgICAgICAgbWVkaWFbMF0uY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZSgneyBcImV2ZW50XCI6IFwiY29tbWFuZFwiLCBcImZ1bmNcIjogXCJtdXRlXCIsIFwibWV0aG9kXCI6XCJzZXRWb2x1bWVcIiwgXCJ2YWx1ZVwiOjB9JywgJyonKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIEFuaW1hdGlvbnMgPSB7XG5cbiAgICAgICAgJ25vbmUnOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIGQgPSBVSS4kLkRlZmVycmVkKCk7XG4gICAgICAgICAgICBkLnJlc29sdmUoKTtcbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAnc2Nyb2xsJzogZnVuY3Rpb24oY3VycmVudCwgbmV4dCwgZGlyKSB7XG5cbiAgICAgICAgICAgIHZhciBkID0gVUkuJC5EZWZlcnJlZCgpO1xuXG4gICAgICAgICAgICBjdXJyZW50LmNzcygnYW5pbWF0aW9uLWR1cmF0aW9uJywgdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcycpO1xuICAgICAgICAgICAgbmV4dC5jc3MoJ2FuaW1hdGlvbi1kdXJhdGlvbicsIHRoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMnKTtcblxuICAgICAgICAgICAgbmV4dC5jc3MoJ29wYWNpdHknLCAxKS5vbmUoVUkuc3VwcG9ydC5hbmltYXRpb24uZW5kLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIGN1cnJlbnQuY3NzKCdvcGFjaXR5JywgMCkucmVtb3ZlQ2xhc3MoZGlyID09IC0xID8gJ3VrLXNsaWRlc2hvdy1zY3JvbGwtYmFja3dhcmQtb3V0JyA6ICd1ay1zbGlkZXNob3ctc2Nyb2xsLWZvcndhcmQtb3V0Jyk7XG4gICAgICAgICAgICAgICAgbmV4dC5yZW1vdmVDbGFzcyhkaXIgPT0gLTEgPyAndWstc2xpZGVzaG93LXNjcm9sbC1iYWNrd2FyZC1pbicgOiAndWstc2xpZGVzaG93LXNjcm9sbC1mb3J3YXJkLWluJyk7XG4gICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQuYWRkQ2xhc3MoZGlyID09IC0xID8gJ3VrLXNsaWRlc2hvdy1zY3JvbGwtYmFja3dhcmQtb3V0JyA6ICd1ay1zbGlkZXNob3ctc2Nyb2xsLWZvcndhcmQtb3V0Jyk7XG4gICAgICAgICAgICBuZXh0LmFkZENsYXNzKGRpciA9PSAtMSA/ICd1ay1zbGlkZXNob3ctc2Nyb2xsLWJhY2t3YXJkLWluJyA6ICd1ay1zbGlkZXNob3ctc2Nyb2xsLWZvcndhcmQtaW4nKTtcbiAgICAgICAgICAgIG5leHQud2lkdGgoKTsgLy8gZm9yY2UgcmVkcmF3XG5cbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAnc3dpcGUnOiBmdW5jdGlvbihjdXJyZW50LCBuZXh0LCBkaXIpIHtcblxuICAgICAgICAgICAgdmFyIGQgPSBVSS4kLkRlZmVycmVkKCk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQuY3NzKCdhbmltYXRpb24tZHVyYXRpb24nLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zJyk7XG4gICAgICAgICAgICBuZXh0LmNzcygnYW5pbWF0aW9uLWR1cmF0aW9uJywgdGhpcy5vcHRpb25zLmR1cmF0aW9uKydtcycpO1xuXG4gICAgICAgICAgICBuZXh0LmNzcygnb3BhY2l0eScsIDEpLm9uZShVSS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgY3VycmVudC5jc3MoJ29wYWNpdHknLCAwKS5yZW1vdmVDbGFzcyhkaXIgPT09IC0xID8gJ3VrLXNsaWRlc2hvdy1zd2lwZS1iYWNrd2FyZC1vdXQnIDogJ3VrLXNsaWRlc2hvdy1zd2lwZS1mb3J3YXJkLW91dCcpO1xuICAgICAgICAgICAgICAgIG5leHQucmVtb3ZlQ2xhc3MoZGlyID09PSAtMSA/ICd1ay1zbGlkZXNob3ctc3dpcGUtYmFja3dhcmQtaW4nIDogJ3VrLXNsaWRlc2hvdy1zd2lwZS1mb3J3YXJkLWluJyk7XG4gICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQuYWRkQ2xhc3MoZGlyID09IC0xID8gJ3VrLXNsaWRlc2hvdy1zd2lwZS1iYWNrd2FyZC1vdXQnIDogJ3VrLXNsaWRlc2hvdy1zd2lwZS1mb3J3YXJkLW91dCcpO1xuICAgICAgICAgICAgbmV4dC5hZGRDbGFzcyhkaXIgPT0gLTEgPyAndWstc2xpZGVzaG93LXN3aXBlLWJhY2t3YXJkLWluJyA6ICd1ay1zbGlkZXNob3ctc3dpcGUtZm9yd2FyZC1pbicpO1xuICAgICAgICAgICAgbmV4dC53aWR0aCgpOyAvLyBmb3JjZSByZWRyYXdcblxuICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgICdzY2FsZSc6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xuXG4gICAgICAgICAgICB2YXIgZCA9IFVJLiQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgY3VycmVudC5jc3MoJ2FuaW1hdGlvbi1kdXJhdGlvbicsIHRoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMnKTtcbiAgICAgICAgICAgIG5leHQuY3NzKCdhbmltYXRpb24tZHVyYXRpb24nLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zJyk7XG5cbiAgICAgICAgICAgIG5leHQuY3NzKCdvcGFjaXR5JywgMSk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQub25lKFVJLnN1cHBvcnQuYW5pbWF0aW9uLmVuZCwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBjdXJyZW50LmNzcygnb3BhY2l0eScsIDApLnJlbW92ZUNsYXNzKCd1ay1zbGlkZXNob3ctc2NhbGUtb3V0Jyk7XG4gICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQuYWRkQ2xhc3MoJ3VrLXNsaWRlc2hvdy1zY2FsZS1vdXQnKTtcbiAgICAgICAgICAgIGN1cnJlbnQud2lkdGgoKTsgLy8gZm9yY2UgcmVkcmF3XG5cbiAgICAgICAgICAgIHJldHVybiBkLnByb21pc2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAnZmFkZSc6IGZ1bmN0aW9uKGN1cnJlbnQsIG5leHQsIGRpcikge1xuXG4gICAgICAgICAgICB2YXIgZCA9IFVJLiQuRGVmZXJyZWQoKTtcblxuICAgICAgICAgICAgY3VycmVudC5jc3MoJ2FuaW1hdGlvbi1kdXJhdGlvbicsIHRoaXMub3B0aW9ucy5kdXJhdGlvbisnbXMnKTtcbiAgICAgICAgICAgIG5leHQuY3NzKCdhbmltYXRpb24tZHVyYXRpb24nLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24rJ21zJyk7XG5cbiAgICAgICAgICAgIG5leHQuY3NzKCdvcGFjaXR5JywgMSk7XG5cbiAgICAgICAgICAgIC8vIGZvciBwbGFpbiB0ZXh0IGNvbnRlbnQgc2xpZGVzIC0gbG9va3Mgc21vb3RoZXJcbiAgICAgICAgICAgIGlmICghKG5leHQuZGF0YSgnY292ZXInKSB8fCBuZXh0LmRhdGEoJ3BsYWNlaG9sZGVyJykpKSB7XG5cbiAgICAgICAgICAgICAgICBuZXh0LmNzcygnb3BhY2l0eScsIDEpLm9uZShVSS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0LnJlbW92ZUNsYXNzKCd1ay1zbGlkZXNob3ctZmFkZS1pbicpO1xuICAgICAgICAgICAgICAgIH0pLmFkZENsYXNzKCd1ay1zbGlkZXNob3ctZmFkZS1pbicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjdXJyZW50Lm9uZShVSS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgY3VycmVudC5jc3MoJ29wYWNpdHknLCAwKS5yZW1vdmVDbGFzcygndWstc2xpZGVzaG93LWZhZGUtb3V0Jyk7XG4gICAgICAgICAgICAgICAgZC5yZXNvbHZlKCk7XG5cbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGN1cnJlbnQuYWRkQ2xhc3MoJ3VrLXNsaWRlc2hvdy1mYWRlLW91dCcpO1xuICAgICAgICAgICAgY3VycmVudC53aWR0aCgpOyAvLyBmb3JjZSByZWRyYXdcblxuICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFVJLnNsaWRlc2hvdy5hbmltYXRpb25zID0gQW5pbWF0aW9ucztcblxuICAgIC8vIExpc3RlbiBmb3IgbWVzc2FnZXMgZnJvbSB0aGUgdmltZW8gcGxheWVyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiBvbk1lc3NhZ2VSZWNlaXZlZChlKSB7XG5cbiAgICAgICAgdmFyIGRhdGEgPSBlLmRhdGEsIGlmcmFtZTtcblxuICAgICAgICBpZiAodHlwZW9mKGRhdGEpID09ICdzdHJpbmcnKSB7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoKGVycikge1xuICAgICAgICAgICAgICAgIGRhdGEgPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLm9yaWdpbiAmJiBlLm9yaWdpbi5pbmRleE9mKCd2aW1lbycpID4gLTEgJiYgZGF0YS5ldmVudCA9PSAncmVhZHknICYmIGRhdGEucGxheWVyX2lkKSB7XG4gICAgICAgICAgICBpZnJhbWUgPSBVSS4kKCdbZGF0YS1wbGF5ZXItaWQ9XCInKyBkYXRhLnBsYXllcl9pZCsnXCJdJyk7XG5cbiAgICAgICAgICAgIGlmIChpZnJhbWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWZyYW1lLmRhdGEoJ3NsaWRlc2hvdycpLm11dGVtZWRpYShpZnJhbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgZmFsc2UpO1xuXG59KTsiXX0=
